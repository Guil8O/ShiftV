/* ============================================================
   ShiftV — style.css
   Main component stylesheet
   MD3 (Material You) compliant
   ============================================================ */

/* ==================== */
/* App Layout */
/* ==================== */
.app-wrapper {
    display: flex;
    flex-direction: column;
    min-height: 100dvh;
    position: relative;
}

.container {
    flex: 1;
    width: 100%;
    max-width: 600px;
    margin: 0 auto;
    padding: var(--spacing-md) var(--spacing-md) 100px;
    position: relative;
}

/* ==================== */
/* App Bar (Top) */
/* ==================== */
.app-bar {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-3) 0;
    position: sticky;
    top: 0;
    z-index: var(--z-index-sticky);
    background: linear-gradient(to bottom, var(--bg-main) 0%, var(--bg-main) 20%, transparent 100%);
}

.app-bar-title {
    display: flex;
    align-items: center;
    margin: 0;
}

.app-bar-logo {
    height: 48px;
    width: auto;
    display: none;
    object-fit: contain;
}

/* Inline SVG logo — theme-tinted */
.app-bar-logo--svg {
    height: 48px;
    display: none;          /* shown via JS after SVG loads */
    align-items: center;
}

.app-bar-logo--svg svg {
    height: 100%;
    width: auto;
    fill: var(--primary, #D0BCFF);
    color: var(--primary, #D0BCFF);
    transition: fill 0.3s ease, color 0.3s ease;
}

/* Force all child paths/shapes to inherit the primary colour */
.app-bar-logo--svg svg path,
.app-bar-logo--svg svg rect,
.app-bar-logo--svg svg circle,
.app-bar-logo--svg svg polygon,
.app-bar-logo--svg svg ellipse,
.app-bar-logo--svg svg text {
    fill: var(--primary, #D0BCFF) !important;
    stroke: none !important;
}

/* Dark theme (default): show dark PNG logo (fallback when SVG unavailable) */
.app-bar-logo--dark {
    display: block;
}
.app-bar-logo--light {
    display: none;
}

/* Light theme: swap logos */
.light-mode .app-bar-logo--dark,
[data-theme="light"] .app-bar-logo--dark {
    display: none;
}
.light-mode .app-bar-logo--light,
[data-theme="light"] .app-bar-logo--light {
    display: block;
}

.app-bar-actions {
    display: flex;
    gap: var(--spacing-xs);
}

/* ==================== */
/* Tab Bar (MD3 Navigation Bar — Pill Toggle) */
/* ==================== */
.tab-bar {
    position: fixed;
    bottom: var(--spacing-md);
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    z-index: var(--z-index-fixed);
    padding-bottom: env(safe-area-inset-bottom, 0px);
    width: auto;
    max-width: calc(100vw - 32px);
}

/* Main pill container for grouped tabs */
.tab-group {
    display: flex;
    align-items: center;
    gap: 0;
    background: var(--md-sys-color-surface-container-high, var(--tab-bar-bg));
    border-radius: var(--md-sys-shape-corner-full);
    padding: var(--spacing-xs);
    box-shadow: var(--md-sys-elevation-3);
}

.tab-button {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xxs);
    border: none;
    background: transparent;
    color: var(--tab-inactive-text);
    cursor: pointer;
    font-size: 10px;
    font-family: inherit;
    font-weight: var(--md-sys-typescale-label-medium-weight);
    padding: var(--spacing-sm) 14px;
    position: relative;
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
    -webkit-tap-highlight-color: transparent;
    min-width: 48px;
    border-radius: var(--md-sys-shape-corner-full);
    z-index: 1;
}

.tab-button svg {
    width: 22px;
    height: 22px;
    position: relative;
    z-index: 1;
    transition: transform var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.tab-button span {
    position: relative;
    z-index: 1;
    line-height: 1;
    font-size: 9px;
    max-height: 0;
    overflow: hidden;
    opacity: 0;
    white-space: nowrap;
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
}

/* Active state — pill highlight */
.active-tab-indicator {
    position: absolute;
    inset: 0;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--tab-active-bg);
    transform: scaleX(0);
    transition: transform var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
    z-index: 0;
}

.tab-button.active .active-tab-indicator {
    transform: scaleX(1);
}

.tab-button.active {
    color: var(--tab-active-text);
}

.tab-button.active span {
    max-height: 18px;
    opacity: 1;
}

.tab-button.active svg {
    transform: scale(1.05);
}

.tab-button:hover:not(.active) {
    background: color-mix(in srgb, var(--text-main) 6%, transparent);
}

/* ==================== */
/* Tab Content */
/* ==================== */
.tab-contents {
    position: relative;
}

.tab-content {
    display: none;
    animation: fadeIn var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized);
}

.tab-content.active {
    display: block;
}

/* ==================== */
/* Glass Card (MD3 Surface Container) */
/* ==================== */
.glass-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large);
    padding: var(--spacing-5);
    margin-bottom: var(--spacing-md);
    box-shadow: var(--glass-shadow);
    transition: box-shadow var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.glass-card:hover {
    box-shadow: var(--glass-shadow-floating);
}

/* ==================== */
/* MD3 Card System */
/* ==================== */

/* --- Shared Card Base --- */
.card-filled,
.card-outlined,
.card-elevated {
    border-radius: var(--md-sys-shape-corner-medium);
    padding: var(--spacing-md);
    transition: box-shadow var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    position: relative;
    overflow: hidden;
}

/* --- Filled Card --- */
.card-filled {
    background: var(--md-sys-color-surface-container-highest, var(--glass-bg));
    border: none;
}

/* --- Outlined Card --- */
.card-outlined {
    background: var(--md-sys-color-surface, var(--bg-primary));
    border: 1px solid var(--md-sys-color-outline-variant, var(--glass-border));
}

/* --- Elevated Card --- */
.card-elevated {
    background: var(--md-sys-color-surface-container-low, var(--surface-card));
    border: none;
    box-shadow: var(--md-sys-elevation-1);
}

.card-elevated:hover {
    box-shadow: var(--md-sys-elevation-2);
}

/* --- Card interactive states --- */
.card-filled[role="button"]:hover,
.card-outlined[role="button"]:hover {
    box-shadow: var(--md-sys-elevation-1);
}

.card-filled[role="button"],
.card-outlined[role="button"],
.card-elevated[role="button"] {
    cursor: pointer;
    -webkit-tap-highlight-color: transparent;
}

.card-filled[role="button"]::after,
.card-outlined[role="button"]::after,
.card-elevated[role="button"]::after {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0;
    transition: opacity var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    border-radius: inherit;
    pointer-events: none;
}

.card-filled[role="button"]:active::after,
.card-outlined[role="button"]:active::after,
.card-elevated[role="button"]:active::after {
    opacity: 0.08;
}

/* ==================== */
/* Buttons */
/* ==================== */

/* Glass Button (MD3 Filled Tonal) */
.glass-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    -webkit-tap-highlight-color: transparent;
    white-space: nowrap;
    line-height: 1.4;
    min-height: 40px;
}

.glass-button:hover {
    background: var(--glass-bg-light);
    box-shadow: var(--md-sys-elevation-1);
}

.glass-button:active {
    transform: scale(0.97);
}

.glass-button:disabled {
    opacity: 0.38;
    cursor: not-allowed;
}

/* Primary (MD3 Filled Button) */
.glass-button.primary {
    background: var(--primary);
    color: var(--text-inverse);
    border-color: var(--primary);
}

.glass-button.primary:hover {
    background: var(--primary);
    opacity: 0.92;
    box-shadow: var(--md-sys-elevation-1);
}

/* Danger Button */
.glass-button.danger {
    background: var(--danger);
    color: var(--md-sys-color-on-error, #fff);
    border-color: var(--danger);
}

.glass-button.danger:hover {
    opacity: 0.92;
    box-shadow: var(--md-sys-elevation-1);
}

/* Icon Button (MD3 48dp touch target) */
.icon-button {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    -webkit-tap-highlight-color: transparent;
    padding: 0;
}

.icon-button svg {
    width: 24px;
    height: 24px;
    fill: currentColor;
}

.icon-button:hover {
    background: color-mix(in srgb, var(--text-main) 8%, transparent);
}

.icon-button:active {
    background: color-mix(in srgb, var(--text-main) 12%, transparent);
}

/* ─── Notification Badge ─── */
.icon-button { position: relative; }

.notif-badge {
    position: absolute;
    top: 8px;
    right: 8px;
    min-width: 16px;
    height: 16px;
    border-radius: 9999px;
    background: var(--md-sys-color-error, #FF5449);
    color: #fff;
    font-size: 9px;
    font-weight: 700;
    line-height: 16px;
    text-align: center;
    padding: 0 4px;
    pointer-events: none;
}

/* ─── Notification Panel ─── */
.notification-panel {
    position: fixed;
    top: 0;
    right: 0;
    width: min(360px, 100vw);
    height: 100dvh;
    background: var(--glass-bg);
    backdrop-filter: blur(20px) saturate(1.5);
    -webkit-backdrop-filter: blur(20px) saturate(1.5);
    border-left: 1px solid var(--glass-border);
    z-index: calc(var(--z-index-fixed) + 50);
    display: flex;
    flex-direction: column;
    transform: translateX(100%);
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    box-shadow: -4px 0 24px rgba(0,0,0,0.3);
}

.notification-panel.open {
    transform: translateX(0);
}

.notification-panel-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 16px 12px;
    border-bottom: 1px solid var(--glass-border);
    flex-shrink: 0;
}

.notification-panel-title {
    font-size: var(--md-sys-typescale-title-medium-size, 16px);
    font-weight: 600;
    color: var(--text-main);
}

.notif-list {
    flex: 1;
    overflow-y: auto;
    padding: 8px 0;
}

.notif-empty {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 120px;
    color: var(--text-dim2, #888);
    font-size: 14px;
}

.notif-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px 16px;
    border-bottom: 1px solid var(--glass-border);
    cursor: pointer;
    transition: background 0.15s;
}

.notif-item:hover {
    background: color-mix(in srgb, var(--primary) 6%, transparent);
}

.notif-item.unread::before {
    content: '';
    position: absolute;
    left: 6px;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--primary);
    top: 50%;
    transform: translateY(-50%);
}

.notif-item { position: relative; }

.notif-icon {
    width: 36px;
    height: 36px;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    font-size: 18px;
}

.notif-icon--measurement { background: color-mix(in oklch, var(--primary) 15%, transparent); color: var(--primary); }
.notif-icon--diary       { background: color-mix(in oklch, var(--primary) 10%, rgba(100,180,255,0.1)); color: #64b5f6; }
.notif-icon--quest       { background: color-mix(in oklch, var(--primary) 10%, rgba(255,167,38,0.1)); color: #ffa726; }
.notif-icon--health      { background: color-mix(in oklch, var(--primary) 10%, rgba(239,83,80,0.1));  color: #ef5350; }
.notif-icon--goal        { background: color-mix(in oklch, var(--primary) 10%, rgba(102,187,106,0.1)); color: #66bb6a; }

.notif-content {
    flex: 1;
    min-width: 0;
}

.notif-title {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-main);
    margin-bottom: 2px;
}

.notif-body {
    font-size: 12px;
    color: var(--text-dim);
    line-height: 1.4;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
}

.notif-time {
    font-size: 10px;
    color: var(--text-dim2, #888);
    white-space: nowrap;
    flex-shrink: 0;
    margin-top: 2px;
}

.notif-category-label {
    font-size: 10px;
    font-weight: 700;
    color: var(--text-dim2, #888);
    letter-spacing: 0.06em;
    text-transform: uppercase;
    padding: 10px 16px 4px;
}

.notification-panel-footer {
    padding: 10px 16px;
    border-top: 1px solid var(--glass-border);
    flex-shrink: 0;
}

.notif-clear-btn {
    width: 100%;
    background: none;
    border: 1px solid var(--glass-border);
    border-radius: 8px;
    padding: 8px;
    font-size: 13px;
    color: var(--text-dim);
    cursor: pointer;
    font-family: inherit;
    transition: all 0.15s;
}

.notif-clear-btn:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    color: var(--text-main);
    border-color: var(--primary);
}

.notif-backdrop {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.4);
    z-index: calc(var(--z-index-fixed) + 49);
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

.notif-backdrop.visible {
    opacity: 1;
    pointer-events: auto;
}

/* MD3 Filled Button */
.btn-filled {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--primary);
    color: var(--text-inverse);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    min-height: 40px;
}

.btn-filled:hover {
    box-shadow: var(--md-sys-elevation-1);
    opacity: 0.92;
}

/* MD3 Filled Tonal Button */
.btn-filled-tonal {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    min-height: 40px;
}

.btn-filled-tonal:hover {
    box-shadow: var(--md-sys-elevation-1);
}

/* MD3 Text Button */
.btn-text {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-3);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    min-height: 40px;
}

.btn-text:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
}

/* MD3 Outlined Button */
.btn-outlined {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    min-height: 40px;
}

.btn-outlined:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
}

/* MD3 Elevated Button */
.btn-elevated {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-surface-container-low, var(--surface-card));
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    min-height: 40px;
    box-shadow: var(--md-sys-elevation-1);
}

.btn-elevated:hover {
    box-shadow: var(--md-sys-elevation-2);
}

/* MD3 Button — Disabled states */
.btn-filled:disabled,
.btn-filled-tonal:disabled,
.btn-text:disabled,
.btn-outlined:disabled,
.btn-elevated:disabled {
    opacity: 0.38;
    cursor: default;
    pointer-events: none;
    box-shadow: none;
}

/* MD3 Button — Ripple */
.btn-filled,
.btn-filled-tonal,
.btn-text,
.btn-outlined,
.btn-elevated {
    position: relative;
    overflow: hidden;
    -webkit-tap-highlight-color: transparent;
}

.btn-filled::after,
.btn-filled-tonal::after,
.btn-text::after,
.btn-outlined::after,
.btn-elevated::after {
    content: '';
    position: absolute;
    inset: 0;
    background: currentColor;
    opacity: 0;
    transition: opacity var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    border-radius: inherit;
    pointer-events: none;
}

.btn-filled:active::after,
.btn-filled-tonal:active::after,
.btn-text:active::after,
.btn-outlined:active::after,
.btn-elevated:active::after {
    opacity: 0.12;
}

/* Add Button */
.add-btn {
    width: 100%;
    margin-top: var(--spacing-sm);
    justify-content: center;
    border-style: dashed;
}

/* ==================== */
/* MD3 Chip System */
/* ==================== */

/* --- Shared Chip Base --- */
.chip-assist,
.chip-filter,
.chip-input,
.chip-suggestion {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-sm);
    height: 32px;
    padding: 0 var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-small);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    -webkit-tap-highlight-color: transparent;
    white-space: nowrap;
    line-height: 1;
}

.chip-assist .material-symbols-outlined,
.chip-assist .svg-icon,
.chip-filter .material-symbols-outlined,
.chip-filter .svg-icon,
.chip-input .material-symbols-outlined,
.chip-input .svg-icon,
.chip-suggestion .material-symbols-outlined,
.chip-suggestion .svg-icon {
    font-size: 18px;
}

/* --- Assist Chip (outlined, icon optional) --- */
.chip-assist {
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    color: var(--md-sys-color-on-surface, var(--text-main));
}

.chip-assist:hover {
    background: color-mix(in srgb, var(--md-sys-color-on-surface, var(--text-main)) 8%, transparent);
}

/* --- Filter Chip (toggleable, outlined → filled when selected) --- */
.chip-filter {
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
}

.chip-filter:hover {
    background: color-mix(in srgb, var(--md-sys-color-on-surface, var(--text-main)) 8%, transparent);
}

.chip-filter.selected,
.chip-filter[aria-selected="true"] {
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    border-color: transparent;
}

.chip-filter.selected::before,
.chip-filter[aria-selected="true"]::before {
    content: 'check';
    font-family: 'Material Symbols Outlined';
    font-size: 18px;
    margin-right: var(--spacing-xs);
}

/* --- Input Chip (with trailing remove action) --- */
.chip-input {
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
    padding-right: var(--spacing-xs);
}

.chip-input:hover {
    background: color-mix(in srgb, var(--md-sys-color-on-surface-variant, var(--text-secondary)) 8%, transparent);
}

.chip-input .chip-remove {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 24px;
    height: 24px;
    border: none;
    background: transparent;
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
    border-radius: var(--md-sys-shape-corner-full);
    cursor: pointer;
    padding: 0;
}

.chip-input .chip-remove:hover {
    background: color-mix(in srgb, currentColor 12%, transparent);
}

/* --- Suggestion Chip (outlined, elevated on press) --- */
.chip-suggestion {
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
}

.chip-suggestion:hover {
    background: color-mix(in srgb, var(--md-sys-color-on-surface, var(--text-main)) 8%, transparent);
    box-shadow: var(--md-sys-elevation-1);
}

/* --- Chip disabled state --- */
.chip-assist:disabled,
.chip-filter:disabled,
.chip-input:disabled,
.chip-suggestion:disabled {
    opacity: 0.38;
    cursor: default;
    pointer-events: none;
}

/* AI Enhanced Badge */
.ai-enhanced-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-1-5);
    padding: var(--spacing-sm) var(--spacing-md);
    border: 1px solid var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    background: color-mix(in srgb, var(--primary) 12%, transparent);
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.ai-enhanced-badge:hover {
    background: color-mix(in srgb, var(--primary) 20%, transparent);
    box-shadow: var(--md-sys-elevation-1);
}

/* ==================== */
/* Button Group */
/* ==================== */
.button-group {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-3);
}

/* ==================== */
/* Form Controls */
/* ==================== */
.form-group {
    margin-bottom: var(--spacing-md);
}

.form-group label {
    display: block;
    font-size: var(--md-sys-typescale-body-small-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-dim);
    margin-bottom: var(--spacing-1-5);
    letter-spacing: 0.4px;
}

.form-group-full-width {
    grid-column: 1 / -1;
}

input[type="text"],
input[type="number"],
input[type="email"],
input[type="password"],
input[type="date"],
input[type="url"],
input[type="tel"],
select,
textarea {
    width: 100%;
    padding: var(--spacing-3) var(--spacing-md);
    background: var(--input-bg);
    border: 1px solid var(--input-border);
    border-radius: var(--md-sys-shape-corner-small);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-large-size);
    line-height: var(--md-sys-typescale-body-large-line-height);
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard),
                box-shadow var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    outline: none;
}

input:focus,
select:focus,
textarea:focus {
    border-color: var(--input-focus-border);
    box-shadow: 0 0 0 1px var(--input-focus-border);
}

input::placeholder,
textarea::placeholder {
    color: var(--input-placeholder);
    opacity: 0.6;
}

input:disabled,
select:disabled,
textarea:disabled {
    background: var(--input-disabled-bg);
    color: var(--input-disabled-text);
    cursor: not-allowed;
    opacity: 0.6;
}

textarea {
    resize: vertical;
    min-height: 80px;
}

.input-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
}

@media (max-width: 400px) {
    .input-grid {
        grid-template-columns: 1fr;
    }
}

.input-with-unit {
    display: flex;
    gap: var(--spacing-sm);
}

.input-with-unit input {
    flex: 1;
    min-width: 0;
}

.unit-select {
    width: auto;
    min-width: 80px;
    flex-shrink: 0;
}

.glass-select {
    background: var(--input-bg);
    border: 1px solid var(--input-border);
    border-radius: var(--md-sys-shape-corner-medium);
    color: var(--text-main);
    font-family: inherit;
}

/* ==================== */
/* MD3 Text Fields */
/* ==================== */

/* --- Filled Text Field --- */
.text-field-filled {
    position: relative;
    display: flex;
    flex-direction: column;
}

.text-field-filled input,
.text-field-filled textarea {
    width: 100%;
    padding: var(--spacing-5) var(--spacing-md) var(--spacing-sm);
    background: var(--md-sys-color-surface-container-highest, var(--input-bg));
    border: none;
    border-bottom: 1px solid var(--md-sys-color-on-surface-variant, var(--input-border));
    border-radius: var(--md-sys-shape-corner-extra-small) var(--md-sys-shape-corner-extra-small) 0 0;
    color: var(--md-sys-color-on-surface, var(--text-main));
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-large-size);
    line-height: var(--md-sys-typescale-body-large-line-height);
    outline: none;
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.text-field-filled input:focus,
.text-field-filled textarea:focus {
    border-bottom: 2px solid var(--primary);
    padding-bottom: calc(var(--spacing-sm) - 1px);
}

.text-field-filled label {
    position: absolute;
    top: var(--spacing-md);
    left: var(--spacing-md);
    font-size: var(--md-sys-typescale-body-large-size);
    color: var(--md-sys-color-on-surface-variant, var(--text-dim));
    pointer-events: none;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    transform-origin: left top;
}

.text-field-filled input:focus ~ label,
.text-field-filled input:not(:placeholder-shown) ~ label,
.text-field-filled textarea:focus ~ label,
.text-field-filled textarea:not(:placeholder-shown) ~ label {
    top: var(--spacing-sm);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--primary);
}

.text-field-filled .supporting-text {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--md-sys-color-on-surface-variant, var(--text-dim));
    padding: var(--spacing-xs) var(--spacing-md) 0;
}

.text-field-filled.error input,
.text-field-filled.error textarea {
    border-bottom-color: var(--md-sys-color-error, var(--danger));
}

.text-field-filled.error .supporting-text {
    color: var(--md-sys-color-error, var(--danger));
}

/* --- Outlined Text Field --- */
.text-field-outlined {
    position: relative;
    display: flex;
    flex-direction: column;
}

.text-field-outlined input,
.text-field-outlined textarea {
    width: 100%;
    padding: var(--spacing-md);
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--input-border));
    border-radius: var(--md-sys-shape-corner-extra-small);
    color: var(--md-sys-color-on-surface, var(--text-main));
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-large-size);
    line-height: var(--md-sys-typescale-body-large-line-height);
    outline: none;
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.text-field-outlined input:focus,
.text-field-outlined textarea:focus {
    border: 2px solid var(--primary);
    padding: calc(var(--spacing-md) - 1px);
}

.text-field-outlined label {
    position: absolute;
    top: var(--spacing-md);
    left: var(--spacing-3);
    font-size: var(--md-sys-typescale-body-large-size);
    color: var(--md-sys-color-on-surface-variant, var(--text-dim));
    background: var(--md-sys-color-surface, var(--bg-primary));
    padding: 0 var(--spacing-xs);
    pointer-events: none;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    transform-origin: left top;
}

.text-field-outlined input:focus ~ label,
.text-field-outlined input:not(:placeholder-shown) ~ label,
.text-field-outlined textarea:focus ~ label,
.text-field-outlined textarea:not(:placeholder-shown) ~ label {
    top: calc(-1 * var(--spacing-sm));
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--primary);
}

.text-field-outlined .supporting-text {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--md-sys-color-on-surface-variant, var(--text-dim));
    padding: var(--spacing-xs) var(--spacing-md) 0;
}

.text-field-outlined.error input,
.text-field-outlined.error textarea {
    border-color: var(--md-sys-color-error, var(--danger));
}

.text-field-outlined.error .supporting-text {
    color: var(--md-sys-color-error, var(--danger));
}

/* Description & Warning Text */
.description {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    margin-bottom: var(--spacing-3);
    line-height: 1.5;
}

.warning {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--warning-text, var(--warning));
    margin-top: var(--spacing-3);
    line-height: 1.5;
}

.hint-text {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.4;
}

/* ==================== */
/* Accordion (Details/Summary) */
/* ==================== */
.accordion-group {
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    margin-bottom: var(--spacing-3);
    overflow: hidden;
    background: var(--glass-bg);
}

.accordion-title {
    display: flex;
    align-items: center;
    padding: 14px var(--spacing-md);
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    cursor: pointer;
    list-style: none;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    user-select: none;
}

.accordion-title::-webkit-details-marker {
    display: none;
}

.accordion-title::before {
    content: '';
    display: inline-block;
    width: 0;
    height: 0;
    border-left: 6px solid currentColor;
    border-top: 5px solid transparent;
    border-bottom: 5px solid transparent;
    margin-right: var(--spacing-3);
    transition: transform var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    flex-shrink: 0;
}

details[open] > .accordion-title::before {
    transform: rotate(90deg);
}

.accordion-title:hover {
    background: color-mix(in srgb, var(--primary) 6%, transparent);
}

.accordion-content {
    padding: var(--spacing-xs) var(--spacing-md) var(--spacing-md);
}

/* ==================== */
/* SV Grid (Main Tab Cards) */
/* ==================== */
.sv-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
    margin-top: var(--spacing-3);
}

.sv-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large);
    padding: var(--spacing-md);
    box-shadow: var(--glass-shadow);
    transition: box-shadow var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard),
                transform var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    overflow: hidden;
    min-height: 100px;
}

.sv-card h3 {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    margin: 0 0 var(--spacing-sm);
    color: var(--primary);
}

.sv-card--clickable {
    cursor: pointer;
}

.sv-card--clickable:hover {
    box-shadow: var(--glass-shadow-floating);
    transform: translateY(-2px);
}

.sv-card-widget {
    grid-column: 1 / -1;
}

/* sv-card 구조 서브 클래스 */
.sv-card-content {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.sv-card-label {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin: 0 0 var(--spacing-xs);
}

.sv-card-desc {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    margin: 0;
}

@media (max-width: 400px) {
    .sv-grid {
        grid-template-columns: 1fr;
    }
}

/* ==================== */
/* SV Persona Card Widget */
/* ==================== */
.svcard-persona-carousel {
    display: flex;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scrollbar-width: none;
    -ms-overflow-style: none;
}
.svcard-persona-carousel::-webkit-scrollbar { display: none; }

/* Carousel arrows for sv-cards (carousel-frame.js) */
.svcard-arrow {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 28px;
    height: 28px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--glass-bg-light);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-large-size);
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    z-index: 2;
    opacity: 0.8;
}
.sv-card:hover .svcard-arrow:not(.hidden) {
    display: flex;
}
.svcard-arrow:hover {
    background: var(--glass-bg-light);
    opacity: 1;
}
.svcard-arrow-prev { left: var(--spacing-xxs); }
.svcard-arrow-next { right: var(--spacing-xxs); }

.svcard-persona-slide {
    flex: 0 0 100%;
    scroll-snap-align: start;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xs) 0;
}

.svcard-persona-avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    object-fit: cover;
}

.svcard-persona-avatar--default {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    background: var(--glass-bg-light, rgba(255,255,255,0.08));
    color: var(--text-dim);
}

.svcard-persona-name {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: 600;
    color: var(--text-main);
}

.svcard-persona-mode {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: var(--md-sys-typescale-label-medium-size);
    color: var(--primary);
}

.svcard-persona-goal {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    text-align: center;
    line-height: 1.4;
    max-height: 3.6em;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;
}

.svcard-persona-target-title {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: 600;
    color: var(--primary);
    margin: 0 0 var(--spacing-xs);
    width: 100%;
}

.svcard-target-scroll {
    width: 100%;
    max-height: 140px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    padding-right: 4px;
}

.svcard-target-scroll::-webkit-scrollbar {
    width: 3px;
}

.svcard-target-scroll::-webkit-scrollbar-thumb {
    background: var(--glass-border);
    border-radius: 3px;
}

.svcard-target-row {
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.svcard-target-row-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
}

.svcard-target-label {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim);
    font-weight: 500;
}

.svcard-target-values {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
}

.svcard-target-bar {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: var(--md-sys-color-surface-container-highest, rgba(255,255,255,0.06));
    overflow: hidden;
}

.svcard-target-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--primary);
    transition: width 0.4s ease;
}

.svcard-target-pct {
    font-size: 0.6rem;
    color: var(--primary);
    font-weight: 600;
    text-align: right;
}

/* ─── M3 Circular Progress (Targets Card) ─── */
.m3-circular-progress {
    position: relative;
    width: 100px;
    height: 100px;
    margin: 0 auto;
}

.m3-circular-progress svg {
    width: 100%;
    height: 100%;
    transform: rotate(-90deg);
}

.m3-progress-track {
    fill: none;
    stroke: var(--md-sys-color-surface-container-highest, rgba(255, 255, 255, 0.08));
    stroke-width: 6;
}

.m3-progress-indicator {
    fill: none;
    stroke: var(--primary, #D0BCFF);
    stroke-width: 6;
    stroke-linecap: round;
    stroke-dasharray: 238.76;
    transition: stroke-dashoffset 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.m3-progress-label {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    pointer-events: none;
}

#sv-card-targets .sv-card-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: var(--spacing-md);
}

#sv-card-targets .sv-card-content p {
    margin: 0;
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-secondary, #CAC4D0);
    text-align: center;
}

.m3-progress-desc {
    margin: 8px 0 0;
    font-size: var(--md-sys-typescale-label-medium-size, 12px);
    font-weight: 500;
    color: var(--text-dim, #a0a0a0);
    letter-spacing: 0.3px;
}

/* Persona dots */
.svcard-dots {
    display: flex;
    justify-content: center;
    gap: 6px;
    padding-top: var(--spacing-xs);
}

.svcard-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--glass-border);
    transition: background 0.2s, width 0.2s;
}

.svcard-dot.active {
    width: 16px;
    border-radius: 3px;
    background: var(--primary);
}

/* SV Quest Card Carousel */
.svcard-quest-carousel {
    display: flex;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scrollbar-width: none;
    -ms-overflow-style: none;
}
.svcard-quest-carousel::-webkit-scrollbar { display: none; }
.svcard-quest-slide {
    flex: 0 0 100%;
    scroll-snap-align: start;
    padding: var(--spacing-xs) 0;
    box-sizing: border-box;
}

/* ==================== */
/* Carousel */
/* ==================== */
.carousel-container {
    position: relative;
}

.carousel-wrapper {
    position: relative;
    overflow: hidden;
}

.carousel-content {
    display: flex;
    overflow-x: auto;
    overflow-y: hidden;
    scroll-snap-type: x mandatory;
    scroll-behavior: smooth;
    scrollbar-width: none;
    -ms-overflow-style: none;
    will-change: scroll-position;
}

.carousel-content::-webkit-scrollbar {
    display: none;
}

.carousel-content > * {
    min-width: 100%;
    flex-shrink: 0;
    box-sizing: border-box;
}

/* Carousel item (used by JS) */
.carousel-item {
    min-width: 100%;
    flex-shrink: 0;
    padding: var(--spacing-xs) 0;
    box-sizing: border-box;
    scroll-snap-align: start;
}

.carousel-nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    width: 28px;
    height: 28px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--glass-bg-light);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-large-size);
    cursor: pointer;
    display: none;
    align-items: center;
    justify-content: center;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    z-index: 1;
    opacity: 0.8;
}

.carousel-container:hover .carousel-nav-btn {
    display: flex;
}

.carousel-nav-btn.prev { left: var(--spacing-xxs); }
.carousel-nav-btn.next { right: var(--spacing-xxs); }

.carousel-nav-btn:hover {
    background: var(--glass-bg-light);
    opacity: 1;
}

.carousel-dots {
    display: flex;
    justify-content: center;
    gap: var(--spacing-1-5);
    margin-top: var(--spacing-2-5);
}

.carousel-dots .dot,
.carousel-dots span {
    width: 8px;
    height: 8px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--text-dim2);
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    cursor: pointer;
}

.carousel-dots .dot.active,
.carousel-dots span.active {
    background: var(--primary);
    width: 24px;
}

/* ==================== */
/* Streak Strip */
/* ==================== */
.streak-strip-container {
    margin-bottom: var(--spacing-3);
}

/* ==================== */
/* Modal Overlay (Full Screen) */
/* ==================== */
.modal-overlay {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    z-index: var(--z-index-modal);
    padding: var(--spacing-md) var(--spacing-md) 0;
    animation: fadeIn var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized-decelerate);
}

.modal-overlay > .modal-content {
    width: 100%;
    max-height: calc(100vh - var(--spacing-md));
    overflow-y: auto;
}

/* ==================== */
/* Bottom Sheet Modal */
/* ==================== */
.modal-bottom-sheet-overlay {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: var(--z-index-modal);
    display: none;
    opacity: 0;
    padding: var(--spacing-md) var(--spacing-md) 0;
    transition: opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.modal-bottom-sheet-overlay.active,
.modal-bottom-sheet-overlay.visible {
    display: flex;
    align-items: flex-end;
    justify-content: center;
    opacity: 1;
}

.modal-bottom-sheet {
    width: 100%;
    max-height: calc(100vh - 15px);
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
    overflow-y: auto;
    transform: translateY(100%);
    transition: transform var(--md-sys-motion-duration-medium4) var(--md-sys-motion-easing-emphasized);
}

.modal-bottom-sheet-overlay.active .modal-bottom-sheet,
.modal-bottom-sheet-overlay.visible .modal-bottom-sheet {
    transform: translateY(0);
}

.modal-header {
    position: sticky;
    top: 0;
    background: var(--modal-bg);
    z-index: 1;
    padding: 0 var(--spacing-lg);
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--glass-border);
}

.modal-handle {
    position: absolute;
    top: var(--spacing-sm);
    left: 50%;
    transform: translateX(-50%);
    width: var(--spacing-xl);
    height: 4px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-outline-variant, var(--glass-border));
}

.modal-title {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    margin: var(--spacing-lg) 0 var(--spacing-3);
    color: var(--text-main);
}

.modal-close-btn {
    width: 40px;
    height: 40px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-headline-small-size);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    flex-shrink: 0;
}

.modal-close-btn:hover {
    background: color-mix(in srgb, var(--text-main) 8%, transparent);
}

.modal-bottom-sheet > .modal-content {
    padding: var(--spacing-md) var(--spacing-lg) var(--spacing-xl);
}

/* Modal Tab Switcher */
.modal-tab-switcher {
    display: flex;
    gap: 0;
    border-bottom: 1px solid var(--glass-border);
    margin-bottom: var(--spacing-md);
    overflow-x: auto;
}

.modal-tab-btn {
    flex: 1;
    padding: var(--spacing-3) var(--spacing-md);
    border: none;
    border-bottom: 2px solid transparent;
    background: transparent;
    color: var(--text-dim);
    font-family: inherit;
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    white-space: nowrap;
}

.modal-tab-btn.active {
    color: var(--primary);
    border-bottom-color: var(--primary);
}

.modal-tab-btn:hover:not(.active) {
    background: color-mix(in srgb, var(--primary) 6%, transparent);
}

.modal-tab-content {
    display: none;
}

.modal-tab-content.active {
    display: block;
}

.modal-content-wrapper {
    padding: 0;
}

/* ==================== */
/* MD3 Switch */
/* ==================== */
.md3-switch {
    position: relative;
    display: inline-flex;
    align-items: center;
    width: 52px;
    height: 32px;
    cursor: pointer;
}

.md3-switch input {
    opacity: 0;
    width: 0;
    height: 0;
    position: absolute;
}

.md3-switch-track {
    position: absolute;
    inset: 0;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-surface-container-highest, #353438);
    border: 2px solid var(--md-sys-color-outline, #8F9099);
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
}

.md3-switch-thumb {
    position: absolute;
    left: var(--spacing-1-5);
    top: 50%;
    transform: translateY(-50%);
    width: 16px;
    height: 16px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-outline, #8F9099);
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
    z-index: 1;
}

.md3-switch input:checked ~ .md3-switch-track {
    background: var(--primary);
    border-color: var(--primary);
}

.md3-switch input:checked ~ .md3-switch-thumb {
    left: 28px;
    width: 24px;
    height: 24px;
    background: var(--text-inverse);
}

/* ==================== */
/* MD3 Progress Bar */
/* ==================== */
.md3-progress-bar {
    width: 100%;
    height: 4px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: hidden;
}

.md3-progress-bar-indicator {
    height: 100%;
    background: var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    transition: width var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-standard);
}

/* ==================== */
/* Mood Chip Strip */
/* ==================== */
.mood-selector-group {
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--glass-border);
}

.mood-chip-strip {
    display: flex;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
    justify-content: center;
}

.mood-chip {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 48px;
    height: 48px;
    border: 2px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    -webkit-tap-highlight-color: transparent;
}

.mood-chip .material-symbols-outlined,
.mood-chip .svg-icon {
    font-size: var(--md-sys-typescale-headline-small-size);
}

.mood-chip:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-color: var(--primary);
}

.mood-chip.selected,
.mood-chip.active {
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    border-color: var(--md-sys-color-secondary-container, var(--accent-hover));
    transform: scale(1.1);
}

/* ==================== */
/* Photo Upload */
/* ==================== */
.photo-upload-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: var(--spacing-3);
    margin-top: var(--spacing-sm);
}

@media (max-width: 400px) {
    .photo-upload-grid {
        grid-template-columns: repeat(3, 1fr);
    }
}

.photo-upload-slot {
    text-align: center;
}

.photo-upload-label {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-1-5);
    cursor: pointer;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim);
}

.photo-preview-circle {
    width: 56px;
    height: 56px;
    border-radius: var(--md-sys-shape-corner-full);
    border: 2px dashed var(--glass-border);
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-dim2);
    overflow: hidden;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    background: var(--input-bg);
}

.photo-preview-circle:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.photo-preview-circle img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.photo-upload-progress {
    margin-top: var(--spacing-3);
}

/* ==================== */
/* Symptoms & Medications */
/* ==================== */
.symptoms-container,
.medications-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

/* ── Symptom Item ── */
.symptom-item,
.medication-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
    padding: var(--spacing-md);
    background: var(--md-sys-color-surface-container, var(--glass-bg));
    border: 1px solid var(--md-sys-color-outline-variant, var(--glass-border));
    border-radius: var(--md-sys-shape-corner-large);
}

/* ── Severity (Stars) ── */
.severity-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxs);
}

.severity-label {
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    color: var(--text-dim);
}

.severity-stars {
    display: flex;
    gap: var(--spacing-xxs);
    align-items: center;
}

.severity-star {
    cursor: pointer;
    line-height: 1;
    transition: transform var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    -webkit-user-select: none;
    user-select: none;
}

.severity-star:hover {
    transform: scale(1.2);
}

.severity-star.filled .material-symbols-outlined,
.severity-star.filled .svg-icon {
    color: #F5C518;          /* gold */
    font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 20;
}

.severity-star.empty .material-symbols-outlined,
.severity-star.empty .svg-icon {
    color: var(--text-dim);
    font-variation-settings: 'FILL' 0, 'wght' 300, 'GRAD' 0, 'opsz' 20;
}

/* pointer-events on inner icon — route clicks to outer span */
.severity-star .material-symbols-outlined,
.severity-star .svg-icon {
    pointer-events: none;
    font-size: 22px;
}

/* ── Remove Buttons ── */
.remove-symptom-btn,
.remove-medication-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    padding: var(--spacing-3) var(--spacing-md);
    gap: var(--spacing-xs);
    background: color-mix(in srgb, var(--md-sys-color-error, #BA1A1A) 18%, transparent);
    border: 1px solid color-mix(in srgb, var(--md-sys-color-error, #BA1A1A) 40%, transparent);
    border-radius: var(--md-sys-shape-corner-medium);
    color: var(--md-sys-color-error, #CF6679);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.remove-symptom-btn:hover,
.remove-medication-btn:hover {
    background: color-mix(in srgb, var(--md-sys-color-error, #BA1A1A) 30%, transparent);
}

/* ── Medication dose input ── */
.medication-dose-input {
    width: 100%;
}

/* ── Empty states ── */
.symptoms-empty-state,
.medications-empty-state {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xl) var(--spacing-md);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-medium-size);
    text-align: center;
}

.symptoms-empty-state-icon,
.medications-empty-state-icon {
    opacity: 0.4;
}

/* ==================== */
/* Next Measurement Info */
/* ==================== */
.next-measurement-info {
    padding: var(--spacing-3) var(--spacing-md);
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-radius: var(--md-sys-shape-corner-medium);
    margin-bottom: var(--spacing-md);
    border-left: 3px solid var(--primary);
}

.next-measurement-info p {
    margin: 0;
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-dim);
}

/* ==================== */
/* Settings Tab */
/* ==================== */
.settings-section {
    margin-bottom: var(--spacing-md);
}

.settings-section h3 {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-sm);
}

.settings-section.info h3 {
    color: var(--info);
}

.setting-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-md);
}

.setting-item h3 {
    margin: 0;
    flex: 1;
}

.setting-item select {
    width: auto;
    min-width: 120px;
}

/* Accent Color Grid */
.accent-color-grid {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-2-5);
    margin-top: var(--spacing-3);
    padding-top: var(--spacing-3);
    border-top: 1px solid var(--glass-border);
}

.accent-chip {
    width: 36px;
    height: 36px;
    border-radius: var(--md-sys-shape-corner-full);
    border: 3px solid transparent;
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
    box-shadow: var(--md-sys-elevation-1);
}

.accent-chip:hover {
    transform: scale(1.15);
}

.accent-chip.active,
.accent-chip.selected {
    border-color: var(--text-main);
    transform: scale(1.2);
    box-shadow: var(--md-sys-elevation-3);
}

.custom-color-btn {
    position: relative;
}

/* API Key Input */
.api-key-input-wrapper {
    display: flex;
    gap: var(--spacing-xs);
    align-items: center;
}

.api-key-input-wrapper input {
    flex: 1;
}

.api-key-toggle {
    flex-shrink: 0;
}

/* ==================== */
/* My Page Tab */
/* ==================== */
.my-section {
    margin-bottom: var(--spacing-md);
}

.my-section h3 {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-3);
}

/* Account Section */
.account-section .account-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    margin-bottom: var(--spacing-md);
}

.account-avatar {
    width: 56px;
    height: 56px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-surface-container-highest, var(--input-bg));
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--text-dim);
    overflow: hidden;
    flex-shrink: 0;
    position: relative; /* needed for edit-btn overlay */
    cursor: pointer;
}

/* Edit overlay button (photo_camera icon, bottom-right corner) */
.account-avatar-edit-btn {
    position: absolute;
    bottom: -1px;
    right: -1px;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--md-sys-color-primary, #6750A4);
    color: var(--md-sys-color-on-primary, #fff);
    border: 2px solid var(--md-sys-color-surface, #fff);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    transition: opacity 0.15s, transform 0.15s;
    z-index: 1;
    /* keep overflow hidden on parent from clipping us */
    margin: 0;
    padding: 0;
}

.account-avatar-edit-btn:hover {
    opacity: 0.88;
    transform: scale(1.08);
}

/* Override overflow:hidden so the edit btn corner stays visible */
.account-avatar {
    overflow: visible;
}

/* But keep the actual photo/SVG clipped inside the circle */
.account-avatar > img,
.account-avatar > svg:first-of-type {
    border-radius: var(--md-sys-shape-corner-full);
    overflow: hidden;
}

.account-info {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxs);
    min-width: 0;
}

.account-name {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
}

.account-email {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.account-actions {
    display: flex;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
}

/* Persona Grid */
.persona-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
    margin-bottom: var(--spacing-md);
}

@media (max-width: 400px) {
    .persona-grid {
        grid-template-columns: 1fr;
    }
}

/* Target Grid */
.target-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
}

@media (max-width: 400px) {
    .target-grid {
        grid-template-columns: 1fr;
    }
}

/* Goal Textarea & Actions */
.goal-textarea {
    min-height: 80px;
}

.goal-char-counter {
    text-align: right;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    margin-top: var(--spacing-xs);
}

.goal-actions {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    margin-top: var(--spacing-md);
    flex-wrap: wrap;
}

/* History View */
.history-view {
    margin-top: var(--spacing-3);
}

.table-responsive {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
}

.horizontal-scroll {
    scrollbar-width: thin;
}

/* ---- Filter Buttons (pill chips, matches .legend-button style) ---- */
#my-history-filter-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: var(--spacing-3);
}

#my-history-cards-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0;
}

.filter-button {
    font-size: 0.72rem;
    padding: var(--spacing-xs) var(--spacing-2-5);
    border-radius: var(--md-sys-shape-corner-full, 20px);
    border: 1.5px solid var(--glass-border);
    background: var(--glass-bg);
    color: var(--text-secondary);
    cursor: pointer;
    transition: background 0.15s, color 0.15s, border-color 0.15s;
    white-space: nowrap;
    line-height: 1.4;
}

.filter-button:hover {
    filter: brightness(1.15);
}

.filter-button.active {
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    border-color: transparent;
}

/* ---- History Card ---- */
.history-card {
    margin-bottom: var(--spacing-3);
    padding: var(--spacing-md);
    overflow: hidden;
}

.history-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-2);
    font-size: 0.85rem;
    font-weight: var(--font-weight-bold);
    color: var(--text-primary);
}

.history-card-header h4 {
    margin: 0;
    font-size: inherit;
}

.history-card-body {
    margin-bottom: var(--spacing-2);
    overflow: hidden;
    border-radius: 8px;
}

.history-card .button-group {
    margin-top: var(--spacing-2);
}

.inner-table-wrapper {
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
}

.inner-history-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.75rem;
}

.inner-history-table th,
.inner-history-table td {
    padding: 6px 8px;
    text-align: center;
    white-space: nowrap;
    max-width: 120px;
    overflow: hidden;
    text-overflow: ellipsis;
}

.inner-history-table th {
    color: var(--text-dim);
    font-weight: 500;
    border-bottom: 1px solid var(--glass-border);
}

.inner-history-table td {
    color: var(--text-primary);
}

/* ---- History Card Tags (medications & symptoms as hashtag chips) ---- */
.history-card-tags {
    padding: var(--spacing-sm) var(--spacing-md);
    border-top: 1px solid color-mix(in srgb, var(--glass-border) 60%, transparent);
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.history-card-tags-row {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
}

.history-tag-label {
    font-size: 11px;
    font-weight: 600;
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
    white-space: nowrap;
    padding-top: 5px;
    min-width: fit-content;
    opacity: 0.75;
}

.history-tag-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
}

.history-tag-chip {
    display: inline-flex;
    align-items: center;
    height: 24px;
    padding: 0 8px;
    border-radius: var(--md-sys-shape-corner-small);
    font-size: 11px;
    font-weight: 500;
    background: transparent;
    border: 1px solid var(--md-sys-color-outline, var(--glass-border));
    color: var(--md-sys-color-on-surface-variant, var(--text-secondary));
    white-space: nowrap;
    cursor: default;
    pointer-events: none;
}

/* ---- History Table tags sub-row (desktop) ---- */
.history-tags-row .history-tags-cell {
    padding: 4px 10px 8px;
    text-align: left;
}

.history-tags-row td {
    background: color-mix(in srgb, var(--glass-bg, transparent) 40%, transparent);
    border-bottom: 1px solid color-mix(in srgb, var(--glass-border) 40%, transparent);
}

/* ---- History Table (Desktop) ---- */
.history-table {
    width: 100%;
    border-collapse: collapse;
    font-size: 0.78rem;
}

.history-table th,
.history-table td {
    padding: 8px 10px;
    text-align: center;
    white-space: nowrap;
    max-width: 140px;
    overflow: hidden;
    text-overflow: ellipsis;
    border-bottom: 1px solid color-mix(in srgb, var(--glass-border) 50%, transparent);
}

.history-table th {
    color: var(--text-dim);
    font-weight: 600;
    font-size: 0.72rem;
    position: sticky;
    top: 0;
    background: var(--surface-bg);
    z-index: 2;
}

.history-table td {
    color: var(--text-primary);
}

.history-table tr:hover td {
    background: color-mix(in srgb, var(--primary) 6%, transparent);
}

/* ---- Sticky Action Column (desktop table) ---- */
.history-table .sticky-col {
    position: sticky;
    right: 0;
    z-index: 3;
    background: var(--surface-bg);
    border-left: 1px solid var(--glass-border);
    white-space: nowrap;
    min-width: 110px;
}

.history-table thead .sticky-col {
    z-index: 4;
}

.action-buttons {
    display: flex;
    gap: 6px;
    justify-content: center;
}

.action-buttons .glass-button {
    font-size: 0.72rem;
    padding: 4px 10px;
}

/* ---- Wrap cells (symptoms/meds) ---- */
.wrap-cell {
    white-space: normal !important;
    max-width: 180px;
    word-break: break-word;
}

.col-symptoms,
.col-medications {
    min-width: 120px;
}

/* ---- Memo Text (history cards) ---- */
.memo-text {
    font-size: 0.78rem;
    color: var(--text-secondary);
    padding: var(--spacing-1-5) 0 2px;
    margin: 0;
    overflow: hidden;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    line-clamp: 2;
    -webkit-box-orient: vertical;
    line-height: 1.4em;
    max-height: 2.8em;
}

.memo-text.expanded {
    -webkit-line-clamp: unset;
    line-clamp: unset;
    max-height: none;
    display: block;
}

.memo-expand-btn {
    display: inline-flex;
    align-items: center;
    gap: 3px;
    font-size: 11px;
    color: var(--primary, #D0BCFF);
    background: none;
    border: none;
    cursor: pointer;
    padding: 2px 0 6px;
    font-family: inherit;
}

/* ==================== */
/* Diary Tab */
/* ==================== */
.diary-calendar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-3);
}

.diary-month-title {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    margin: 0;
    color: var(--text-main);
}

.diary-calendar {
    padding: var(--spacing-md);
}

.diary-weekday-row {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    text-align: center;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    color: var(--text-dim);
    margin-bottom: var(--spacing-sm);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--glass-border);
}

.diary-day-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 4px;
}

/* ---- Cell ---- */
.diary-day-cell {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    cursor: pointer;
}

.diary-cell-inner {
    width: 100%;
    aspect-ratio: 1;
    min-height: 0;
    border-radius: 12px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    background: color-mix(in srgb, var(--primary) var(--score-opacity, 0%), color-mix(in srgb, var(--glass-bg) 70%, transparent));
    border: 1.5px solid transparent;
    position: relative;
    transition: transform 0.15s ease, background 0.3s ease, box-shadow 0.2s ease;
    overflow: hidden;
}

/* Entry cells: subtle elevation (background handled by --score-opacity above) */
.diary-day-cell.has-entry .diary-cell-inner {
    border-color: color-mix(in srgb, var(--glass-border) 50%, transparent);
    box-shadow: 0 4px 14px rgba(0,0,0,0.28), 0 1px 3px rgba(0,0,0,0.15);
}

.diary-day-cell:active .diary-cell-inner {
    transform: scale(0.94);
}

.diary-day-cell.empty {
    pointer-events: none;
}
.diary-day-cell.empty .diary-cell-inner {
    background: transparent;
    border-color: transparent;
}

.diary-day-cell.today .diary-cell-inner {
    border: 2px solid var(--primary) !important;
    box-shadow: 0 0 0 2px color-mix(in srgb, var(--primary) 20%, transparent), 0 4px 14px rgba(0,0,0,0.28) !important;
}

/* Mood dot — small colored circle below emoji */
.diary-mood-dot {
    width: 7px;
    height: 7px;
    border-radius: 50%;
    flex-shrink: 0;
    opacity: 0.85;
}
.diary-day-cell.mood-great .diary-mood-dot   { background: #c084fc; }
.diary-day-cell.mood-good .diary-mood-dot    { background: #93c5fd; }
.diary-day-cell.mood-okay .diary-mood-dot    { background: #9ca3af; }
.diary-day-cell.mood-bad .diary-mood-dot     { background: #fbbf24; }
.diary-day-cell.mood-terrible .diary-mood-dot { background: #f87171; }

.diary-cell-emoji {
    width:  clamp(20px, 6.5vw, 40px);
    height: clamp(20px, 6.5vw, 40px);
    object-fit: contain;
    display: block;
    pointer-events: none;
    user-select: none;
    margin-top: 4px;
}

/* Noto Animated Emoji in chips and calendar */
.noto-emoji {
    display: inline-block;
    vertical-align: middle;
    pointer-events: none;
    user-select: none;
}

/* Size contexts */
.diary-eval-chip  .noto-emoji { width: 28px; height: 28px; }
.diary-emotion-chip .noto-emoji { width: 24px; height: 24px; }

.diary-day-num {
    font-size: 10px;
    line-height: 1;
    color: var(--text-dim);
    font-weight: 500;
}

.diary-day-cell.today .diary-day-num {
    color: var(--primary);
    font-weight: var(--font-weight-bold);
}

/* Score number — minimal top-right */
.diary-score-badge {
    position: absolute;
    top: 4px;
    right: 5px;
    font-size: 9px;
    font-weight: 700;
    color: rgba(255,255,255,0.55);
    line-height: 1;
    letter-spacing: -0.3px;
}

/* Has-text dot (small indicator) */
.diary-day-cell.has-text .diary-cell-inner::after {
    content: '';
    position: absolute;
    bottom: 3px;
    left: 3px;
    width: 5px;
    height: 5px;
    border-radius: 50%;
    background: color-mix(in srgb, var(--primary) 60%, transparent);
}

/* Diary Inline Actions */
.diary-inline-actions {
    display: flex;
    justify-content: center;
    gap: var(--spacing-3);
    margin-top: var(--spacing-md);
}

.diary-action-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-1-5);
}

/* ========================= */
/* Diary Bottom Sheet        */
/* ========================= */
.diary-bottom-sheet {
    position: fixed;
    inset: 0;
    z-index: var(--z-index-modal);
    display: none;
    pointer-events: none;
}

.diary-bottom-sheet.active,
.diary-bottom-sheet.open {
    display: block;
    pointer-events: auto;
}

.diary-sheet-backdrop {
    position: absolute;
    inset: 0;
    background: var(--modal-backdrop);
    opacity: 0;
    transition: opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.diary-bottom-sheet.active .diary-sheet-backdrop,
.diary-bottom-sheet.open .diary-sheet-backdrop {
    opacity: 1;
}

.diary-sheet-surface {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    max-height: 92vh;
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
    padding: var(--spacing-sm) var(--spacing-lg) var(--spacing-xl);
    overflow-y: auto;
    transform: translateY(100%);
    transition: transform var(--md-sys-motion-duration-medium4) var(--md-sys-motion-easing-emphasized);
}

.diary-bottom-sheet.active .diary-sheet-surface,
.diary-bottom-sheet.open .diary-sheet-surface {
    transform: translateY(0);
}

.diary-sheet-handle {
    width: 32px;
    height: 4px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-outline-variant, var(--glass-border));
    margin: 0 auto var(--spacing-md);
}

.diary-sheet-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-md);
}

.diary-sheet-date {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    margin: 0;
    color: var(--text-main);
}

.diary-sheet-section {
    margin-bottom: var(--spacing-5);
}

.diary-sheet-label {
    display: block;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-dim);
    margin-bottom: var(--spacing-sm);
}

/* Evaluation chips (5 moods, full width row) */
.diary-eval-row {
    display: flex;
    gap: 6px;
}

.diary-eval-chip {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    padding: 10px 4px 8px;
    border-radius: 12px;
    border: 1.5px solid var(--glass-border);
    background: var(--glass-bg);
    cursor: pointer;
    font-size: 22px;
    transition: all 0.15s ease;
    color: var(--text-main);
}

.diary-eval-chip span {
    font-size: 9px;
    color: var(--text-dim);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.diary-eval-chip.active,
.diary-eval-chip[data-evaluation="great"].active  { background: rgba(192,132,252,0.25); border-color: rgba(192,132,252,0.6); }
.diary-eval-chip[data-evaluation="good"].active   { background: rgba(147,197,253,0.25); border-color: rgba(147,197,253,0.6); }
.diary-eval-chip[data-evaluation="okay"].active   { background: rgba(156,163,175,0.20); border-color: rgba(156,163,175,0.6); }
.diary-eval-chip[data-evaluation="bad"].active    { background: rgba(251,191, 36,0.22); border-color: rgba(251,191, 36,0.6); }
.diary-eval-chip[data-evaluation="terrible"].active { background: rgba(248,113,113,0.22); border-color: rgba(248,113,113,0.6); }

/* Emotion chips (8 emotions, 4×2 grid) */
.diary-emotion-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 6px;
}

.diary-emotion-chip {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 3px;
    padding: 8px 4px 6px;
    border-radius: 10px;
    border: 1.5px solid var(--glass-border);
    background: var(--glass-bg);
    cursor: pointer;
    font-size: 20px;
    transition: all 0.15s ease;
    color: var(--text-main);
}

.diary-emotion-chip span {
    font-size: 9px;
    color: var(--text-dim);
    white-space: nowrap;
}

.diary-emotion-chip.active {
    background: color-mix(in srgb, var(--primary) 20%, transparent);
    border-color: var(--primary);
}

/* Score slider */
.diary-score-label-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.diary-score-value {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--font-weight-bold);
    color: var(--primary);
    min-width: 2ch;
    text-align: right;
}

.diary-score-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.diary-score-min,
.diary-score-max {
    font-size: 12px;
    color: var(--text-dim);
    flex-shrink: 0;
}

.diary-score-slider {
    flex: 1;
    -webkit-appearance: none;
    appearance: none;
    height: 6px;
    border-radius: 3px;
    background: var(--glass-border);
    outline: none;
    cursor: pointer;
}

.diary-score-slider::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    box-shadow: 0 2px 6px rgba(0,0,0,0.25);
    transition: transform 0.1s ease;
}

.diary-score-slider::-webkit-slider-thumb:active {
    transform: scale(1.2);
}

.diary-score-slider::-moz-range-thumb {
    width: 22px;
    height: 22px;
    border-radius: 50%;
    background: var(--primary);
    cursor: pointer;
    border: none;
    box-shadow: 0 2px 6px rgba(0,0,0,0.25);
}

.diary-textarea-wrapper {
    position: relative;
}

.diary-textarea {
    width: 100%;
    min-height: 100px;
    resize: vertical;
}

.diary-char-counter {
    position: absolute;
    bottom: var(--spacing-sm);
    right: var(--spacing-3);
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
}

.diary-sheet-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-md);
    padding-top: var(--spacing-md);
    border-top: 1px solid var(--glass-border);
}

/* ==================== */
/* Auth Modal */
/* ==================== */
.auth-logo-container {
    display: flex;
    justify-content: center;
    margin-bottom: var(--spacing-lg);
}

#auth-modal .modal-content {
    text-align: left;
}

#auth-modal .divider {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-small-size);
}

#auth-modal .divider::before,
#auth-modal .divider::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--glass-border);
}

/* ==================== */
/* Hormone Report */
/* ==================== */
.hormone-report-container {
    padding: 0;
}

.briefing-section,
.hormone-section {
    margin-bottom: var(--spacing-5);
    padding: var(--spacing-md);
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    border: 1px solid var(--glass-border);
}

.hormone-section-header {
    margin-bottom: var(--spacing-3);
}

.hormone-section-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-2-5);
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    margin: 0;
    color: var(--text-main);
}

.section-number {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--primary);
    color: var(--text-inverse);
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--font-weight-bold);
    flex-shrink: 0;
}

.hormone-section-desc {
    margin: 4px 0 0;
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim);
    line-height: 1.4;
}

/* ─── Hormone Grid & Cards ─── */
.hormone-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: var(--spacing-3, 12px);
}

.hormone-card {
    padding: var(--spacing-3, 12px) var(--spacing-md, 16px);
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.06));
}

.hormone-card.highlight-card {
    background: linear-gradient(135deg,
        rgba(208,188,255,0.08) 0%,
        rgba(208,188,255,0.02) 100%);
    border-color: rgba(208,188,255,0.15);
}

.hormone-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-sm, 8px);
}

.hormone-name {
    font-size: var(--md-sys-typescale-title-small-size, 14px);
    font-weight: 600;
    color: var(--text-main, #e0e0e0);
    margin: 0;
}

.hormone-current-value {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    margin-bottom: var(--spacing-sm, 8px);
}

.hormone-current-mini {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    font-weight: 600;
    color: var(--primary, #D0BCFF);
    white-space: nowrap;
}

.hormone-target {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: var(--spacing-sm, 8px);
    font-size: var(--md-sys-typescale-body-small-size, 12px);
}

.target-label {
    color: var(--text-dim, #a0a0a0);
}

.target-value {
    color: var(--text-main, #e0e0e0);
    font-weight: 600;
}

/* Status Badges */
.status-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: var(--md-sys-shape-corner-full, 9999px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 600;
}

.optimal-badge {
    background: rgba(76,175,80,0.12);
    color: var(--success, #4CAF50);
}

.danger-badge {
    background: rgba(255,84,73,0.12);
    color: var(--md-sys-color-error, #FF5449);
}

.above-badge {
    background: rgba(255,180,0,0.12);
    color: var(--warning, #FFB400);
}

.below-badge {
    background: rgba(100,181,246,0.12);
    color: var(--info, #64B5F6);
}

.neutral-badge {
    background: var(--glass-bg, rgba(255,255,255,0.04));
    color: var(--text-dim, #a0a0a0);
}

.status-icon {
    font-size: 16px !important;
    vertical-align: middle;
}

/* Change Metrics (Section 3) */
.change-metrics {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.change-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 6px 0;
    border-bottom: 1px solid var(--glass-border, rgba(255,255,255,0.04));
}

.change-item:last-child {
    border-bottom: none;
}

.change-label {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim, #a0a0a0);
}

.change-value {
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
    font-weight: 600;
    color: var(--text-main, #e0e0e0);
}

.change-value.positive {
    color: var(--success, #4CAF50);
}

.change-value.negative {
    color: var(--md-sys-color-error, #FF5449);
}

/* Info Cards */
.info-card {
    padding: var(--spacing-3, 12px) var(--spacing-md, 16px);
    background: rgba(208,188,255,0.04);
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    border: 1px dashed rgba(208,188,255,0.15);
    margin-bottom: var(--spacing-3, 12px);
}

.info-card.mini {
    padding: var(--spacing-sm, 8px) var(--spacing-3, 12px);
}

.info-card-title {
    font-size: var(--md-sys-typescale-label-medium-size, 12px);
    font-weight: 600;
    color: var(--primary, #D0BCFF);
    margin: 0 0 6px;
    display: flex;
    align-items: center;
    gap: 4px;
}

.info-card-content p,
.info-card-text {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim, #a0a0a0);
    line-height: 1.5;
    margin: 4px 0;
}

.info-card-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-sm, 8px);
    margin-bottom: var(--spacing-3, 12px);
}

/* Emax Special Card */
.emax-special {
    text-align: center;
}

.emax-metrics {
    display: flex;
    align-items: stretch;
    justify-content: center;
    gap: 0;
}

.emax-item {
    flex: 1;
    padding: var(--spacing-sm, 8px);
}

.emax-label {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim, #a0a0a0);
    margin-bottom: 4px;
}

.emax-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-main, #e0e0e0);
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
}

.emax-value.positive { color: var(--success, #4CAF50); }
.emax-value.negative { color: var(--md-sys-color-error, #FF5449); }

.emax-unit {
    font-size: 10px;
    color: var(--text-dim2, #777);
    margin-top: 2px;
}

.emax-message {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim, #a0a0a0);
    margin-top: 4px;
}

.emax-divider {
    width: 1px;
    background: var(--glass-border, rgba(255,255,255,0.06));
    margin: 4px 0;
}

.primary-color {
    color: var(--primary, #D0BCFF) !important;
}

/* Stability Display */
.stability-display {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm, 8px);
    text-align: center;
}

.stability-cv {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.stability-cv-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--text-main, #e0e0e0);
}

.stability-cv-label {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim2, #777);
}

.stability-status {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 12px;
    border-radius: var(--md-sys-shape-corner-full, 9999px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 600;
}

.stability-status.stable {
    background: rgba(76,175,80,0.12);
    color: var(--success, #4CAF50);
}

.stability-status.moderate {
    background: rgba(255,180,0,0.12);
    color: var(--warning, #FFB400);
}

.stability-status.unstable {
    background: rgba(255,84,73,0.12);
    color: var(--md-sys-color-error, #FF5449);
}

/* Prediction Cards */
.prediction-card .prediction-display {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.prediction-card .prediction-item {
    display: flex;
    flex-direction: column;
    gap: 2px;
    padding: 8px;
    background: transparent;
    border: none;
    cursor: default;
}

.prediction-card .prediction-item:hover {
    border-color: transparent;
}

.prediction-card .prediction-label {
    display: flex;
    align-items: center;
    gap: 4px;
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim, #a0a0a0);
}

.prediction-card .prediction-value {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
}

.prediction-target {
    font-size: 10px;
    color: var(--text-dim2, #777);
}

/* Drug Influence Cards */
.drug-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--spacing-3, 12px);
}

.drug-card {
    padding: var(--spacing-3, 12px);
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.06));
}

.drug-card-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    margin-bottom: var(--spacing-sm, 8px);
}

.drug-name {
    font-size: var(--md-sys-typescale-title-small-size, 14px);
    font-weight: 600;
    color: var(--text-main, #e0e0e0);
    margin: 0;
    display: flex;
    align-items: center;
    gap: 4px;
}

.drug-samples {
    font-size: 10px;
    color: var(--text-dim2, #777);
    background: var(--glass-bg, rgba(255,255,255,0.04));
    padding: 2px 8px;
    border-radius: var(--md-sys-shape-corner-full, 9999px);
}

.drug-influences {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-bottom: var(--spacing-sm, 8px);
}

.drug-influence-item {
    display: flex;
    align-items: center;
    gap: 8px;
}

.drug-hormone-label {
    font-size: var(--md-sys-typescale-label-medium-size, 12px);
    font-weight: 700;
    color: var(--text-dim, #a0a0a0);
    min-width: 20px;
}

.drug-influence-value {
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
    font-weight: 600;
}

.drug-influence-value.positive { color: var(--success, #4CAF50); }
.drug-influence-value.negative { color: var(--md-sys-color-error, #FF5449); }

.drug-influence-unit {
    font-size: 10px;
    color: var(--text-dim2, #777);
}

.drug-confidence {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 4px 8px;
    border-radius: var(--md-sys-shape-corner-small, 8px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
}

.drug-confidence.high {
    background: rgba(76,175,80,0.08);
    color: var(--success, #4CAF50);
}

.drug-confidence.medium {
    background: rgba(255,180,0,0.08);
    color: var(--warning, #FFB400);
}

.drug-confidence.low {
    background: rgba(255,84,73,0.08);
    color: var(--md-sys-color-error, #FF5449);
}

.confidence-label {
    color: var(--text-dim, #a0a0a0);
}

.confidence-value {
    font-weight: 600;
}

/* Body Ratio Cards */
.body-ratio-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3, 12px);
}

.body-ratio-card {
    padding: var(--spacing-3, 12px) var(--spacing-md, 16px);
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.06));
}

.body-ratio-name {
    font-size: var(--md-sys-typescale-title-small-size, 14px);
    font-weight: 600;
    color: var(--text-main, #e0e0e0);
    margin: 0 0 var(--spacing-sm, 8px);
    display: flex;
    align-items: center;
    gap: 4px;
}

.ratio-value-display {
    text-align: center;
    margin-top: var(--spacing-sm, 8px);
}

.ratio-number {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-main, #e0e0e0);
}

.ratio-card {
    padding: var(--spacing-3, 12px) var(--spacing-md, 16px);
}

/* Responsive: mobile stacking */
@media (max-width: 480px) {
    .hormone-grid {
        grid-template-columns: 1fr;
    }
    .info-card-grid {
        grid-template-columns: 1fr;
    }
    .drug-grid {
        grid-template-columns: 1fr;
    }
    .emax-metrics {
        flex-direction: column;
    }
    .emax-divider {
        width: 100%;
        height: 1px;
        margin: 0 4px;
    }
}

/* Progress Bar */
.progress-container,
.body-change-container {
    margin-top: var(--spacing-sm);
}

.progress-bar-wrapper,
.body-change-bar-wrapper {
    margin-bottom: var(--spacing-sm);
}

.progress-bar,
.body-change-bar {
    width: 100%;
    height: 8px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: hidden;
    margin-bottom: var(--spacing-1-5);
}

.progress-fill,
.body-change-fill {
    height: 100%;
    background: var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    transition: width var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
}

.progress-info,
.body-change-info {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
}

.progress-change-info,
.body-change-details {
    display: flex;
    gap: var(--spacing-md);
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    flex-wrap: wrap;
}

.change-item {
    display: flex;
    gap: var(--spacing-xs);
}

/* ==================== */
/* Chart Section */
/* ==================== */
.chart-section {
    margin-bottom: var(--spacing-lg, 24px);
}

.chart-section h4 {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
    margin-bottom: var(--spacing-xs, 4px);
}

.chart-wrapper {
    background: var(--chart-wrapper-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    padding: var(--spacing-3);
    position: relative;
}

.chart-wrapper canvas {
    width: 100% !important;
    max-height: clamp(180px, 35vw, 360px);
}

.hormone-legend-controls {
    margin-bottom: var(--spacing-sm);
}

.comparison-filter-controls {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-1-5);
    margin-bottom: var(--spacing-3);
}

.selected-week-data-container {
    margin-top: var(--spacing-3);
    padding: var(--spacing-3) var(--spacing-md);
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    border: 1px solid var(--glass-border);
}

.selected-week-data-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-sm);
}

.placeholder-text {
    text-align: center;
    color: var(--text-dim2);
    font-size: var(--md-sys-typescale-body-small-size);
    padding: var(--spacing-sm);
}

/* ==================== */
/* Roadmap */
/* ==================== */
.roadmap-section {
    margin-bottom: var(--spacing-5);
}

.roadmap-section h3 {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-3);
}

.roadmap-progress-container {
    padding: var(--spacing-sm) 0;
}

.roadmap-progress-bar {
    position: relative;
    width: 100%;
    height: 12px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: visible;
    margin-bottom: var(--spacing-sm);
}

.roadmap-progress-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    transition: width var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
    z-index: 1;
}

.roadmap-progress-segments,
.roadmap-progress-ticks {
    position: absolute;
    inset: 0;
    z-index: 2;
}

.roadmap-progress-trajectory {
    position: absolute;
    inset: 0;
    z-index: 3;
}

.roadmap-progress-marker {
    position: absolute;
    top: 50%;
    width: 12px;
    height: 12px;
    border-radius: var(--md-sys-shape-corner-full);
    transform: translate(-50%, -50%);
    z-index: 4;
    border: 2px solid var(--glass-bg);
}

.roadmap-progress-marker.start { left: 0; background: var(--text-dim2); }
.roadmap-progress-marker.current { background: var(--primary); }
.roadmap-progress-marker.target { right: 0; left: auto; background: var(--success); }

.roadmap-progress-labels {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    margin-bottom: var(--spacing-sm);
}

.roadmap-progress-info {
    display: flex;
    gap: var(--spacing-sm);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    flex-wrap: wrap;
}

.roadmap-progress-note {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    margin-top: var(--spacing-sm);
}

/* Roadmap Timeline */
.timeline-container {
    padding: 0;
}

/* Roadmap Standout */
.roadmap-standout {
    margin-bottom: var(--spacing-md);
}

.roadmap-standout h4 {
    font-size: var(--md-sys-typescale-title-small-size);
    color: var(--text-main);
    margin-bottom: var(--spacing-sm);
}

.roadmap-standout-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.monthly-summary-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

/* Roadmap Detail Switcher */
.roadmap-detail-switcher {
    margin-bottom: var(--spacing-md);
}

/* Roadmap Compare */
.roadmap-date-compare {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
    margin-bottom: var(--spacing-3);
}

.date-selector-field label {
    display: block;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    color: var(--text-dim);
    margin-bottom: var(--spacing-xs);
}

.roadmap-compare-actions {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-1-5);
    margin-bottom: var(--spacing-3);
}

.roadmap-action-btn {
    padding: var(--spacing-1-5) 14px;
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.roadmap-action-btn:hover {
    background: var(--glass-bg-light);
}

.comparison-results {
    margin-top: var(--spacing-3);
}

/* ==================== */
/* Photo Compare Tab    */
/* ==================== */
.photo-compare-controls {
    margin-bottom: var(--spacing-3);
}
.photo-compare-date-row {
    display: flex;
    align-items: flex-end;
    gap: var(--spacing-2);
}
.photo-compare-date-field {
    flex: 1;
}
.photo-compare-date-field label {
    display: block;
    font-size: var(--md-sys-typescale-label-medium-size, 0.75rem);
    font-weight: 600;
    color: var(--text-dim);
    margin-bottom: 4px;
}
.photo-compare-date-field select {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: 0.85rem;
}
.photo-compare-swap-btn {
    flex: 0 0 auto;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.2rem;
    padding: 0 !important;
    border-radius: var(--md-sys-shape-corner-full, 50%) !important;
}

.photo-compare-grid {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-4);
}

.photo-compare-row {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large, 16px);
    overflow: hidden;
}
.photo-compare-category {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 10px 14px;
    font-size: 0.85rem;
    font-weight: 600;
    color: var(--text-dim);
    border-bottom: 1px solid var(--glass-border);
    background: var(--glass-bg-light, rgba(255,255,255,0.03));
}
.photo-compare-pair {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 2px;
}
.photo-compare-cell {
    position: relative;
    aspect-ratio: 3/4;
    overflow: hidden;
    background: var(--md-sys-color-surface-container, rgba(0,0,0,0.15));
    display: flex;
    align-items: center;
    justify-content: center;
}
.photo-compare-cell img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}
.photo-compare-cell img:hover {
    transform: scale(1.05);
}
.photo-compare-cell.empty {
    opacity: 0.5;
}
.photo-compare-placeholder {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    color: var(--text-dim2);
    font-size: 0.75rem;
}
.photo-compare-date-label {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 4px 8px;
    background: linear-gradient(transparent, rgba(0,0,0,0.65));
    color: #fff;
    font-size: 0.7rem;
    text-align: center;
}
.photo-compare-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 48px 16px;
    text-align: center;
    color: var(--text-dim);
    gap: 12px;
}
.photo-compare-empty p {
    margin: 0;
    font-size: 0.95rem;
}
.photo-compare-hint {
    font-size: 0.8rem !important;
    color: var(--text-dim2) !important;
    max-width: 280px;
}

/* ==================== */
/* Compare Metric Cards */
/* ==================== */
.compare-metrics-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-2);
    margin-bottom: var(--spacing-3);
}
@media (max-width: 400px) {
    .compare-metrics-grid {
        grid-template-columns: 1fr;
    }
}
.compare-metric-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    padding: 12px 14px;
    transition: border-color 0.2s;
}
.compare-metric-card.positive {
    border-left: 3px solid var(--success, #4caf50);
}
.compare-metric-card.negative {
    border-left: 3px solid var(--error, #ef5350);
}
.compare-metric-card.neutral {
    border-left: 3px solid var(--text-dim2, #888);
}
.compare-metric-header {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    margin-bottom: 6px;
}
.compare-metric-name {
    font-size: 0.8rem;
    font-weight: 600;
    color: var(--text-main);
}
.compare-metric-unit {
    font-size: 0.7rem;
    color: var(--text-dim2);
}
.compare-metric-values {
    display: flex;
    align-items: center;
    gap: 6px;
    margin-bottom: 8px;
    font-size: 0.95rem;
}
.compare-val--old {
    color: var(--text-dim);
}
.compare-arrow {
    color: var(--text-dim2);
    display: flex;
}
.compare-val--new {
    font-weight: 700;
    color: var(--text-main);
}
.compare-metric-delta {
    position: relative;
    padding: 4px 8px;
    border-radius: 6px;
    background: var(--md-sys-color-surface-container, rgba(0,0,0,0.08));
    overflow: hidden;
}
.compare-delta-bar {
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    width: var(--bar-w, 0%);
    border-radius: 6px;
    opacity: 0.15;
}
.compare-metric-card.positive .compare-delta-bar { background: var(--success, #4caf50); }
.compare-metric-card.negative .compare-delta-bar { background: var(--error, #ef5350); }
.compare-metric-card.neutral .compare-delta-bar { background: var(--text-dim2); }
.compare-delta-text {
    position: relative;
    font-size: 0.78rem;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 3px;
}
.compare-metric-card.positive .compare-delta-text { color: var(--success, #4caf50); }
.compare-metric-card.negative .compare-delta-text { color: var(--error, #ef5350); }
.compare-metric-card.neutral .compare-delta-text { color: var(--text-dim2); }
.delta-arrow { display: flex; }

/* ==================== */
/* Compare Section Card */
/* ==================== */
.compare-section-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large, 16px);
    padding: 14px;
    margin-bottom: var(--spacing-2);
}
.compare-section-title {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: 0.85rem;
    font-weight: 700;
    color: var(--text-dim);
    margin: 0 0 10px 0;
}
.compare-chip-wrap {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}
.compare-chip {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    border-radius: var(--md-sys-shape-corner-full, 100px);
    font-size: 0.78rem;
    font-weight: 500;
    border: 1px solid var(--glass-border);
    background: var(--glass-bg);
    color: var(--text-main);
}
.compare-chip em {
    font-style: normal;
    font-weight: 700;
    font-size: 0.72rem;
}
.compare-chip.chip--added {
    border-color: var(--success, #4caf50);
    background: rgba(76, 175, 80, 0.08);
}
.compare-chip.chip--added em { color: var(--success, #4caf50); }
.compare-chip.chip--removed {
    border-color: var(--error, #ef5350);
    background: rgba(239, 83, 80, 0.08);
    text-decoration: line-through;
    opacity: 0.7;
}
.compare-chip.chip--removed em { color: var(--error, #ef5350); }
.compare-chip.chip--changed {
    border-color: var(--warning, #ffa726);
    background: rgba(255, 167, 38, 0.08);
}
.compare-chip.chip--changed em { color: var(--warning, #ffa726); }

/* ==================== */
/* Action Guide */
/* ==================== */
.action-guide {
    padding: 0;
}

/* ── Action Guide Tabs ── */
.action-guide-tabs {
    display: flex;
    gap: 0;
    margin-bottom: var(--spacing-4);
    background: var(--md-sys-color-surface-container);
    border-radius: var(--md-sys-shape-corner-large);
    padding: 4px;
}
.action-guide-tab {
    flex: 1;
    padding: 10px 0;
    border: none;
    background: transparent;
    color: var(--md-sys-color-on-surface-variant);
    font-size: 0.9rem;
    font-weight: 600;
    border-radius: var(--md-sys-shape-corner-medium);
    cursor: pointer;
    transition: all 0.2s ease;
}
.action-guide-tab.active {
    background: var(--primary);
    color: var(--md-sys-color-on-primary);
    box-shadow: 0 1px 3px rgba(0,0,0,0.15);
}
.action-guide-tab-panel {
    display: none;
}
.action-guide-tab-panel.active {
    display: block;
}

/* ── AI Tab ── */
.ag-ai-prompt-area {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-4);
}
.ag-ai-prompt-input {
    width: 100%;
    box-sizing: border-box;
    padding: 12px 14px;
    border: 1.5px solid var(--md-sys-color-outline-variant);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--md-sys-color-surface-container-low);
    color: var(--md-sys-color-on-surface);
    font-size: 0.9rem;
    font-family: inherit;
    resize: vertical;
    min-height: 60px;
    transition: border-color 0.2s;
}
.ag-ai-prompt-input:focus {
    outline: none;
    border-color: var(--primary);
}
.ag-ai-prompt-input::placeholder {
    color: var(--md-sys-color-on-surface-variant);
    opacity: 0.7;
}
.ag-ai-generate-btn {
    align-self: flex-end;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 10px 20px;
    border-radius: var(--md-sys-shape-corner-full);
    font-weight: 600;
}
.ag-ai-generate-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}
.ag-ai-results {
    min-height: 40px;
}
.ag-ai-loading {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    padding: var(--spacing-lg) 0;
    color: var(--md-sys-color-on-surface-variant);
    font-size: 0.9rem;
}
.ag-ai-spinner {
    width: 20px;
    height: 20px;
    border: 2.5px solid var(--md-sys-color-outline-variant);
    border-top-color: var(--primary);
    border-radius: 50%;
    animation: ag-spin 0.8s linear infinite;
}
@keyframes ag-spin {
    to { transform: rotate(360deg); }
}
.ag-ai-no-key,
.ag-ai-error {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: var(--spacing-md);
    background: color-mix(in srgb, var(--md-sys-color-error) 10%, transparent);
    color: var(--md-sys-color-error);
    border-radius: var(--md-sys-shape-corner-medium);
    font-size: 0.85rem;
}
.ag-ai-badge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    padding: 4px 10px;
    margin-bottom: var(--spacing-3);
    background: linear-gradient(135deg, color-mix(in srgb, var(--primary) 15%, transparent), color-mix(in srgb, var(--tertiary, var(--primary)) 10%, transparent));
    border-radius: var(--md-sys-shape-corner-full);
    font-size: 0.75rem;
    font-weight: 600;
    color: var(--primary);
}
.ag-ai-disclaimer {
    margin-top: var(--spacing-4);
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: 0.75rem;
    color: var(--md-sys-color-on-surface-variant);
    text-align: center;
    opacity: 0.8;
}

.action-guide-hero {
    text-align: center;
    padding: var(--spacing-lg) var(--spacing-md);
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-radius: var(--md-sys-shape-corner-large);
    margin-bottom: var(--spacing-5);
}

.action-guide-hero-title {
    font-size: var(--md-sys-typescale-label-large-size);
    color: var(--text-dim);
    margin-bottom: var(--spacing-sm);
    text-transform: uppercase;
    letter-spacing: 1px;
}

.action-guide-hero-main {
    margin-bottom: var(--spacing-sm);
}

.action-guide-dday {
    font-size: var(--md-sys-typescale-display-medium-size);
    font-weight: var(--font-weight-bold);
    color: var(--primary);
    line-height: 1.1;
}

.action-guide-next-date {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-dim);
    margin-top: var(--spacing-xs);
}

.action-guide-hero-sub {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
}

.action-guide-section {
    margin-bottom: var(--spacing-5);
}

.action-guide-section-title {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-3);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--glass-border);
}

.action-guide-recommendations,
.action-guide-performance {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

/* Action Guide – AI Medication Card */
.action-guide-med-ai-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large);
    padding: var(--spacing-md);
}

.action-guide-med-ai-inner {
    display: flex;
    align-items: center;
    gap: var(--spacing-md);
    flex-wrap: wrap;
}

.action-guide-med-ai-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--primary-alpha-12, rgba(208,188,255,0.12));
    color: var(--primary);
    flex-shrink: 0;
}

.action-guide-med-ai-icon .material-symbols-outlined,
.action-guide-med-ai-icon .svg-icon {
    font-size: 24px;
}

.action-guide-med-ai-body {
    flex: 1;
    min-width: 140px;
}

.action-guide-med-ai-title {
    font-size: var(--md-sys-typescale-title-small-size, 14px);
    font-weight: 600;
    color: var(--text-primary);
    margin-bottom: 2px;
}

.action-guide-med-ai-desc {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim);
    line-height: 1.4;
}

.action-guide-med-ai-btn {
    flex-shrink: 0;
    white-space: nowrap;
}

/* Action Guide Category */
.action-guide-category {
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-large);
    padding: var(--spacing-md);
    margin-bottom: var(--spacing-3);
    border: 1px solid var(--glass-border);
}

.action-guide-category:last-child { margin-bottom: 0; }

.action-guide-category-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-3);
    padding-bottom: var(--spacing-sm);
    border-bottom: 1px solid var(--glass-border);
}

.action-guide-category-title .category-icon {
    font-size: 20px;
}

/* Action Guide Items */
.action-guide-item {
    padding: var(--spacing-2-5) var(--spacing-3);
    border-radius: var(--md-sys-shape-corner-medium);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.04);
    margin-bottom: var(--spacing-sm);
    border-left: 3px solid var(--primary);
}

.action-guide-item:last-child { margin-bottom: 0; }

.action-guide-item-title {
    font-size: var(--md-sys-typescale-body-medium-size);
    font-weight: var(--md-sys-typescale-title-small-weight);
    color: var(--text-main);
    margin-bottom: var(--spacing-xs);
}

.action-guide-item-reason {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
    margin-bottom: var(--spacing-xxs);
}

.action-guide-item-detail {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    line-height: 1.4;
}

.action-guide-feedback {
    text-align: center;
    padding: var(--spacing-lg) var(--spacing-md);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-medium-size);
}

/* ==================== */
/* Date Conflict Dialog */
/* ==================== */
.date-conflict-dialog {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: var(--z-index-modal);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-lg);
}

.dialog-surface {
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large);
    padding: var(--spacing-lg);
    max-width: 400px;
    width: 100%;
    box-shadow: var(--md-sys-elevation-3);
}

.dialog-title {
    font-size: var(--md-sys-typescale-headline-small-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    color: var(--text-main);
    margin-bottom: var(--spacing-md);
}

.dialog-content {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-dim);
    margin-bottom: var(--spacing-lg);
    line-height: 1.5;
}

.dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
}

/* btn-cancel / btn-overwrite unified → btn-text / btn-filled */

/* ==================== */
/* MD3 Dialog (generic) */
/* ==================== */
.md3-dialog-scrim {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: var(--z-index-modal);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-lg);
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.md3-dialog-scrim.open {
    opacity: 1;
    pointer-events: auto;
}

.md3-dialog {
    background: var(--md-sys-color-surface-container-high, var(--modal-bg));
    border-radius: var(--md-sys-shape-corner-extra-large);
    padding: var(--spacing-lg);
    max-width: 560px;
    min-width: 280px;
    width: calc(100% - var(--spacing-xl));
    box-shadow: var(--md-sys-elevation-3);
    transform: scale(0.9);
    opacity: 0;
    transition: transform var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized-decelerate),
                opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.md3-dialog-scrim.open .md3-dialog {
    transform: scale(1);
    opacity: 1;
}

.md3-dialog-icon {
    display: flex;
    justify-content: center;
    margin-bottom: var(--spacing-md);
    color: var(--md-sys-color-secondary, var(--primary));
}

.md3-dialog-icon .material-symbols-outlined,
.md3-dialog-icon .svg-icon {
    font-size: var(--md-sys-typescale-headline-small-size);
}

.md3-dialog-headline {
    font-size: var(--md-sys-typescale-headline-small-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    color: var(--md-sys-color-on-surface, var(--text-main));
    margin-bottom: var(--spacing-md);
    text-align: center;
}

.md3-dialog-body {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--md-sys-color-on-surface-variant, var(--text-dim));
    line-height: 1.5;
    margin-bottom: var(--spacing-lg);
    max-height: 60vh;
    overflow-y: auto;
}

.md3-dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
}

/* ==================== */
/* Popup (Save Notification) */
/* ==================== */
.popup {
    position: fixed;
    bottom: 100px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--md-sys-color-inverse-surface, #2F3036);
    color: var(--md-sys-color-inverse-on-surface, #F2F0F4);
    padding: var(--spacing-3) var(--spacing-lg);
    border-radius: var(--md-sys-shape-corner-small);
    font-size: var(--md-sys-typescale-body-medium-size);
    z-index: var(--z-index-tooltip);
    opacity: 0;
    pointer-events: none;
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
    box-shadow: var(--md-sys-elevation-3);
    text-align: center;
    max-width: calc(100vw - 32px);
}

.popup.show {
    opacity: 1;
    transform: translateX(-50%) translateY(0);
    pointer-events: auto;
}

/* ==================== */
/* Material Symbols Inline Helpers */
/* ==================== */
.material-symbols-outlined.mi-inline,
.svg-icon.mi-inline {
    vertical-align: middle;
    font-size: 20px;
    line-height: 1;
}

.material-symbols-outlined.mi-sm,
.svg-icon.mi-sm {
    font-size: 18px;
}

.material-symbols-outlined.mi-error,
.svg-icon.mi-error {
    color: var(--danger);
}

.material-symbols-outlined.mi-warning,
.svg-icon.mi-warning {
    color: var(--md-sys-color-warning, #ffb74d);
}

.material-symbols-outlined.mi-on-surface,
.svg-icon.mi-on-surface {
    color: var(--text-secondary);
}

.material-symbols-outlined.mi-primary,
.svg-icon.mi-primary {
    color: var(--primary);
}

/* ==================== */
/* SVG Icon Inline Helpers (replacing font icons) */
/* ==================== */
.svg-icon {
    display: inline-block;
    vertical-align: middle;
    flex-shrink: 0;
    line-height: 1;
}

.svg-icon.mi-inline {
    width: 20px;
    height: 20px;
}

.svg-icon.mi-sm {
    width: 18px;
    height: 18px;
}

.svg-icon.mi-md {
    width: 24px;
    height: 24px;
}

.svg-icon.mi-xl {
    width: 32px;
    height: 32px;
}

.svg-icon.mi-2xl {
    width: 40px;
    height: 40px;
}

.svg-icon.mi-error {
    color: var(--danger);
}

.svg-icon.mi-warning {
    color: var(--md-sys-color-warning, #ffb74d);
}

.svg-icon.mi-on-surface {
    color: var(--text-secondary);
}

.svg-icon.mi-primary {
    color: var(--primary);
}

.svg-icon.mi-success {
    color: var(--md-sys-color-success, #4caf50);
}

.svg-icon.mi-filled {
    fill: currentColor;
}

/* ==================== */
/* Tables (Data) */
/* ==================== */
table {
    width: 100%;
    border-collapse: collapse;
    font-size: var(--md-sys-typescale-body-medium-size);
}

thead th {
    background: var(--table-header-bg);
    color: var(--text-main);
    font-weight: var(--md-sys-typescale-label-large-weight);
    padding: var(--spacing-3) var(--spacing-md);
    text-align: left;
    white-space: nowrap;
    border-bottom: 1px solid var(--table-border);
    position: sticky;
    top: 0;
    z-index: 1;
}

tbody td {
    padding: var(--spacing-2-5) var(--spacing-md);
    border-bottom: 1px solid var(--table-border);
    color: var(--text-main);
}

tbody tr:nth-child(even) {
    background: var(--table-row-stripe-bg);
}

tbody tr:hover {
    background: var(--table-row-hover-bg);
}

/* ==================== */
/* Divider */
/* ==================== */
.divider {
    border: none;
    border-top: 1px solid var(--glass-border);
    margin: var(--spacing-md) 0;
}

/* ==================== */
/* Target Achievement List */
/* ==================== */
.target-achievement-list {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

/* Target Achievement Item */
.target-achievement-item {
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    padding: 14px var(--spacing-md);
    border: 1px solid var(--glass-border);
}

.metric-name-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-2-5);
}

.metric-name {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
}

.status-message {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--primary);
    text-align: right;
    max-width: 55%;
}

/* Progress Bar Wrapper (Target Achievement) */
.progress-bar-wrapper {
    position: relative;
    width: 100%;
    overflow: visible;
}

.leader-lines-svg {
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1;
}

.labels-container {
    position: absolute;
    inset: 0;
    z-index: 3;
}

.progress-bar-label {
    position: absolute;
    display: flex;
    flex-direction: column;
    align-items: center;
    transform: translateX(-50%);
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    white-space: nowrap;
    z-index: 3;
}

.progress-bar-label .label {
    font-size: 10px;
    color: var(--text-dim2);
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.progress-bar-label .value {
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-dim);
}

.progress-bar-label.current .value {
    color: var(--primary);
    font-weight: var(--font-weight-bold);
}

.progress-bar-label.top-label {
    flex-direction: column;
}

.progress-bar-label.bottom-label {
    flex-direction: column;
}

/* Progress Bar Track (Target Achievement) */
.progress-bar-track-container {
    position: absolute;
    left: 0;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    height: 8px;
    z-index: 2;
}

.progress-bar-track {
    width: 100%;
    height: 100%;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
}

.progress-bar-range {
    position: absolute;
    top: 0;
    height: 100%;
    border-radius: var(--md-sys-shape-corner-full);
    opacity: 0.5;
}

.progress-bar-range.range-initial {
    background: var(--text-dim2);
    opacity: 0.25;
}

.progress-bar-range.range-prev {
    background: var(--info, #64b5f6);
    opacity: 0.35;
}

.progress-bar-range.range-target {
    background: var(--primary);
    opacity: 0.3;
}

.progress-bar-marker {
    position: absolute;
    top: 50%;
    width: 14px;
    height: 14px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--primary);
    border: 2px solid var(--modal-bg);
    transform: translate(-50%, -50%);
    z-index: 3;
    box-shadow: 0 0 0 2px var(--primary);
}

.progress-bar-placeholder {
    text-align: center;
    color: var(--text-dim2);
    font-size: var(--md-sys-typescale-body-small-size);
    padding: var(--spacing-sm);
}

/* ==================== */
/* Body Ratio Items */
/* ==================== */
/* Body Ratio */
.body-ratio-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

.body-ratio-item {
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    padding: 14px var(--spacing-md);
    border: 1px solid var(--glass-border);
}

.body-ratio-item-fullwidth {
    width: 100%;
}

.ratio-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-2-5);
}

.ratio-name {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
}

.ratio-value-display {
    text-align: right;
}

.ratio-number {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--font-weight-bold);
    color: var(--primary);
}

.ratio-bar-container {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.ratio-icon-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-xxs);
    flex-shrink: 0;
    min-width: 32px;
}

.ratio-icon {
    display: flex;
    align-items: center;
    justify-content: center;
}

.ratio-icon.male { color: var(--info, #64b5f6); }
.ratio-icon.female { color: var(--warning, #ffb74d); }

.ratio-percentile {
    font-size: 10px;
    color: var(--text-dim2);
    white-space: nowrap;
}

.ratio-bar {
    flex: 1;
    height: 10px;
    background: linear-gradient(to right, var(--info, #64b5f6), var(--warning, #ffb74d));
    border-radius: var(--md-sys-shape-corner-full);
    position: relative;
    overflow: visible;
}

.ratio-bar-fill {
    display: none; /* The gradient handles the visual */
}

.ratio-bar-marker {
    position: absolute;
    top: 50%;
    width: 14px;
    height: 14px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--text-main);
    border: 2px solid var(--modal-bg);
    transform: translate(-50%, -50%);
    z-index: 2;
    box-shadow: 0 0 0 2px var(--text-main);
}

.ratio-evaluation {
    margin-top: var(--spacing-sm);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    text-align: center;
}

/* Predictions */
.predictions-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

/* Prediction Item */
.prediction-item {
    display: flex;
    gap: var(--spacing-3);
    padding: 14px var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    cursor: pointer;
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.prediction-item:hover,
.prediction-item:focus {
    border-color: var(--primary);
    outline: none;
}

.prediction-main-col {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.prediction-metric-name {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
}

.prediction-values-container {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
}

.prediction-value-item {
    display: flex;
    gap: var(--spacing-xs);
    font-size: var(--md-sys-typescale-body-small-size);
}

.prediction-value-item.predicted {
    font-style: italic;
}

.prediction-label {
    color: var(--text-dim2);
}

.prediction-value-text {
    color: var(--text-dim);
}

.prediction-value-text.highlight {
    color: var(--primary);
    font-weight: var(--md-sys-typescale-label-large-weight);
}

/* Prediction Progress */
.prediction-progress-container {
    margin-top: var(--spacing-xs);
}

.prediction-progress-bar {
    position: relative;
    height: 8px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: hidden;
}

.prediction-progress-fill {
    position: absolute;
    height: 100%;
    background: var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    transition: width var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
}

.prediction-progress-text {
    position: absolute;
    right: 0;
    top: calc(-1 * var(--spacing-5));
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
}

.prediction-progress-placeholder {
    height: 4px;
}

/* Prediction Divider */
.prediction-divider {
    width: 1px;
    background: var(--glass-border);
    align-self: stretch;
    flex-shrink: 0;
}

/* Prediction Stats */
.prediction-stats-col {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-1-5);
    min-width: 90px;
    justify-content: center;
}

.prediction-stat-item {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxs);
}

.prediction-stat-label {
    font-size: 10px;
    color: var(--text-dim2);
    text-transform: uppercase;
    letter-spacing: 0.3px;
}

.prediction-stat-value {
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-dim);
}

.prediction-stat-value.positive { color: var(--success, #81c784); }
.prediction-stat-value.negative { color: var(--md-sys-color-error, #f2b8b5); }

.prediction-stat-divider {
    height: 1px;
    background: var(--glass-border);
}

/* Mobile: stack prediction items vertically */
@media (max-width: 400px) {
    .prediction-item {
        flex-direction: column;
    }
    .prediction-divider {
        width: 100%;
        height: 1px;
    }
}

/* ==================== */
/* Chart Container & Zoom Controls */
/* ==================== */
.chart-wrapper-container {
    position: relative;
}

.chart-inner-container {
    position: relative;
    min-height: 200px;
}

.chart-zoom-controls {
    position: absolute;
    top: var(--spacing-sm);
    right: var(--spacing-sm);
    display: flex;
    gap: var(--spacing-xs);
    z-index: 5;
}

.chart-zoom-btn {
    width: var(--spacing-xl);
    height: var(--spacing-xl);
    border-radius: var(--md-sys-shape-corner-full, 50%);
    border: 1px solid var(--glass-border);
    background: var(--glass-bg);
    color: var(--text-primary);
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s, opacity 0.15s;
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
}

.chart-zoom-btn:hover { background: var(--md-sys-color-surface-container-high, var(--glass-hover)); }
.chart-zoom-btn:disabled { opacity: 0.35; cursor: default; }

/* ==================== */
/* Chart Legend (Body Briefing Detail) */
/* ==================== */
.briefing-legend-toolbar {
    display: none;
}

.briefing-legend-grid {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

.legend-group-card {
    background: transparent;
    border-radius: 0;
    padding: 0;
    border: none;
}

.legend-group-title {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 600;
    color: var(--text-dim);
    margin: 0 0 var(--spacing-xs) 0;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.legend-list {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    max-height: none;
    overflow-y: visible;
}

.legend-group-toolbar {
    display: none;
}

.legend-group-toggle {
    font-size: 0.72rem;
}

.legend-button {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    padding: 4px 10px;
    border-radius: var(--md-sys-shape-corner-full, 20px);
    border: 1.5px solid var(--glass-border);
    background: var(--glass-bg);
    color: var(--text-primary);
    cursor: pointer;
    transition: background 0.15s, color 0.15s, opacity 0.15s;
    white-space: nowrap;
    line-height: 1.3;
}

.legend-button:hover { filter: brightness(1.1); }
.legend-button.inactive { opacity: 0.5; background: transparent; }

/* ==================== */
/* Selected Week Data Items */
/* ==================== */
.data-item {
    display: flex;
    justify-content: space-between;
    align-items: baseline;
    padding: var(--spacing-1-5) 0;
    border-bottom: 1px solid var(--glass-border);
    gap: var(--spacing-3);
}

.data-item:last-child { border-bottom: none; }

.data-item-label {
    font-size: 0.82rem;
    color: var(--text-secondary);
    flex-shrink: 0;
}

.data-item-value {
    font-size: 0.85rem;
    font-weight: 500;
    color: var(--text-primary);
    text-align: right;
    white-space: pre-line;
    word-break: break-word;
}

/* Alerts */
.alerts-container {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
}

/* ==================== */
/* Alert Items (Body Briefing) */
/* ==================== */
.alert-item {
    display: flex;
    gap: var(--spacing-3);
    padding: var(--spacing-3) var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border-left: 4px solid var(--md-sys-color-outline-variant, var(--glass-border));
}

.alert-item.critical {
    border-left-color: var(--md-sys-color-error, #f2b8b5);
    background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.08);
}

.alert-item.warning {
    border-left-color: var(--warning, #ffb74d);
    background: rgba(255, 183, 77, 0.08);
}

.alert-item.info {
    border-left-color: var(--info, #64b5f6);
    background: rgba(100, 181, 246, 0.08);
}

.alert-icon {
    flex-shrink: 0;
    display: flex;
    align-items: flex-start;
    padding-top: var(--spacing-xxs);
}

.alert-content {
    flex: 1;
    min-width: 0;
}

.alert-title {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-small-weight);
    color: var(--text-main);
    margin-bottom: var(--spacing-xs);
}

.alert-description {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
}

.alert-action {
    font-size: var(--md-sys-typescale-label-medium-size);
    color: var(--primary);
}

/* ==================== */
/* Safety Assessment Section (SafetyEngine) */
/* ==================== */

/* 도메인 점수 그리드 */
.safety-scores-inner {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: var(--spacing-md);
}

.safety-score-row {
    display: flex;
    align-items: center;
    gap: 10px;
}

.safety-score-label {
    font-size: 12px;
    color: var(--text-secondary);
    min-width: 90px;
    flex-shrink: 0;
}

.safety-score-track {
    flex: 1;
    height: 8px;
    background: var(--glass-border);
    border-radius: 4px;
    overflow: hidden;
}

.safety-score-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.4s var(--md-sys-motion-easing-standard);
}

.safety-bar-critical { background: var(--md-sys-color-error, #BA1A1A); }
.safety-bar-warning  { background: #F5A623; }
.safety-bar-info     { background: var(--primary); opacity: 0.7; }

.safety-score-number {
    font-size: 12px;
    font-weight: 600;
    min-width: 28px;
    text-align: right;
    color: var(--text-secondary);
}

/* 안전 알림 아이템 */
.safety-alert-item {
    position: relative;
}

/* 안전 태그 */
.safety-tags-row {
    margin-top: 6px;
}

.safety-tag {
    display: inline-block;
    padding: 2px 6px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 500;
}

.safety-tag-med {
    background: color-mix(in srgb, var(--primary, #938FFF) 18%, transparent);
    color: var(--primary, #938FFF);
    border: 1px solid color-mix(in srgb, var(--primary, #938FFF) 35%, transparent);
}

.safety-tag-sym {
    background: color-mix(in srgb, #F5A623 18%, transparent);
    color: #B47A12;
    border: 1px solid color-mix(in srgb, #F5A623 40%, transparent);
}

.dark-mode .safety-tag-sym { color: #F5C870; }

/* 권장 검사 목록 */
.safety-tests-list,
.safety-education-list {
    margin-top: 4px;
}

.safety-test-item {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    padding: 10px 14px;
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border-left: 3px solid var(--glass-border);
    margin-bottom: 6px;
}

.safety-test-critical { border-left-color: var(--md-sys-color-error, #BA1A1A); }
.safety-test-warning  { border-left-color: #F5A623; }
.safety-test-info     { border-left-color: var(--primary); }

.safety-test-priority { flex-shrink: 0; padding-top: 1px; }

.safety-test-name {
    font-size: 13px;
    font-weight: 600;
    color: var(--text-main);
    margin-bottom: 2px;
}

.safety-test-reason {
    font-size: 12px;
    color: var(--text-dim);
    line-height: 1.4;
}

.safety-test-urgency {
    font-size: 12px;
    color: var(--md-sys-color-error, #CF6679);
    margin-top: 3px;
    font-weight: 500;
}

/* 교육 포인트 */
.safety-edu-item {
    display: flex;
    align-items: flex-start;
    gap: 8px;
    padding: 8px 0;
    border-bottom: 1px solid var(--glass-border);
    font-size: 12px;
    color: var(--text-secondary);
    line-height: 1.5;
}

.safety-edu-item:last-child { border-bottom: none; }

.safety-edu-text { flex: 1; }

.safety-subsection-title {
    display: flex;
    align-items: center;
    gap: 6px;
    margin: 16px 0 8px;
    font-size: 13px;
    font-weight: 600;
    color: var(--text-secondary);
    letter-spacing: 0.02em;
}

/* 면책조항  */
.safety-disclaimer {
    margin-top: 12px;
    padding: 10px 12px;
    background: color-mix(in srgb, var(--glass-bg) 60%, transparent);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    font-size: 11px;
    color: var(--text-dim);
    line-height: 1.5;
    font-style: italic;
}

/* ==================== */
/* Roadmap Timeline Items */
/* ==================== */
.timeline-item {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-3);
    padding: var(--spacing-3) var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border-left: 4px solid var(--glass-border);
    margin-bottom: var(--spacing-sm);
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.timeline-item:last-child { margin-bottom: 0; }

.timeline-item.start { border-left-color: var(--md-sys-color-outline, var(--text-dim2)); }
.timeline-item.current { border-left-color: var(--primary); background: rgba(var(--primary-rgb, 147, 143, 255), 0.08); }
.timeline-item.prediction { border-left-color: var(--info, #64b5f6); }
.timeline-item.warning { border-left-color: var(--warning, #ffb74d); background: rgba(255, 183, 77, 0.06); }
.timeline-item.normal { border-left-color: var(--glass-border); }

.timeline-week {
    flex: 1;
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
    white-space: nowrap;
}

.timeline-date {
    flex-shrink: 0;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    min-width: 70px;
    text-align: right;
}

.timeline-content {
    width: 100%;
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
    margin-top: var(--spacing-xs);
}

/* Make timeline-item a column layout since we have 3 children */
.timeline-item {
    flex-direction: column;
    gap: var(--spacing-xs);
}

.timeline-item .timeline-week,
.timeline-item .timeline-date {
    text-align: left;
}

/* Weekly Ticks */
.weekly-tick {
    position: absolute;
    top: 0;
    width: 3px;
    height: 100%;
    border-radius: 2px;
    opacity: 0.6;
}

.weekly-tick.positive { background: var(--success, #81c784); }
.weekly-tick.negative { background: var(--md-sys-color-error, #f2b8b5); }
.weekly-tick.neutral { background: var(--text-dim2); }

/* Roadmap Progress Segments */
.roadmap-progress-segment {
    position: absolute;
    top: 0;
    height: 100%;
    border-radius: 2px;
}

.roadmap-progress-segment.positive { background: var(--success, #81c784); }
.roadmap-progress-segment.negative { background: var(--md-sys-color-error, #f2b8b5); }
.roadmap-progress-segment.break { background: transparent; }

/* ==================== */
/* Monthly Summary Items */
/* ==================== */
.monthly-summary-item {
    display: flex;
    align-items: baseline;
    gap: var(--spacing-3);
    padding: var(--spacing-2-5) 14px;
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    margin-bottom: var(--spacing-sm);
}

.monthly-summary-item:last-child { margin-bottom: 0; }

.month-name {
    flex-shrink: 0;
    min-width: 70px;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--primary);
}

.top-changes {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-1-5);
    flex: 1;
}

/* Change items as chips in roadmap context */
.top-changes .change-item,
.roadmap-standout-list .change-item {
    display: inline-flex;
    align-items: center;
    padding: var(--spacing-xs) var(--spacing-2-5);
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--md-sys-color-secondary-container, rgba(var(--primary-rgb, 147, 143, 255), 0.12));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    white-space: nowrap;
    gap: var(--spacing-xxs);
}

/* ==================== */
/* Quest Modal */
/* ==================== */
.quest-modal-overlay {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: var(--z-index-modal);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding: var(--spacing-md) var(--spacing-md) 0;
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.quest-modal-overlay.visible {
    opacity: 1;
    pointer-events: auto;
}

.quest-modal-surface {
    width: 100%;
    max-height: calc(100vh - 15px);
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transform: translateY(100%);
    transition: transform var(--md-sys-motion-duration-medium4) var(--md-sys-motion-easing-emphasized);
}

.quest-modal-overlay.visible .quest-modal-surface {
    transform: translateY(0);
}

.quest-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-5) var(--spacing-lg) var(--spacing-3);
    border-bottom: 1px solid var(--glass-border);
}

.quest-modal-header h2 {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    color: var(--text-main);
    margin: 0;
}

.quest-modal-close {
    width: 40px;
    height: 40px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-headline-small-size);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-modal-close:hover { background: var(--glass-bg-light); }

/* Quest Toolbar */
.quest-modal-toolbar {
    padding: var(--spacing-3) var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-2-5);
}

.quest-category-tabs {
    display: flex;
    gap: var(--spacing-1-5);
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
    padding-bottom: var(--spacing-xs);
}

.quest-category-tabs::-webkit-scrollbar { display: none; }

.quest-cat-tab {
    flex-shrink: 0;
    padding: var(--spacing-1-5) 14px;
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    cursor: pointer;
    white-space: nowrap;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-cat-tab:hover { background: var(--glass-bg); }

.quest-cat-tab.active {
    background: var(--primary);
    color: var(--on-primary);
    border-color: var(--primary);
}

.quest-sort-bar {
    display: flex;
    justify-content: flex-end;
}

.quest-sort-select {
    padding: var(--spacing-1-5) var(--spacing-3);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-medium-size);
    cursor: pointer;
}

/* Quest List */
.quest-list-container {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-3) var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

/* Quest Card */
.quest-card {
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large);
    padding: var(--spacing-md);
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-card:hover {
    border-color: var(--primary);
}

.quest-card.quest-completed {
    opacity: 0.7;
    border-color: var(--success, #81c784);
}

.quest-card.quest-pinned {
    border-left: 3px solid var(--primary);
}

.quest-card-top {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: var(--spacing-sm);
}

.quest-card-badges {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
}

.quest-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xxs);
    padding: var(--spacing-xxs) var(--spacing-sm);
    border-radius: var(--md-sys-shape-corner-full);
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    background: var(--md-sys-color-secondary-container, rgba(var(--primary-rgb, 147, 143, 255), 0.12));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
}

.quest-badge.pin { background: rgba(var(--primary-rgb, 147, 143, 255), 0.15); }
.quest-badge.fav .mi-filled { color: var(--warning, #ffb74d); }
.quest-badge.done .mi-success { color: var(--success, #81c784); }
.quest-badge.linked { background: rgba(100, 181, 246, 0.12); color: var(--info, #64b5f6); }
.quest-badge.dday { background: rgba(var(--md-sys-color-tertiary-rgb, 239, 184, 200), 0.12); color: var(--tertiary, #efb8c8); }
.quest-badge.progress { background: rgba(129, 199, 132, 0.12); color: var(--success, #81c784); }

/* Quest create/edit — 2-column selector grid (category + tracking type) */
.quest-selector-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-xs);
}

.quest-selector-btn {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-md);
    border: 1.5px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    color: var(--text-dim);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard),
                border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard),
                color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    text-align: left;
    white-space: nowrap;
    overflow: hidden;
}

.quest-selector-btn .material-symbols-outlined,
.quest-selector-btn .svg-icon {
    font-size: 18px;
    flex-shrink: 0;
    opacity: 0.7;
}

.quest-selector-label {
    overflow: hidden;
    text-overflow: ellipsis;
}

.quest-selector-btn:hover {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.08);
    border-color: rgba(var(--primary-rgb, 147, 143, 255), 0.4);
    color: var(--text-main);
}

.quest-selector-btn.active {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.14);
    border-color: var(--primary);
    color: var(--primary);
    font-weight: var(--md-sys-typescale-label-large-weight);
}

.quest-selector-btn.active .material-symbols-outlined,
.quest-selector-btn.active .svg-icon {
    opacity: 1;
}

/* legacy chips row (kept for backwards compat) */
.quest-tracking-chips {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-xs);
}

/* Each section shown/hidden based on selected type */
.quest-tracking-section {
    margin-top: var(--spacing-sm);
}

/* Info hint for 'progress' type */
.quest-tracking-hint {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xs);
    padding: var(--spacing-3);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-body-small-size);
    line-height: 1.5;
    margin: 0;
}

/* Inline D-Day chip (quest card + dialog preview) */
.quest-dday-chip {
    display: inline-flex;
    align-items: center;
    padding: var(--spacing-xxs) var(--spacing-sm);
    border-radius: var(--md-sys-shape-corner-full);
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: 700;
    letter-spacing: 0.02em;
}
.quest-dday-chip.remaining { background: rgba(var(--primary-rgb, 147, 143, 255), 0.14); color: var(--primary); }
.quest-dday-chip.today     { background: rgba(var(--md-sys-color-tertiary-rgb, 239, 184, 200), 0.18); color: var(--tertiary, #efb8c8); }
.quest-dday-chip.overdue   { background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.14); color: var(--md-sys-color-error, #f2b8b5); }

/* D-Day row in quest card body */
.quest-dday-main {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-sm);
}

/* D-Day preview in create dialog */
.quest-dday-preview {
    margin-top: var(--spacing-sm);
    min-height: 28px;
}

/* Quest Card Menu */
.quest-card-menu {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    position: relative;
    flex-shrink: 0;
}

.quest-card-menu-btn {
    width: 32px;
    height: 32px;
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-size: 18px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-card-menu-btn:hover { background: var(--glass-bg-light); }

.quest-card-menu-dropdown {
    position: absolute;
    top: 100%;
    right: 0;
    min-width: 180px;
    background: var(--modal-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    box-shadow: var(--shadow-medium);
    z-index: 10;
    display: none;
    flex-direction: column;
    overflow: hidden;
}

.quest-card-menu-dropdown.visible {
    display: flex;
}

.quest-card-menu-dropdown button {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) var(--spacing-md);
    border: none;
    background: transparent;
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-medium-size);
    cursor: pointer;
    text-align: left;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-card-menu-dropdown button:hover { background: var(--glass-bg); }

.quest-card-menu-dropdown button.quest-menu-danger {
    color: var(--md-sys-color-error, #f2b8b5);
}

/* Quest Card Content */
.quest-card-title {
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
    margin: 0 0 var(--spacing-xs);
}

.quest-card-desc {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    margin: 0 0 var(--spacing-3);
    line-height: 1.5;
}

/* Quest Progress */
.quest-progress-section {
    margin-top: var(--spacing-sm);
}

.quest-progress-labels {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    margin-bottom: var(--spacing-1-5);
}

.quest-progress-pct {
    text-align: right;
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--primary);
}

.quest-value-input {
    width: 72px;
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-small-size);
    text-align: center;
}

.quest-target-date {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
}

/* ── Quest: Elapsed / D+N badge ── */
.quest-elapsed-info {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-xs);
}

.quest-elapsed-badge {
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: 700;
    color: var(--primary);
    letter-spacing: 0.02em;
}

.quest-elapsed-date {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
}

/* ── Quest: Record (+) button ── */
.quest-record-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    border: none;
    border-radius: 50%;
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.12);
    color: var(--primary);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard),
                transform var(--md-sys-motion-duration-short2) var(--md-sys-motion-easing-standard);
    flex-shrink: 0;
}

.quest-record-btn:hover {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.22);
    transform: scale(1.1);
}

.quest-record-btn .material-symbols-outlined,
.quest-record-btn .svg-icon {
    font-size: 22px;
}

/* ── Quest: Record panel ── */
.quest-record-panel {
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    margin-top: var(--spacing-sm);
    background: var(--glass-bg-light, rgba(255,255,255,0.04));
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    animation: fadeIn var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-record-date {
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-small-size);
}

.quest-record-slider {
    flex: 1 1 120px;
    min-width: 80px;
    accent-color: var(--primary);
    cursor: pointer;
}

.quest-record-slider-label {
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: 600;
    color: var(--primary);
    min-width: 36px;
    text-align: center;
}

.quest-record-value-input {
    width: 80px;
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-small-size);
    text-align: center;
}

.quest-record-save {
    padding: var(--spacing-xs) var(--spacing-md);
    border: 1px solid var(--primary);
    border-radius: var(--md-sys-shape-corner-full);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.12);
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3);
}

.quest-record-save:hover {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.22);
}

/* ── Quest: Record slider wrap + 양끝 라벨 ── */
.quest-record-slider-wrap {
    flex: 1 1 140px;
    display: flex;
    flex-direction: column;
    gap: 2px;
    min-width: 100px;
}

.quest-record-slider-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.quest-record-slider-row .quest-record-slider {
    flex: 1;
    min-width: 80px;
}

.quest-record-slider-ends {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    padding: 0 2px;
}

/* ── Quest: D-Day card side ── */
.quest-card-side--dday {
    flex: 0 0 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) 0 var(--spacing-xs) var(--spacing-sm);
    border-left: 1px solid var(--glass-border);
}

.quest-side-dday-display {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px;
    text-align: center;
}

.quest-side-dday-badge {
    font-size: 1.15rem;
    font-weight: 700;
    letter-spacing: 0.03em;
}

.quest-side-dday-display.remaining .quest-side-dday-badge { color: var(--primary); }
.quest-side-dday-display.today    .quest-side-dday-badge { color: var(--success, #4CAF50); }
.quest-side-dday-display.overdue  .quest-side-dday-badge { color: var(--error); }

/* ── Quest: Alarm section in create dialog ── */
.quest-alarm-section {
    border-top: 1px solid var(--glass-border);
    padding-top: var(--spacing-md);
    margin-top: var(--spacing-sm);
}

.quest-alarm-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-main);
}

.quest-alarm-toggle-wrap {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-left: auto;
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: 400;
    color: var(--text-dim);
    cursor: pointer;
}

.quest-alarm-toggle-wrap input[type="checkbox"] {
    accent-color: var(--primary);
    width: 16px;
    height: 16px;
    cursor: pointer;
}

.quest-alarm-days {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-xs);
}

.quest-alarm-day-btn {
    padding: var(--spacing-xs) var(--spacing-sm);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-alarm-day-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
}

.quest-alarm-day-btn.active {
    border-color: var(--primary);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.15);
    color: var(--primary);
    font-weight: 600;
}

/* ── Quest: Progress bar — enhanced visibility ── */
.quest-progress-bar {
    height: 10px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: hidden;
    margin-bottom: var(--spacing-xs);
    position: relative;
}

.quest-progress-fill {
    position: absolute;
    top: 0;
    left: 0;
    height: 100%;
    background: var(--primary, #938fff);
    border-radius: var(--md-sys-shape-corner-full);
    transition: width 0.45s cubic-bezier(0.4, 0, 0.2, 1);
    min-width: 0;
}

/* Initial progress slider in dialog */
#qt-progress-init {
    width: 100%;
    margin-top: var(--spacing-xs);
    accent-color: var(--primary);
    cursor: pointer;
}

/* ── Quest: Card body 2-col layout ── */
.quest-card-body {
    display: flex;
    gap: var(--spacing-sm);
    align-items: flex-start;
}

.quest-card-main {
    flex: 1 1 0;
    min-width: 0;
    overflow: hidden;
}

.quest-card-side {
    flex: 0 0 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-xs) 0 var(--spacing-xs) var(--spacing-sm);
    border-left: 1px solid var(--glass-border);
}

/* Quest card mobile — tighter layout */
@media (max-width: 400px) {
    .quest-card {
        padding: var(--spacing-sm);
    }
    .quest-card-side {
        flex: 0 0 72px;
        padding-left: var(--spacing-xs);
    }
    .quest-card-side .quest-record-btn {
        width: 36px;
        height: 36px;
    }
    .quest-card-side .quest-record-btn .material-symbols-outlined,
        .quest-card-side .quest-record-btn .svg-icon {
        font-size: 26px;
    }
    .quest-card-title {
        font-size: var(--md-sys-typescale-body-medium-size);
    }
    .quest-card-badges {
        gap: 4px;
    }
    .quest-badge {
        padding: 2px 6px;
        font-size: 0.65rem;
    }
    .quest-elapsed-badge {
        font-size: 0.75rem;
    }
    .quest-progress-labels {
        font-size: 0.65rem;
    }
    .quest-progress-labels strong {
        font-size: 0.7rem;
    }
}

.quest-card-side .quest-record-btn {
    width: 44px;
    height: 44px;
}

.quest-card-side .quest-record-btn .material-symbols-outlined,
.quest-card-side .quest-record-btn .svg-icon {
    font-size: 32px;
}

/* ---- Linked quest: chain icon + label ---- */
.quest-card-side--linked {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    padding: 12px;
    color: var(--text-dim);
}

.quest-linked-icon {
    font-size: 28px;
    color: var(--primary);
    opacity: 0.8;
}

.quest-card-side--linked .quest-side-label {
    font-size: 0.65rem;
    opacity: 0.7;
    white-space: nowrap;
}

.quest-side-last {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    text-align: center;
}

.quest-side-dday {
    font-size: 1.1rem;
    font-weight: 700;
    color: var(--primary);
    letter-spacing: 0.03em;
}

.quest-side-label {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    white-space: nowrap;
}

.quest-side-date {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim);
    font-weight: 500;
}

/* ── Quest: History list (detail panel) ── */
.quest-history-list-section {
    margin-top: var(--spacing-md);
}

.quest-history-list {
    max-height: 280px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
    scrollbar-width: thin;
    scrollbar-color: var(--glass-border) transparent;
}

.quest-history-item {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    transition: border-color var(--md-sys-motion-duration-short3);
}

.quest-history-item.editing {
    border-color: var(--primary);
}

.quest-history-date {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    white-space: nowrap;
    min-width: 72px;
}

.quest-history-info {
    flex: 1 1 0;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 2px;
    overflow: hidden;
}

.quest-history-item-title {
    font-size: var(--md-sys-typescale-body-small-size);
    font-weight: 500;
    color: var(--text-main);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.quest-history-item-desc {
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}

.quest-history-value-wrap {
    display: flex;
    align-items: center;
    flex-shrink: 0;
}

.quest-history-value-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 48px;
    height: 48px;
    padding: 0 var(--spacing-xs);
    border-radius: 50%;
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.15);
    border: 2px solid var(--primary);
    color: var(--primary);
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: 700;
    text-align: center;
}

.quest-history-edit-input {
    width: 60px;
    padding: var(--spacing-xs);
    border: 1px solid var(--primary);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-small-size);
    text-align: center;
}

.quest-history-edit-btn,
.quest-history-delete-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    border: none;
    border-radius: 50%;
    background: transparent;
    color: var(--text-dim2);
    cursor: pointer;
    flex-shrink: 0;
    transition: background var(--md-sys-motion-duration-short3), color var(--md-sys-motion-duration-short3);
}

.quest-history-edit-btn:hover {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.12);
    color: var(--primary);
}

.quest-history-delete-btn:hover {
    background: rgba(var(--error-rgb, 207, 102, 121), 0.12);
    color: var(--error, #cf6679);
}

/* Quest Empty State */
.quest-empty-state {
    text-align: center;
    padding: var(--spacing-2xl) var(--spacing-lg);
    color: var(--text-dim);
}

.quest-empty-icon {
    margin-bottom: var(--spacing-3);
    color: var(--text-dim2);
}

.quest-empty-state p {
    margin: 0 0 var(--spacing-sm);
    font-size: var(--md-sys-typescale-body-medium-size);
}

.quest-empty-hint {
    color: var(--text-dim2);
    font-size: var(--md-sys-typescale-body-small-size) !important;
}

/* Quest Add Button */
.quest-add-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-sm);
    margin: var(--spacing-3) var(--spacing-lg) var(--spacing-lg);
    padding: var(--spacing-3);
    border: 2px dashed var(--glass-border);
    border-radius: var(--md-sys-shape-corner-large);
    background: transparent;
    color: var(--primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-add-btn:hover {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.08);
    border-color: var(--primary);
}

/* Quest Detail Toggle Button */
.quest-detail-toggle {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-sm);
    padding: var(--spacing-xs) var(--spacing-sm);
    border: none;
    background: transparent;
    color: var(--text-dim2);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-small-size);
    cursor: pointer;
    transition: color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    width: 100%;
    justify-content: center;
}

.quest-detail-toggle:hover { color: var(--primary); }

.quest-detail-toggle .material-symbols-outlined,
.quest-detail-toggle .svg-icon {
    transition: transform var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.quest-detail-toggle.expanded .material-symbols-outlined,
.quest-detail-toggle.expanded .svg-icon {
    transform: rotate(180deg);
}

.quest-detail-toggle.expanded { color: var(--primary); }

/* Quest Detail Panel */
.quest-detail-panel {
    margin-top: var(--spacing-3);
    padding-top: var(--spacing-3);
    border-top: 1px solid var(--glass-border);
    animation: slideDownFade var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized-decelerate);
}

@keyframes slideDownFade {
    from { opacity: 0; transform: translateY(-8px); }
    to { opacity: 1; transform: translateY(0); }
}

/* D-Day Badge */
.quest-detail-dday {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-3);
    border-radius: var(--md-sys-shape-corner-full);
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    margin-bottom: var(--spacing-3);
}

.quest-detail-dday.remaining {
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.12);
    color: var(--primary);
}

.quest-detail-dday.today {
    background: rgba(var(--md-sys-color-tertiary-rgb, 239, 184, 200), 0.15);
    color: var(--tertiary);
}

.quest-detail-dday.overdue {
    background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.12);
    color: var(--md-sys-color-error, #f2b8b5);
}

.quest-dday-label {
    font-weight: 700;
    font-size: var(--md-sys-typescale-title-small-size);
}

.quest-dday-date {
    color: var(--text-dim);
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: normal;
}

/* Stats Row */
.quest-detail-stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-3);
}

.quest-stat-item {
    text-align: center;
    padding: var(--spacing-2-5) var(--spacing-xs);
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
}

.quest-stat-value {
    display: block;
    font-size: var(--md-sys-typescale-title-medium-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--primary);
    line-height: 1.2;
}

.quest-stat-label {
    display: block;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    margin-top: var(--spacing-xxs);
}

/* Milestone Bar */
.quest-detail-milestone {
    margin-bottom: var(--spacing-5);
}

.quest-milestone-labels {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-label-small-size);
    color: var(--text-dim2);
    margin-bottom: var(--spacing-1-5);
}

.quest-milestone-track {
    position: relative;
    height: 12px;
    background: var(--md-sys-color-surface-container-highest, #353438);
    border-radius: var(--md-sys-shape-corner-full);
    overflow: visible;
}

.quest-milestone-fill {
    height: 100%;
    background: linear-gradient(90deg, var(--primary), var(--tertiary));
    border-radius: var(--md-sys-shape-corner-full);
    transition: width var(--md-sys-motion-duration-long2) var(--md-sys-motion-easing-emphasized);
}

.quest-milestone-marker {
    position: absolute;
    top: calc(-1 * var(--spacing-xs));
    width: 20px;
    height: 20px;
    background: var(--primary);
    border: 2px solid var(--surface-base);
    border-radius: 50%;
    transform: translateX(-50%);
    z-index: 2;
}

.quest-milestone-tooltip {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: var(--primary);
    color: var(--on-primary);
    padding: var(--spacing-xxs) var(--spacing-sm);
    border-radius: var(--md-sys-shape-corner-small);
    font-size: 10px;
    font-weight: 600;
    white-space: nowrap;
    margin-bottom: var(--spacing-xs);
}

.quest-milestone-tooltip::after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 4px solid transparent;
    border-top-color: var(--primary);
}

.quest-milestone-tick {
    position: absolute;
    top: 0;
    width: 1px;
    height: 100%;
    background: var(--glass-border);
    z-index: 1;
}

/* History Chart */
.quest-detail-chart-section {
    margin-bottom: var(--spacing-3);
}

.quest-detail-section-title {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-main);
    margin: 0 0 var(--spacing-sm);
}

.quest-chart-container {
    position: relative;
    width: 100%;
    height: 200px;
    background: var(--glass-bg);
    border-radius: var(--md-sys-shape-corner-medium);
    padding: var(--spacing-sm);
}

.quest-chart-container canvas {
    width: 100% !important;
    height: 100% !important;
}

/* ── Quest chart zoom wrapper ── */
.quest-chart-wrapper {
    position: relative;
    width: 100%;
    overflow: hidden;
    border-radius: var(--md-sys-shape-corner-medium);
}

/* ── Quest point info card (data point click) ── */
.quest-point-info-card {
    margin-top: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    animation: fade-in 0.2s ease;
}
.qpic-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--md-sys-typescale-label-medium-size, 12px);
    color: var(--text-dim);
    margin-bottom: var(--spacing-sm);
}
.qpic-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--spacing-xs);
}
.qpic-col {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    padding: var(--spacing-xs);
    border-radius: var(--md-sys-shape-corner-extra-small);
}
.qpic-col.qpic-selected {
    background: var(--primary);
    border-radius: var(--md-sys-shape-corner-small);
}
.qpic-label {
    font-size: 10px;
    color: var(--text-dim);
    white-space: nowrap;
    text-align: center;
}
.qpic-selected .qpic-label { color: var(--on-primary); opacity: 0.8; }
.qpic-value {
    font-size: var(--md-sys-typescale-label-large-size, 14px);
    font-weight: 600;
    color: var(--text-main);
    white-space: nowrap;
}
.qpic-selected .qpic-value { color: var(--on-primary); }

/* ── Quest D-Day calendar view ── */
.quest-dday-calendar { margin-bottom: var(--spacing-3); }
.qcal-countdown {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
}
.qcal-dday-label {
    font-size: var(--md-sys-typescale-headline-small-size, 24px);
    font-weight: 700;
    color: var(--primary);
    min-width: 80px;
}
.qcal-countdown.today .qcal-dday-label { color: var(--success, #4caf50); }
.qcal-countdown.overdue .qcal-dday-label { color: var(--error, #f44336); }
.qcal-target-date {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim);
}
.qcal-month-label {
    text-align: center;
    font-size: var(--md-sys-typescale-title-small-size, 14px);
    font-weight: 600;
    color: var(--text-main);
    margin-bottom: var(--spacing-xs);
}
.qcal-grid { width: 100%; }
.qcal-header-row,
.qcal-body {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 2px;
}
.qcal-header-cell {
    text-align: center;
    font-size: 10px;
    color: var(--text-dim);
    padding: var(--spacing-xs) 0;
}
.qcal-day {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    border-radius: var(--md-sys-shape-corner-extra-small);
    color: var(--text-main);
}
.qcal-day.qcal-past { color: var(--text-dim); }
.qcal-day.qcal-today {
    background: var(--primary);
    color: var(--on-primary);
    font-weight: 700;
    border-radius: 50%;
}
.qcal-day.qcal-target {
    background: var(--tertiary, var(--accent));
    color: var(--on-tertiary, #fff);
    font-weight: 700;
    border-radius: 50%;
    outline: 2px solid var(--tertiary, var(--accent));
    outline-offset: 2px;
}
.qcal-day.qcal-today.qcal-target {
    background: linear-gradient(135deg, var(--primary) 50%, var(--tertiary, var(--accent)) 50%);
    color: var(--on-primary);
}
.qcal-day.qcal-empty { visibility: hidden; }

.quest-detail-no-history {
    text-align: center;
    padding: var(--spacing-lg) var(--spacing-md);
    color: var(--text-dim2);
}

.quest-detail-no-history .material-symbols-outlined,
.quest-detail-no-history .svg-icon {
    font-size: 32px;
    margin-bottom: var(--spacing-sm);
    opacity: 0.4;
}

.quest-detail-no-history p {
    margin: 0;
    font-size: var(--md-sys-typescale-body-small-size);
}

/* Linked Field Info */
.quest-detail-linked {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-2-5) var(--spacing-3);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.06);
    border-radius: var(--md-sys-shape-corner-small);
    font-size: var(--md-sys-typescale-label-medium-size);
    color: var(--text-dim);
    margin-top: var(--spacing-sm);
}

.quest-detail-linked .material-symbols-outlined,
.quest-detail-linked .svg-icon {
    color: var(--primary);
}

/* ==================== */
/* Quest Create/Edit Dialog */
/* ==================== */
.quest-dialog-overlay {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: calc(var(--z-index-modal) + 10);
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-md);
    animation: fadeIn var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized-decelerate);
}

.quest-dialog-surface {
    width: 100%;
    max-height: calc(100vh - var(--spacing-xl));
    overflow-y: auto;
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large);
    padding: var(--spacing-lg);
}

.quest-dialog-surface h3 {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    color: var(--text-main);
    margin: 0 0 var(--spacing-5);
}

.quest-dialog-form {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.quest-form-group {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-1-5);
}

.quest-form-group label {
    font-size: var(--md-sys-typescale-label-medium-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
    color: var(--text-dim);
}

.quest-form-group input,
.quest-form-group select,
.quest-form-group textarea {
    padding: var(--spacing-2-5) 14px;
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-small);
    background: var(--glass-bg);
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-body-medium-size);
    transition: border-color var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-form-group input:focus,
.quest-form-group select:focus,
.quest-form-group textarea:focus {
    outline: none;
    border-color: var(--primary);
}

.quest-form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
}

.quest-form-row-3 {
    grid-template-columns: 1fr 1fr 1fr;
}

.quest-linked-hint {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    line-height: 1.4;
}

.quest-dialog-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-5);
}

.quest-dialog-cancel {
    padding: var(--spacing-2-5) var(--spacing-5);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-dim);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-dialog-cancel:hover { background: var(--glass-bg); }

.quest-dialog-save {
    padding: var(--spacing-2-5) var(--spacing-lg);
    border: none;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--primary);
    color: var(--on-primary);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: background var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
}

.quest-dialog-save:hover { opacity: 0.9; }

/* ==================== */
/* Health Modal */
/* ==================== */
.health-modal-overlay {
    position: fixed;
    inset: 0;
    background: var(--modal-backdrop);
    z-index: var(--z-index-modal);
    display: flex;
    align-items: flex-end;
    justify-content: center;
    padding: var(--spacing-md) var(--spacing-md) 0;
    opacity: 0;
    pointer-events: none;
    transition: opacity var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-standard);
}

.health-modal-overlay.visible {
    opacity: 1;
    pointer-events: auto;
}

.health-modal-surface {
    width: 100%;
    max-height: calc(100vh - 15px);
    overflow-y: auto;
    background: var(--modal-bg);
    border-radius: var(--md-sys-shape-corner-extra-large) var(--md-sys-shape-corner-extra-large) 0 0;
    transform: translateY(100%);
    transition: transform var(--md-sys-motion-duration-medium4) var(--md-sys-motion-easing-emphasized);
}

.health-modal-overlay.visible .health-modal-surface {
    transform: translateY(0);
}

.health-modal-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-5) var(--spacing-lg) var(--spacing-3);
    border-bottom: 1px solid var(--glass-border);
    position: sticky;
    top: 0;
    background: var(--modal-bg);
    z-index: 1;
}

.health-modal-title {
    font-size: var(--md-sys-typescale-title-large-size);
    font-weight: var(--md-sys-typescale-title-large-weight);
    color: var(--text-main);
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.health-modal-close {
    flex-shrink: 0;
}

.health-modal-content {
    padding: var(--spacing-5) var(--spacing-lg) var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
}

.health-warnings-section,
.health-hrt-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

.health-section-title {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-medium-weight);
    color: var(--text-main);
    margin: 0;
    display: flex;
    align-items: center;
    gap: var(--spacing-1-5);
}

/* Health Warning Cards */
.health-warning-card {
    padding: 14px var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border-left: 4px solid var(--glass-border);
}

.health-warning-card.severity-high {
    border-left-color: var(--md-sys-color-error, #f2b8b5);
    background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.08);
}

.health-warning-card.severity-medium {
    border-left-color: var(--warning, #ffb74d);
    background: rgba(255, 183, 77, 0.08);
}

.health-warning-card.severity-low {
    border-left-color: var(--info, #64b5f6);
    background: rgba(100, 181, 246, 0.08);
}

.health-warning-card.severity-info {
    border-left-color: var(--md-sys-color-outline-variant, var(--glass-border));
}

.warning-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    margin-bottom: var(--spacing-sm);
}

.severity-chip {
    display: inline-flex;
    align-items: center;
    padding: var(--spacing-xxs) var(--spacing-2-5);
    border-radius: var(--md-sys-shape-corner-full);
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.severity-chip.severity-high {
    background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.2);
    color: var(--md-sys-color-error, #f2b8b5);
}

.severity-chip.severity-medium {
    background: rgba(255, 183, 77, 0.2);
    color: var(--warning, #ffb74d);
}

.severity-chip.severity-low {
    background: rgba(100, 181, 246, 0.2);
    color: var(--info, #64b5f6);
}

.severity-chip.severity-info {
    background: var(--glass-bg);
    color: var(--text-dim);
}

.warning-title {
    font-size: var(--md-sys-typescale-title-small-size);
    font-weight: var(--md-sys-typescale-title-small-weight);
    color: var(--text-main);
}

.warning-description {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
    margin: 0 0 var(--spacing-1-5);
}

.warning-recommendation {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--primary);
    line-height: 1.5;
    margin: 0;
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-xs);
}

/* Health No Warnings */
.health-no-warnings {
    text-align: center;
    padding: var(--spacing-xl) var(--spacing-md);
}

.no-warnings-text {
    font-size: var(--md-sys-typescale-body-large-size);
    color: var(--text-main);
    margin: 0 0 var(--spacing-xs);
}

.no-warnings-hint {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    margin: 0;
}

/* HRT Info Card */
.hrt-info-card {
    padding: 14px var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
}

.hrt-info-card p {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.6;
    margin: 0;
}

/* Health Preview (SV Card) */
.health-preview {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
}

/* Health Card Alerts Widget */
#health-card-alerts {
    display: flex;
    flex-direction: column;
    gap: 6px;
    margin-top: var(--spacing-sm);
}

.health-card-alert {
    display: flex;
    align-items: flex-start;
    gap: 6px;
    padding: 6px 8px;
    border-radius: var(--md-sys-shape-corner-small, 8px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    line-height: 1.4;
}

.health-card-critical {
    background: rgba(255, 84, 73, 0.1);
    color: var(--md-sys-color-error, #FF5449);
}

.health-card-critical .material-symbols-outlined,
.health-card-critical .svg-icon {
    color: var(--md-sys-color-error, #FF5449);
    font-size: 14px !important;
    flex-shrink: 0;
}

.health-card-warning {
    background: rgba(255, 180, 0, 0.1);
    color: var(--warning, #FFB400);
}

.health-card-warning .material-symbols-outlined,
.health-card-warning .svg-icon {
    color: var(--warning, #FFB400);
    font-size: 14px !important;
    flex-shrink: 0;
}

.health-card-status {
    display: flex;
    align-items: center;
    gap: 6px;
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    padding: 6px 8px;
    border-radius: var(--md-sys-shape-corner-small, 8px);
}

.health-card-ok {
    background: rgba(76, 175, 80, 0.08);
    color: var(--success, #4CAF50);
}

.health-card-more {
    font-size: 10px;
    color: var(--text-dim2, #777);
    text-align: right;
    padding-top: 2px;
}

/* ─── Health Chip System (Themed Colors) ─── */
.health-card-alerts-container {
    display: flex;
    flex-direction: column;
    gap: 5px;
    margin-top: var(--spacing-sm);
}

.health-chip {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 5px 10px;
    border-radius: var(--md-sys-shape-corner-small, 8px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 500;
    line-height: 1.4;
}

.health-chip .material-symbols-outlined,
.health-chip .svg-icon {
    font-size: 14px !important;
    flex-shrink: 0;
}

/* Using primary hue family: shift saturation/lightness for severity */
.health-chip--good {
    background: color-mix(in oklch, var(--primary) 12%, transparent);
    color: color-mix(in oklch, var(--primary) 80%, #4CAF50 20%);
}

.health-chip--good .material-symbols-outlined,
.health-chip--good .svg-icon {
    color: color-mix(in oklch, var(--primary) 60%, #4CAF50 40%);
}

.health-chip--warning {
    background: color-mix(in oklch, var(--primary) 8%, rgba(255,180,0,0.08) 92%);
    color: color-mix(in oklch, var(--primary) 30%, #FFB400 70%);
}

.health-chip--warning .material-symbols-outlined,
.health-chip--warning .svg-icon {
    color: color-mix(in oklch, var(--primary) 20%, #FFB400 80%);
}

.health-chip--critical {
    background: color-mix(in oklch, var(--primary) 6%, rgba(255,84,73,0.10) 94%);
    color: color-mix(in oklch, var(--primary) 15%, #FF5449 85%);
}

.health-chip--critical .material-symbols-outlined,
.health-chip--critical .svg-icon {
    color: color-mix(in oklch, var(--primary) 10%, #FF5449 90%);
}

.health-chip--more {
    font-size: 10px;
    color: var(--text-dim2, #777);
    text-align: right;
    padding: 2px 10px 0;
    justify-content: flex-end;
}

/*
 * Progressive background: --shortcut-bg-pct is set via JS inline style
 * (5% per day since last measurement, max 50%)
 */
#sv-card-shortcut {
    background: color-mix(in oklch, var(--primary) var(--shortcut-bg-pct, 0%), var(--glass-bg, rgba(255,255,255,0.05)));
    transition: background 0.6s ease;
}

/* ─── Shortcut Card — D-day layout ─── */
.shortcut-card {
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    padding: 2px 0;
    gap: 6px;
}

.shortcut-dday {
    font-size: clamp(1.6rem, 4vw, 2.2rem);
    font-weight: 800;
    line-height: 1;
    letter-spacing: -0.02em;
    color: var(--primary, #D0BCFF);
}

/* Status colours for D-day label */
.shortcut-dday--overdue { color: var(--md-sys-color-error, #FF5449); }
.shortcut-dday--dday    { color: color-mix(in oklch, var(--primary) 60%, #FFB400 40%); }
.shortcut-dday--urgent  { color: var(--warning, #FFB400); }
.shortcut-dday--soon    { color: color-mix(in oklch, var(--primary) 70%, #FFB400 30%); }
.shortcut-dday--ok      { color: var(--primary, #D0BCFF); }

.shortcut-detail {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim, #a0a0a0);
    line-height: 1.4;
    margin-top: 2px;
}

/* First-entry state: icon + text */
.shortcut-new-icon {
    font-size: 28px !important;
    color: var(--primary, #D0BCFF);
    display: block;
    margin-bottom: 4px;
}

/* ─── Body Summary Metric Slide ─── */
.sv-metric-slide {
    display: flex;
    flex-direction: column;
    gap: 6px;
    padding: var(--spacing-xs, 4px) var(--spacing-sm, 8px) !important;
}

.sv-metric-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.sv-metric-title {
    font-size: var(--md-sys-typescale-label-medium-size, 12px);
    font-weight: 600;
    color: var(--text-dim, #a0a0a0);
    margin: 0;
}

.sv-metric-pct {
    font-size: 11px;
    font-weight: 700;
    padding: 1px 7px;
    border-radius: var(--md-sys-shape-corner-full, 9999px);
}

.sv-metric-pct.positive-change {
    background: color-mix(in oklch, var(--primary) 10%, rgba(76,175,80,0.10) 90%);
    color: color-mix(in oklch, var(--primary) 30%, #4CAF50 70%);
}

.sv-metric-pct.negative-change {
    background: color-mix(in oklch, var(--primary) 10%, rgba(255,84,73,0.10) 90%);
    color: color-mix(in oklch, var(--primary) 30%, #FF5449 70%);
}

.sv-metric-body {
    padding: 4px 0;
}

.sv-metric-value {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    margin: 0;
}

.sv-metric-footer {
    display: flex;
    align-items: center;
    gap: 4px;
}

.sv-metric-icon {
    font-size: 16px !important;
}

.sv-metric-icon.positive-change { color: color-mix(in oklch, var(--primary) 40%, #4CAF50 60%); }
.sv-metric-icon.negative-change { color: color-mix(in oklch, var(--primary) 40%, #FF5449 60%); }

.sv-metric-change {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim, #a0a0a0);
    margin: 0;
}

.sv-metric-change.positive-change { color: color-mix(in oklch, var(--primary) 30%, #4CAF50 70%); }
.sv-metric-change.negative-change { color: color-mix(in oklch, var(--primary) 30%, #FF5449 70%); }

/* ─── Hormone Compact Card (shc-*) ─── */
.sv-card-hormones-compact {
    /* Override any carousel remnants */
    overflow: hidden;
}

.shc-grid {
    display: flex;
    flex-direction: column;
    gap: 6px;
}

.shc-row {
    display: grid;
    grid-template-columns: auto 1fr auto;
    align-items: center;
    gap: 8px;
    padding: 6px 8px;
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-small, 8px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.04));
}

.shc-label {
    display: flex;
    align-items: center;
    gap: 5px;
    min-width: 0;
}

.shc-abbr {
    font-size: 10px;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    background: color-mix(in oklch, var(--primary) 12%, transparent);
    padding: 2px 5px;
    border-radius: 5px;
    line-height: 1;
    flex-shrink: 0;
}

.shc-name {
    font-size: 11px;
    font-weight: 500;
    color: var(--text-main, #e0e0e0);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.shc-data {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    min-width: 0;
}

.shc-value {
    font-size: 0.95rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    line-height: 1.2;
}

.shc-target {
    font-size: 9px;
    color: var(--text-dim2, #777);
    white-space: nowrap;
}

.shc-badge {
    font-size: 0 !important;
    padding: 3px;
    gap: 0;
    flex-shrink: 0;
    border-radius: 6px;
}

.shc-badge .material-symbols-outlined,
.shc-badge .svg-icon {
    font-size: 14px !important;
}

/* E/T Ratio mini bar */
.shc-ratio {
    margin-top: 6px;
    padding: 6px 8px;
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-small, 8px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.04));
}

.shc-ratio-bar {
    display: flex;
    flex-direction: column;
    gap: 3px;
}

.shc-ratio-track {
    height: 6px;
    border-radius: 3px;
    background: linear-gradient(to right, var(--info, #64b5f6), var(--warning, #ffb74d));
    position: relative;
}

.shc-ratio-marker {
    position: absolute;
    top: 50%;
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background: var(--text-main, #e0e0e0);
    border: 2px solid var(--glass-bg, #1a1a2e);
    transform: translate(-50%, -50%);
    box-shadow: 0 0 0 1px var(--text-main);
}

.shc-ratio-labels {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 10px;
    color: var(--text-dim2, #777);
}

.shc-ratio-val {
    font-weight: 600;
    color: var(--text-dim, #a0a0a0);
}

/* Health Symptom Analysis */
.health-symptom-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
}

.symptom-summary-text {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-dim);
    line-height: 1.6;
    margin: 0;
}

.symptom-insight-item {
    display: flex;
    align-items: flex-start;
    gap: var(--spacing-sm);
    padding: var(--spacing-2-5) 14px;
    border-radius: var(--md-sys-shape-corner-medium);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.06);
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
    margin-bottom: var(--spacing-1-5);
}

.symptom-insight-item .insight-body {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
    min-width: 0;
}
.symptom-insight-item .insight-body strong {
    color: var(--text-primary);
    font-size: var(--md-sys-typescale-body-medium-size);
}
.symptom-insight-item .insight-symptoms {
    display: flex;
    flex-wrap: wrap;
    gap: 4px;
    margin-top: 2px;
}
.symptom-insight-item .insight-advice {
    margin: 4px 0 0;
    display: flex;
    align-items: center;
    gap: 4px;
    color: var(--primary);
    font-size: var(--md-sys-typescale-label-small-size);
}

.symptom-insight-item:last-child { margin-bottom: 0; }

.symptom-insight-item .material-symbols-outlined,
.symptom-insight-item .svg-icon {
    color: var(--primary);
    flex-shrink: 0;
    margin-top: 1px;
}

.symptom-trends-row {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-1-5);
}

.symptom-trend-chip {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-3);
    border-radius: var(--md-sys-shape-corner-full);
    font-size: var(--md-sys-typescale-label-small-size);
    font-weight: var(--md-sys-typescale-label-medium-weight);
}

.symptom-trend-chip.trend-good {
    background: rgba(129, 199, 132, 0.15);
    color: var(--success, #81c784);
}

.symptom-trend-chip.trend-bad {
    background: rgba(var(--md-sys-color-error-rgb, 242, 184, 181), 0.15);
    color: var(--md-sys-color-error, #f2b8b5);
}

.symptom-trend-chip.trend-neutral {
    background: var(--glass-bg);
    color: var(--text-dim);
}

.hormone-cycle-info {
    padding: var(--spacing-3) var(--spacing-md);
    border-radius: var(--md-sys-shape-corner-medium);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
}

.cycle-phase {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-main);
    margin-bottom: var(--spacing-xs);
}

.cycle-recommendation {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.5;
    margin: 0;
}

/* ═══════════════════════════════════════════
   Phase 9: Symptom Causes & Compound Analysis
   ═══════════════════════════════════════════ */

.health-causes-section,
.health-compound-section,
.health-hormone-range-section {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-md);
}

/* Cause Analysis Cards */
.cause-analysis-card {
    background: var(--state-hover);
    border-radius: var(--radius-md, 12px);
    padding: var(--spacing-sm) var(--spacing-md);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}
.cause-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.cause-symptom-name {
    font-weight: 500;
    color: var(--text-primary);
    text-transform: capitalize;
    font-size: var(--md-sys-typescale-body-large-size, 16px);
}
.cause-severity-badge {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 600;
    padding: 2px var(--spacing-sm);
    border-radius: var(--radius-full, 100px);
}
.cause-severity-badge.severity-high {
    background: var(--md-sys-color-error-container, rgba(255,50,50,0.15));
    color: var(--md-sys-color-error, #FF5449);
}
.cause-severity-badge.severity-medium {
    background: rgba(255, 180, 0, 0.15);
    color: #FFB400;
}
.cause-severity-badge.severity-low {
    background: rgba(129, 199, 132, 0.15);
    color: #81C784;
}

/* Cause chips */
.cause-chips {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
}
.cause-chip {
    display: inline-flex;
    align-items: center;
    padding: 2px var(--spacing-sm);
    border-radius: var(--radius-full, 100px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    background: rgba(var(--primary-rgb, 147, 143, 255), 0.12);
    color: var(--md-sys-color-primary);
    text-transform: capitalize;
}

/* Hospital advice */
.hospital-advice {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-sm);
    border-radius: var(--radius-sm, 8px);
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    font-weight: 600;
}
.hospital-advice.hospital-critical {
    background: var(--md-sys-color-error-container, rgba(255,50,50,0.15));
    color: var(--md-sys-color-error, #FF5449);
}
.hospital-advice.hospital-warning {
    background: rgba(255, 180, 0, 0.12);
    color: #FFB400;
}

/* Resolution grid */
.resolution-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-xs);
}
.resolution-category {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxs);
}
.resolution-cat-label {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    font-weight: 600;
    color: var(--text-dim);
    text-transform: uppercase;
    letter-spacing: 0.5px;
}
.resolution-list {
    margin: 0;
    padding-left: var(--spacing-md);
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim);
    line-height: 1.6;
}
.resolution-list li::marker {
    color: var(--md-sys-color-primary);
}

/* Compound Pattern Cards */
.compound-pattern-card {
    border-radius: var(--radius-md, 12px);
    padding: var(--spacing-sm) var(--spacing-md);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xs);
}
.compound-pattern-card.severity-critical {
    background: var(--md-sys-color-error-container, rgba(255,50,50,0.12));
    border-left: 3px solid var(--md-sys-color-error, #FF5449);
}
.compound-pattern-card.severity-warning {
    background: rgba(255, 180, 0, 0.1);
    border-left: 3px solid #FFB400;
}
.compound-header {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    color: var(--text-primary);
}
.compound-description {
    margin: 0;
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim);
    line-height: 1.5;
}
.compound-action {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    font-weight: 600;
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
    color: var(--md-sys-color-primary);
}
.compound-matched {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-xs);
    margin-top: var(--spacing-xs);
}

/* Hormone Range Cards */
.hormone-range-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: var(--spacing-sm) var(--spacing-md);
    border-radius: var(--radius-md, 12px);
    background: var(--state-hover);
}
.hormone-range-card.range-ideal {
    border-left: 3px solid var(--md-sys-color-primary);
}
.hormone-range-card.range-caution {
    border-left: 3px solid #FFB400;
}
.hormone-range-card.range-danger {
    border-left: 3px solid var(--md-sys-color-error, #FF5449);
}
.hormone-range-header {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-xxs);
}
.hormone-range-name {
    font-weight: 500;
    color: var(--text-primary);
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
}
.hormone-range-status {
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim);
}
.hormone-range-value {
    font-weight: 600;
    font-size: var(--md-sys-typescale-title-medium-size, 16px);
    color: var(--md-sys-color-primary);
}

/* ==================== */
/* Responsive Breakpoints */
/* ==================== */

/* Tablet (≥600px) */
@media (min-width: 600px) {
    .container {
        padding: var(--spacing-lg) var(--spacing-lg) 100px;
    }

    .sv-grid {
        gap: var(--spacing-md);
    }

    .input-grid {
        grid-template-columns: 1fr 1fr;
    }

    /* Quest modal: bottom-sheet → centered dialog on medium+ */
    .quest-modal-overlay {
        align-items: center;
        padding: var(--spacing-lg);
    }
    .quest-modal-surface {
        max-width: 560px;
        max-height: 85vh;
        border-radius: var(--md-sys-shape-corner-extra-large);
        transform: translateY(24px) scale(0.96);
    }
    .quest-modal-overlay.visible .quest-modal-surface {
        transform: translateY(0) scale(1);
    }
}

/* Desktop / Navigation Rail (≥840px) — see bottom of file */

/* ==================== */
/* Safe Area (PWA) */
/* ==================== */
@supports (padding: env(safe-area-inset-bottom)) {
    .tab-bar {
        padding-bottom: env(safe-area-inset-bottom);
    }

    .container {
        padding-bottom: calc(100px + env(safe-area-inset-bottom));
    }
}

/* ==================== */
/* Print */
/* ==================== */
@media print {
    .tab-bar,
    .app-bar-actions,
    .button-group,
    .glass-button,
    .icon-button,
    .modal-overlay,
    .modal-bottom-sheet-overlay,
    .diary-bottom-sheet {
        display: none !important;
    }

    body {
        background: white;
        color: black;
    }

    .glass-card {
        border: 1px solid var(--md-sys-color-outline-variant, #ddd);
        box-shadow: none;
        break-inside: avoid;
    }
}

/* ==================== */
/* body.modal-open */
/* ==================== */
body.modal-open {
    overflow: hidden;
}

/* ==================== */
/* SV Card Variants */
/* ==================== */
.sv-card-with-image {
    position: relative;
    overflow: hidden;
}

.sv-card-image-normal .carousel-content,
.sv-card-image-write .carousel-content {
    scroll-snap-type: x mandatory;
    overflow-x: auto;
    scrollbar-width: none;
    -ms-overflow-style: none;
}

.sv-card-image-normal .carousel-content::-webkit-scrollbar,
.sv-card-image-write .carousel-content::-webkit-scrollbar {
    display: none;
}

.sv-metric-slide,
.sv-action-slide,
.sv-hormone-summary-slide {
    scroll-snap-align: start;
    padding: var(--spacing-xs) 0;
}

/* ─── Hormone Widget Mini Cards ─── */
.sv-hormone-rows {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.sv-hormone-row {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    gap: 8px;
    padding: 8px 10px;
    background: var(--md-sys-color-surface-container, rgba(255,255,255,0.04));
    border-radius: var(--md-sys-shape-corner-medium, 12px);
    border: 1px solid var(--glass-border, rgba(255,255,255,0.06));
}

.sv-hormone-row-left {
    display: flex;
    align-items: center;
    gap: 6px;
    flex-shrink: 0;
}

.sv-hormone-abbr {
    font-size: 11px;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    background: rgba(208,188,255,0.1);
    padding: 2px 6px;
    border-radius: 6px;
    line-height: 1;
}

.sv-hormone-row-name {
    font-size: 11px;
    font-weight: 600;
    color: var(--text-main, #e0e0e0);
    white-space: nowrap;
}

.sv-hormone-row-right {
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 2px;
    min-width: 0;
}

.sv-hormone-row-value {
    font-size: 1rem;
    font-weight: 700;
    color: var(--primary, #D0BCFF);
    line-height: 1.2;
}

.sv-hormone-row-target {
    font-size: 10px;
    color: var(--text-dim2, #777);
}

.sv-hormone-row .status-badge {
    font-size: 9px;
    padding: 1px 7px;
    gap: 2px;
}

.sv-hormone-row .status-icon {
    font-size: 12px !important;
}

.sv-ratio-row {
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
}

.sv-ratio-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
    flex-shrink: 0;
}

.sv-ratio-bar-wrapper {
    flex: 1;
}

.sv-action-category {
    display: flex;
    align-items: center;
    gap: var(--spacing-1-5);
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--primary);
    margin-bottom: var(--spacing-sm);
}

.sv-action-category .category-icon {
    font-size: 18px;
}

.sv-action-items {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-1-5);
}

.sv-action-item {
    padding: var(--spacing-1-5) 0;
    border-bottom: 1px solid color-mix(in srgb, var(--glass-border) 50%, transparent);
}

.sv-action-item:last-child {
    border-bottom: none;
}

.sv-action-item-title {
    font-size: var(--md-sys-typescale-body-medium-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-main);
}

.sv-action-item-reason {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    margin-top: var(--spacing-xxs);
}

.sv-action-empty {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    text-align: center;
    padding: var(--spacing-3);
}

/* Diary & Quest SV card previews */
.diary-preview-item {
    padding: var(--spacing-1-5) 0;
    border-bottom: 1px solid color-mix(in srgb, var(--glass-border) 50%, transparent);
}
.diary-preview-item:last-child { border-bottom: none; }
.diary-preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-xxs);
}
.diary-preview-date {
    font-size: var(--md-sys-typescale-label-medium-size);
    color: var(--primary);
    font-weight: 600;
}
.diary-preview-mood { font-size: var(--md-sys-typescale-body-large-size); }
.diary-preview-text {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim);
    line-height: 1.4;
    margin: 0;
}

.quest-preview-item {
    padding: var(--spacing-1-5) 0;
    border-bottom: 1px solid color-mix(in srgb, var(--glass-border) 50%, transparent);
}
.quest-preview-item:last-child { border-bottom: none; }
.quest-preview-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-xs);
}
.quest-preview-title {
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-main);
    font-weight: 500;
}
.quest-preview-pct {
    font-size: var(--md-sys-typescale-label-medium-size);
    color: var(--primary);
    font-weight: 600;
}
.quest-preview-bar {
    width: 100%;
    height: 6px;
    border-radius: 3px;
    background: color-mix(in srgb, var(--primary) 15%, transparent);
    overflow: hidden;
}
.quest-preview-fill {
    height: 100%;
    border-radius: 3px;
    background: var(--primary);
    transition: width 0.3s ease;
}

.placeholder {
    text-align: center;
    color: var(--text-dim2);
    font-size: var(--md-sys-typescale-body-small-size);
    padding: var(--spacing-md) var(--spacing-sm);
}

/* Carousel Dots — also support .carousel-dot class */
.carousel-dots .carousel-dot,
.carousel-dots .dot,
.carousel-dots span {
    width: 8px;
    height: 8px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--text-dim2);
    transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
    cursor: pointer;
    display: inline-block;
}

.carousel-dots .carousel-dot.active,
.carousel-dots .dot.active,
.carousel-dots span.active {
    background: var(--primary);
    width: 24px;
}

/* ==================== */
/* CSS 클래스 정규화 별칭 (19-8)         */
/* 기존 carousel-*/  md-modal-* 동시 지원 */
/* ==================== */

/* .md-carousel-* — Plan 12-6-3 표준 이름 (기존 .carousel-* 와 병행) */
.md-carousel              { position: relative; }  /* .carousel-container */
.md-carousel-content      { display: flex;
                            transition: transform var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized);
                            will-change: transform; } /* .carousel-content */
.md-carousel-slide        { min-width: 100%; flex-shrink: 0;
                            padding: var(--spacing-xs) 0;
                            box-sizing: border-box; } /* .carousel-item */
.md-carousel-arrow        { position: absolute; top: 50%; transform: translateY(-50%);
                            width: 28px; height: 28px; border: none;
                            border-radius: var(--md-sys-shape-corner-full);
                            background: var(--glass-bg-light); color: var(--text-dim);
                            cursor: pointer; display: none;
                            align-items: center; justify-content: center;
                            z-index: 1; opacity: 0.8; } /* .carousel-nav-btn */
.md-carousel:hover .md-carousel-arrow { display: flex; }
.md-carousel-dots         { display: flex; justify-content: center;
                            gap: var(--spacing-1-5); margin-top: var(--spacing-2-5); } /* .carousel-dots */
.md-carousel-dots .md-carousel-dot { width: 8px; height: 8px;
                            border-radius: var(--md-sys-shape-corner-full);
                            background: var(--text-dim2); display: inline-block;
                            transition: all var(--md-sys-motion-duration-short3) var(--md-sys-motion-easing-standard);
                            cursor: pointer; }
.md-carousel-dots .md-carousel-dot.active { background: var(--primary); width: 24px; }

/* .md-modal-* — Plan 12-6-3 표준 이름 (기존 .modal-* 와 병행, .md-modal = .modal-overlay > .modal-content) */
.md-modal-header  { position: sticky; top: 0; background: var(--modal-bg); z-index: 1;
                    padding: 0 var(--spacing-lg); display: flex;
                    align-items: center; justify-content: space-between;
                    border-bottom: 1px solid var(--glass-border); } /* .modal-header */
.md-modal-body    { padding: var(--spacing-md) var(--spacing-lg);
                    overflow-y: auto; } /* .modal-content-inner */
.md-modal-actions { display: flex; gap: var(--spacing-sm);
                    justify-content: flex-end;
                    padding: var(--spacing-sm) var(--spacing-lg) var(--spacing-md); } /* 하단 버튼 영역 */

/* ==================== */
/* Onboarding Flow */
/* ==================== */
.onboarding-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--spacing-md);
    opacity: 0;
    transition: opacity var(--md-sys-motion-duration-medium2) var(--md-sys-motion-easing-emphasized);
}

.onboarding-overlay.visible {
    opacity: 1;
}

.onboarding-surface {
    width: 100%;
    max-width: 480px;
    max-height: 90vh;
    background: var(--modal-bg, var(--glass-bg));
    border-radius: var(--md-sys-shape-corner-extra-large);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    box-shadow: var(--md-sys-elevation-5);
    transform: translateY(24px) scale(0.96);
    transition: transform var(--md-sys-motion-duration-medium4) var(--md-sys-motion-easing-emphasized);
}

.onboarding-overlay.visible .onboarding-surface {
    transform: translateY(0) scale(1);
}

.onboarding-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-xl) var(--spacing-lg) var(--spacing-md);
    transition: opacity 150ms ease;
}

.onboarding-footer {
    padding: var(--spacing-3) var(--spacing-lg) var(--spacing-lg);
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
}

.onboarding-dots {
    display: flex;
    justify-content: center;
    gap: var(--spacing-sm);
}

.onboarding-dot {
    width: 8px;
    height: 8px;
    border-radius: var(--md-sys-shape-corner-full);
    background: var(--text-dim2);
    transition: all var(--md-sys-motion-duration-medium1) var(--md-sys-motion-easing-emphasized);
    cursor: pointer;
}

.onboarding-dot.active {
    width: 24px;
    background: var(--primary);
}

.onboarding-actions {
    display: flex;
    justify-content: flex-end;
    gap: var(--spacing-sm);
}

/* Onboarding Step Content */
.onboarding-step-center {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: var(--spacing-sm);
}

.onboarding-step-center h2 {
    font-size: var(--md-sys-typescale-headline-medium-size);
    font-weight: 400;
    margin-bottom: 0;
    color: var(--text-main);
}

.onboarding-logo {
    font-size: var(--md-sys-typescale-display-medium-size);
    font-weight: 700;
    color: var(--primary);
    letter-spacing: 2px;
    margin-bottom: var(--spacing-sm);
}

.onboarding-sub {
    font-size: var(--md-sys-typescale-body-large-size);
    color: var(--text-dim);
    margin-bottom: var(--spacing-md);
}

.onboarding-hint {
    font-size: var(--md-sys-typescale-body-small-size);
    color: var(--text-dim2);
    margin-top: var(--spacing-3);
    padding: var(--spacing-sm) var(--spacing-3);
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-radius: var(--md-sys-shape-corner-medium);
}

.onboarding-step-icon {
    width: 64px;
    height: 64px;
    border-radius: var(--md-sys-shape-corner-full);
    background: color-mix(in srgb, var(--primary) 12%, transparent);
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: var(--spacing-3);
}

.onboarding-step-icon .material-symbols-outlined,
.onboarding-step-icon .svg-icon,
.mi-xl {
    font-size: var(--md-sys-typescale-headline-large-size);
    color: var(--primary);
}

/* Language chips */
.onboarding-lang-chips {
    display: flex;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
    justify-content: center;
    margin-top: var(--spacing-3);
}

.onboarding-lang-chip {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-1-5);
    padding: var(--spacing-2-5) var(--spacing-5);
    border: 2px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.onboarding-lang-chip:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-color: var(--primary);
}

.onboarding-lang-chip.active {
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    border-color: var(--md-sys-color-secondary-container, var(--accent-hover));
}

/* Account options */
.onboarding-account-options {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
    margin-top: var(--spacing-md);
    width: 100%;
    max-width: 300px;
}

/* Theme toggle */
.onboarding-theme-toggle {
    display: flex;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
    justify-content: center;
    margin-top: var(--spacing-3);
}

.onboarding-theme-btn {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-1-5);
    padding: var(--spacing-2-5) 18px;
    border: 2px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-full);
    background: transparent;
    color: var(--text-main);
    font-family: inherit;
    font-size: var(--md-sys-typescale-label-large-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    cursor: pointer;
    transition: all var(--md-sys-motion-duration-short4) var(--md-sys-motion-easing-standard);
}

.onboarding-theme-btn:hover {
    background: color-mix(in srgb, var(--primary) 8%, transparent);
    border-color: var(--primary);
}

.onboarding-theme-btn.active {
    background: var(--md-sys-color-secondary-container, var(--accent-hover));
    color: var(--md-sys-color-on-secondary-container, var(--text-main));
    border-color: var(--md-sys-color-secondary-container, var(--accent-hover));
}

/* Onboarding form */
.onboarding-form {
    width: 100%;
    text-align: left;
    margin-top: var(--spacing-md);
}

.onboarding-form .quest-form-group {
    margin-bottom: var(--spacing-3);
}

.onboarding-form .quest-form-group label {
    display: block;
    font-size: var(--md-sys-typescale-body-small-size);
    font-weight: var(--md-sys-typescale-label-large-weight);
    color: var(--text-dim);
    margin-bottom: var(--spacing-1-5);
}

.quest-form-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--spacing-3);
}

/* Tour cards */
.onboarding-tour-cards {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-3);
    margin-top: var(--spacing-md);
    width: 100%;
}

.onboarding-tour-card {
    display: flex;
    align-items: center;
    gap: var(--spacing-3);
    padding: 14px var(--spacing-md);
    background: var(--glass-bg);
    border: 1px solid var(--glass-border);
    border-radius: var(--md-sys-shape-corner-medium);
    text-align: left;
}

.onboarding-tour-card span:first-child {
    flex-shrink: 0;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: var(--md-sys-shape-corner-full);
    background: color-mix(in srgb, var(--primary) 12%, transparent);
    color: var(--primary);
}

.onboarding-tour-card p {
    margin: 0;
    font-size: var(--md-sys-typescale-body-medium-size);
    color: var(--text-main);
}

/* ==================== */
/* Desktop Navigation Rail — override for pill style */
/* ==================== */
@media (min-width: 840px) {
    .tab-bar {
        position: fixed;
        left: 0;
        top: 50%;
        bottom: auto;
        right: auto;
        transform: translateX(0) translateY(-50%);
        width: 80px;
        flex-direction: column;
        justify-content: center;
        gap: var(--spacing-sm);
        max-width: 80px;
        padding-bottom: 0;
    }

    .tab-group {
        flex-direction: column;
        border-radius: var(--md-sys-shape-corner-extra-large);
        padding: var(--spacing-sm) var(--spacing-xs);
    }

    .tab-button {
        padding: var(--spacing-3) var(--spacing-sm);
    }

    .container {
        margin-left: 80px;
        width: calc(100% - 80px);
        box-sizing: border-box;
        /* 820px 콘텐츠를 가용 영역에서 자동 센터링 */
        padding-inline: max(var(--spacing-md), calc((100% - 820px) / 2));
        max-width: none;
        padding-bottom: var(--spacing-xl);
    }

    /* 데스크탑/태블릿: SV 그리드 3열로 전환 */
    .sv-grid {
        grid-template-columns: 1fr 1fr 1fr;
    }

    /* 3열에서 가이드 카드는 전체 폭 차지 안 함 (모바일 2열에서만 전체 폭) */
    #sv-card-guide,
    .sv-card-widget {
        grid-column: auto;
    }

    /* Snackbar/popup: offset for 80px Nav Rail */
    .popup {
        bottom: var(--spacing-lg);
        left: calc(40px + 50%);
    }
    .popup.show {
        transform: translateX(-50%) translateY(0);
    }
}

/* ═══════════════════════════════════════════
   Extended Navigation Rail (≥1200px Large)
   ═══════════════════════════════════════════ */
@media (min-width: 1200px) {
    /* Widen rail from 80px → 200px */
    .tab-bar {
        width: 200px;
        max-width: 200px;
    }

    .tab-group {
        width: 100%;
        padding: var(--spacing-xs);
    }

    /* Horizontal layout: icon + text label side by side */
    .tab-button {
        flex-direction: row;
        justify-content: flex-start;
        width: 100%;
        padding: var(--spacing-3) var(--spacing-md);
        gap: var(--spacing-sm);
        border-radius: var(--md-sys-shape-corner-large);
        min-width: unset;
        font-size: var(--md-sys-typescale-label-large-size);
    }

    /* Always show labels (not only on active) */
    .tab-button span {
        max-height: 24px;
        opacity: 1;
        font-size: var(--md-sys-typescale-label-large-size);
        font-weight: var(--md-sys-typescale-label-large-weight);
    }

    /* Active indicator: rounded for horizontal layout */
    .active-tab-indicator {
        border-radius: var(--md-sys-shape-corner-large);
    }

    /* Content area: shift for wider rail, center 1180px content in remaining space */
    .container {
        margin-left: 200px;
        width: calc(100% - 200px);
        box-sizing: border-box;
        padding-inline: max(var(--spacing-md), calc((100% - 1180px) / 2));
        max-width: none;
    }

    /* 4-column SV grid at large */
    .sv-grid {
        grid-template-columns: 1fr 1fr 1fr 1fr;
    }

    /* Snackbar: center in content area (100vw - 200px rail) */
    .popup {
        left: calc(100px + 50%);
    }
}

/* ═══════════════════════════════════════════
   AI Advisor Modal
   ═══════════════════════════════════════════ */

.ai-advisor-overlay {
    position: fixed;
    inset: 0;
    z-index: 9999;
    background: rgba(0, 0, 0, 0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 0;
    transition: opacity 0.2s ease;
    padding: var(--spacing-md);
}
.ai-advisor-overlay.visible {
    opacity: 1;
}

.ai-advisor-surface {
    width: 100%;
    height: 100%;
    max-width: 100%;
    max-height: 100%;
    background: var(--glass-bg, rgba(30, 30, 30, 0.95));
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-radius: var(--radius-xl, 28px);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    border: 1px solid var(--glass-border);
    box-shadow: var(--elevation-3);
    transform: scale(0.95);
    transition: transform 0.25s cubic-bezier(0.2, 0, 0, 1);
}
.ai-advisor-overlay.visible .ai-advisor-surface {
    transform: scale(1);
}

.ai-advisor-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: var(--spacing-md) var(--spacing-lg);
    border-bottom: 1px solid var(--glass-border);
    flex-shrink: 0;
}
.ai-advisor-header h2 {
    margin: 0;
    font-size: var(--md-sys-typescale-headline-small-size, 24px);
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: var(--spacing-sm);
    color: var(--text-primary);
}
.ai-advisor-close {
    background: none;
    border: none;
    color: var(--text-dim);
    font-size: 28px;
    cursor: pointer;
    padding: var(--spacing-xs);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.15s;
}
.ai-advisor-close:hover {
    background: var(--state-hover);
}

.ai-advisor-content {
    flex: 1;
    overflow-y: auto;
    padding: var(--spacing-lg);
    scroll-behavior: smooth;
}

/* Loading state */
.ai-advisor-loading {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: var(--spacing-md);
    padding: var(--spacing-3xl) 0;
    color: var(--text-dim);
}
.ai-advisor-spinner {
    width: 40px;
    height: 40px;
    border: 3px solid var(--glass-border);
    border-top-color: var(--md-sys-color-primary);
    border-radius: 50%;
    animation: ai-spin 0.8s linear infinite;
}
@keyframes ai-spin {
    to { transform: rotate(360deg); }
}

/* Error state */
.ai-advisor-error {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--spacing-md);
    padding: var(--spacing-3xl) var(--spacing-lg);
    text-align: center;
}
.ai-advisor-error-icon {
    width: 64px;
    height: 64px;
    border-radius: 50%;
    background: var(--md-sys-color-error-container, rgba(255, 50, 50, 0.15));
    display: flex;
    align-items: center;
    justify-content: center;
    color: var(--md-sys-color-error, #FF5449);
}
.ai-advisor-error p {
    margin: 0;
    color: var(--text-primary);
    font-weight: 500;
}
.ai-advisor-error-hint {
    font-size: var(--md-sys-typescale-body-small-size, 12px);
    color: var(--text-dim) !important;
    font-weight: 400 !important;
    max-width: 360px;
    line-height: 1.5;
}

/* Streaming cursor */
.ai-advisor-streaming::after {
    content: '';
    display: inline-block;
    width: 2px;
    height: 1.1em;
    background: var(--md-sys-color-primary);
    margin-left: var(--spacing-xxs);
    vertical-align: text-bottom;
    animation: ai-blink 0.7s step-end infinite;
}
@keyframes ai-blink {
    50% { opacity: 0; }
}

/* Response content */
.ai-advisor-response {
    line-height: 1.7;
    color: var(--text-primary);
}
.ai-advisor-response h2 {
    font-size: var(--md-sys-typescale-headline-small-size, 24px);
    font-weight: 500;
    margin: var(--spacing-lg) 0 var(--spacing-sm);
    color: var(--text-primary);
}
.ai-advisor-response h3 {
    font-size: var(--md-sys-typescale-title-large-size, 22px);
    font-weight: 500;
    margin: var(--spacing-lg) 0 var(--spacing-sm);
    color: var(--text-primary);
}
.ai-advisor-response h4 {
    font-size: var(--md-sys-typescale-title-medium-size, 16px);
    font-weight: 600;
    margin: var(--spacing-md) 0 var(--spacing-xs);
    color: var(--md-sys-color-primary);
}
.ai-advisor-response h5 {
    font-size: var(--md-sys-typescale-body-large-size, 16px);
    font-weight: 600;
    margin: var(--spacing-md) 0 var(--spacing-xs);
    color: var(--text-dim);
}
.ai-advisor-response p {
    margin: 0 0 var(--spacing-sm);
}
.ai-advisor-response strong {
    color: var(--md-sys-color-primary);
    font-weight: 600;
}
.ai-advisor-response em {
    font-style: italic;
    color: var(--text-dim);
}
.ai-advisor-response ul,
.ai-advisor-response ol {
    margin: var(--spacing-xs) 0 var(--spacing-md);
    padding-left: var(--spacing-lg);
}
.ai-advisor-response li {
    margin-bottom: var(--spacing-xs);
}
.ai-advisor-response li::marker {
    color: var(--md-sys-color-primary);
}
.ai-advisor-response code {
    background: var(--state-hover);
    padding: 2px var(--spacing-xs);
    border-radius: var(--radius-xs, 4px);
    font-family: 'Fira Code', 'Consolas', monospace;
    font-size: 0.9em;
}
.ai-advisor-response pre {
    background: rgba(0, 0, 0, 0.3);
    border-radius: var(--radius-md, 12px);
    padding: var(--spacing-md);
    overflow-x: auto;
    margin: var(--spacing-sm) 0 var(--spacing-md);
}
.ai-advisor-response pre code {
    background: none;
    padding: 0;
    font-size: 0.85em;
    line-height: 1.5;
}
.ai-advisor-response hr {
    border: none;
    border-top: 1px solid var(--glass-border);
    margin: var(--spacing-lg) 0;
}
.ai-advisor-response a {
    color: var(--md-sys-color-primary);
    text-decoration: underline;
    text-underline-offset: 2px;
}

/* Cache badge */
.ai-advisor-cache-badge {
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
    padding: var(--spacing-xs) var(--spacing-sm);
    background: var(--state-hover);
    border-radius: var(--radius-full, 100px);
    font-size: var(--md-sys-typescale-label-small-size, 11px);
    color: var(--text-dim);
    margin-bottom: var(--spacing-md);
}

/* Refresh / retry button */
.ai-advisor-refresh {
    margin-top: var(--spacing-md);
    display: inline-flex;
    align-items: center;
    gap: var(--spacing-xs);
}
.ai-advisor-error .ai-advisor-refresh {
    margin-top: var(--spacing-lg);
}

/* ═══════════════════════════════════════════
   Radar Chart (Health Indicators)
   ═══════════════════════════════════════════ */

.radar-chart-container {
    width: 100%;
    max-width: 400px;
    margin: 0 auto;
    aspect-ratio: 1;
}

.radar-legend {
    display: flex;
    justify-content: center;
    gap: var(--spacing-md);
    margin-top: var(--spacing-sm);
}

.radar-details {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
    margin-top: var(--spacing-lg);
}

.radar-detail-card {
    background: var(--state-hover);
    border-radius: var(--radius-md, 12px);
    padding: var(--spacing-sm) var(--spacing-md);
}
.radar-detail-card.good {
    border-left: 3px solid var(--md-sys-color-primary);
}
.radar-detail-card.moderate {
    border-left: 3px solid var(--md-sys-color-tertiary, #7D5260);
}
.radar-detail-card.low {
    border-left: 3px solid var(--md-sys-color-error, #FF5449);
}

.radar-detail-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: var(--spacing-xs);
}
.radar-detail-label {
    font-weight: 500;
    color: var(--text-primary);
    font-size: var(--md-sys-typescale-body-large-size, 16px);
}
.radar-detail-score {
    font-weight: 600;
    color: var(--md-sys-color-primary);
    font-size: var(--md-sys-typescale-title-medium-size, 16px);
}
.radar-detail-score small {
    font-weight: 400;
    color: var(--text-dim);
    font-size: 0.7em;
}

.radar-detail-bar {
    height: 4px;
    background: var(--glass-border);
    border-radius: 2px;
    overflow: hidden;
    margin-bottom: var(--spacing-xs);
}
.radar-detail-fill {
    height: 100%;
    border-radius: 2px;
    transition: width 0.6s ease;
}
.radar-detail-card.good .radar-detail-fill {
    background: var(--md-sys-color-primary);
}
.radar-detail-card.moderate .radar-detail-fill {
    background: var(--md-sys-color-tertiary, #7D5260);
}
.radar-detail-card.low .radar-detail-fill {
    background: var(--md-sys-color-error, #FF5449);
}

.radar-detail-info {
    display: flex;
    justify-content: space-between;
    font-size: var(--md-sys-typescale-body-small-size, 12px);
}
.radar-detail-value {
    color: var(--text-primary);
}
.radar-detail-note {
    color: var(--text-dim);
}

.radar-no-data {
    text-align: center;
    color: var(--text-dim);
    padding: var(--spacing-xl) 0;
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
}

/* ═══════════════════════════════════════════
   Body Silhouette Overlay (Phase 8)
   ═══════════════════════════════════════════ */

.briefing-body-silhouette {
    width: 100%;
    margin-bottom: var(--spacing-md);
}

.silhouette-svg {
    width: 100%;
    max-width: 580px;
    height: auto;
    display: block;
    margin: 0 auto;
    overflow: visible;
}

.silhouette-no-data {
    text-align: center;
    color: var(--text-dim);
    padding: var(--spacing-lg) 0;
    font-size: var(--md-sys-typescale-body-medium-size, 14px);
}

.silhouette-type-badge {
    display: inline-block;
    padding: 2px 10px;
    border-radius: 12px;
    font-size: 11px;
    font-weight: 600;
    color: var(--md-sys-color-on-secondary-container, #1D192B);
    background: var(--md-sys-color-secondary-container, rgba(160, 140, 210, 0.2));
    margin-bottom: 8px;
}

@media (max-width: 400px) {
    .silhouette-svg {
        max-width: 100%;
    }
}
