<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="color-scheme" content="light dark">
    <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ShiftV - 당신의 변화를 기록하세요</title>

    <link rel="manifest" href="manifest.json">

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="ShiftV">
    <meta name="theme-color" content="#1a1a3a">
    <link rel="apple-touch-icon" href="/icons/apple-touch-icon.png">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body class="dark-mode">

    <!-- 초기 설정 모달 -->
    <div id="initial-setup-popup" class="modal-overlay" style="display: none;">
        <div class="modal-content glass-card">
            <h2 data-lang-key="initialSetupTitle">초기 설정</h2>
            <p data-lang-key="initialSetupDesc">ShiftV 사용을 시작하기 전에 언어와 성적 지향을 선택해주세요.</p>
            <div class="form-group">
                <label for="initial-language-select" data-lang-key="language">언어</label>
                <select id="initial-language-select">
                    <option value="ko">한국어</option>
                    <option value="en">English</option>
                    <option value="ja">日本語</option>
                </select>
            </div>
            <div class="form-group">
                <label for="initial-sex-select" data-lang-key="biologicalSex">생물학적 성별</label>
                <select id="initial-sex-select">
                    <option value="male" data-lang-key="sexMale">남성</option>
                    <option value="female" data-lang-key="sexFemale">여성</option>
                    <option value="other" data-lang-key="sexOther">기타-무성별</option>
                </select>
            </div>
            <div class="form-group">
                <label for="initial-mode-select" data-lang-key="mode">성적지향</label>
                <select id="initial-mode-select">
                    <option value="mtf" data-lang-key="modeMtf">여성화</option>
                    <option value="ftm" data-lang-key="modeFtm">남성화</option>
                </select>
            </div>
            <div class="button-group">
                <button id="initial-setup-save" class="glass-button primary" data-lang-key="saveSettings">설정 저장</button>
            </div>
        </div>
    </div>

    <div class="app-wrapper">

        <!-- ▼▼▼ 2. 기존의 탭 바를 이곳으로 이동시키세요 ▼▼▼ -->
        <!-- 탭 바 -->
        <!-- 탭 바 -->
        <div class="tab-bar">
            <!-- 1. 메인 탭 (구 SV) -->
            <button class="tab-button active" data-tab="tab-sv" data-lang-key="tabMain">
                <div class="active-tab-indicator"></div>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"
                    fill="currentColor">
                    <path d="M0 0h24v24H0V0z" fill="none" />
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8h5z" />
                </svg>
                <span>메인</span>
            </button>
            <!-- 2. 기록하기 탭 -->
            <button class="tab-button" data-tab="tab-record" data-lang-key="tabRecord">
                <div class="active-tab-indicator"></div>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px"
                    height="24px">
                    <path d="M0 0h24v24H0V0z" fill="none" />
                    <path
                        d="M14.06 9.94L12 12l2.06 2.06.94-.94-1.12-1.12.94-.94-1.76-1.76zm4.48-4.48L19.59 4.4l-9.19 9.19-4.24-4.24 1.06-1.06 3.18 3.18L18.54 5.46zm-5.21 8.87L12 15.7l-1.41-1.41-1.12 1.12 2.54 2.54 4.9-4.9-1.12-1.12zM20 2H4c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 18H4V4h16v16z" />
                </svg>
                <span>기록하기</span>
            </button>
            <!-- 3. 마이 탭 -->
            <button class="tab-button" data-tab="tab-my" data-lang-key="tabMy">
                <div class="active-tab-indicator"></div>
                <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px"
                    fill="currentColor">
                    <path d="M0 0h24v24H0V0z" fill="none" />
                    <path
                        d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                </svg>
                <span>마이</span>
            </button>
            <!-- 4. 설정 탭 -->
            <button class="tab-button" data-tab="tab-settings" data-lang-key="tabSettings">
                <div class="active-tab-indicator"></div>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z" />
                    <path
                        d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.902 3.433 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zM8 13a5 5 0 1 1 0-10 5 5 0 0 1 0 10z" />
                </svg>
                <span>설정</span>
            </button>
        </div>

        <div class="container">
            <div class="title-container">
                <div class="title-container">
                    <img src="./assets/title-dark.png" alt="ShiftV" id="main-title-dark">
                    <img src="./assets/title-light.png" alt="" id="main-title-light">
                </div>

            </div>
            <p class="version-info" id="app-version-display">v1.4</p>



            <div class="tab-contents">

                <!-- 측정 입력 탭 -->
                <!-- ▼▼▼ '기록하기' 탭의 전체 내용을 아래 코드로 교체하세요 ▼▼▼ -->
                <div id="tab-record" class="tab-content">

                    <!-- "입력" 화면 -->
                    <div id="record-input-view">
                        <h2 id="form-title" data-lang-key="formTitleNew">측정 시작하기</h2>
                        <div class="glass-card">
                            <div id="next-measurement-info" class="next-measurement-info">
                                <p data-lang-key="nextMeasurementInfoNoData">마지막 측정일을 기준으로 다음 예정일을 계산해요.</p>
                            </div>

                            <form id="measurement-form">
                                <input type="hidden" id="edit-index" value="">
                                <p class="description" data-lang-key="inputDescription">모든 항목은 선택 사항이에요! 😉</p>

                                <!-- '신체 사이즈' 아코디언 -->
                                <details class="accordion-group" open>
                                    <summary class="accordion-title" data-lang-key="categoryBodySize">신체 사이즈</summary>
                                    <div class="accordion-content">
                                        <div class="input-grid">
                                            <!-- 신체 사이즈 입력 필드들 -->
                                            <div class="form-group"><label for="height" data-lang-key="height">신장
                                                    (cm)</label><input type="number" id="height" name="height"
                                                    step="0.1" min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="weight" data-lang-key="weight">체중
                                                    (kg)</label><input type="number" id="weight" name="weight"
                                                    step="0.1" min="0" placeholder="kg"></div>
                                            <div class="form-group"><label for="shoulder" data-lang-key="shoulder">어깨너비
                                                    (cm)</label><input type="number" id="shoulder" name="shoulder"
                                                    step="0.1" min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="neck" data-lang-key="neck">목둘레
                                                    (cm)</label><input type="number" id="neck" name="neck" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="chest" data-lang-key="chest">윗 가슴 둘레
                                                    (cm)</label><input type="number" id="chest" name="chest" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="cupSize" data-lang-key="cupSize">아랫 가슴
                                                    둘레
                                                    (cm)</label><input type="number" id="cupSize" name="cupSize"
                                                    step="0.1" min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="waist" data-lang-key="waist">허리둘레
                                                    (cm)</label><input type="number" id="waist" name="waist" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="hips" data-lang-key="hips">엉덩이둘레
                                                    (cm)</label><input type="number" id="hips" name="hips" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="thigh" data-lang-key="thigh">허벅지둘레
                                                    (cm)</label><input type="number" id="thigh" name="thigh" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="calf" data-lang-key="calf">종아리둘레
                                                    (cm)</label><input type="number" id="calf" name="calf" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                            <div class="form-group"><label for="arm" data-lang-key="arm">팔뚝둘레
                                                    (cm)</label><input type="number" id="arm" name="arm" step="0.1"
                                                    min="0" placeholder="cm"></div>
                                        </div>
                                    </div>
                                </details>

                                <!-- '건강' 아코디언 -->
                                <details class="accordion-group">
                                    <summary class="accordion-title" data-lang-key="categoryHealth">건강</summary>
                                    <div class="accordion-content">
                                        <div class="input-grid">
                                            <!-- 건강 관련 입력 필드들 -->
                                            <div class="form-group"><label for="muscleMass"
                                                    data-lang-key="muscleMass">근육량
                                                    (kg)</label><input type="number" id="muscleMass" name="muscleMass"
                                                    step="0.1" min="0" placeholder="kg"></div>
                                            <div class="form-group"><label for="bodyFatPercentage"
                                                    data-lang-key="bodyFatPercentage">체지방률 (%)</label><input
                                                    type="number" id="bodyFatPercentage" name="bodyFatPercentage"
                                                    step="0.1" min="0" placeholder="%"></div>
                                            <div class="form-group"><label for="estrogenLevel"
                                                    data-lang-key="estrogenLevel">에스트로겐 수치 (pg/ml)</label><input
                                                    type="number" id="estrogenLevel" name="estrogenLevel" step="0.1"
                                                    min="0" placeholder="pg/ml"></div>
                                            <div class="form-group"><label for="testosteroneLevel"
                                                    data-lang-key="testosteroneLevel">테스토스테론 수치 (ng/ml)</label><input
                                                    type="number" id="testosteroneLevel" name="testosteroneLevel"
                                                    step="0.1" min="0" placeholder="ng/ml"></div>
                                            <div class="form-group"><label for="libido" data-lang-key="libido">성욕
                                                    (회/주)</label><input type="number" id="libido" name="libido"
                                                    step="0.1" min="0" placeholder="number"></div>
                                            <div class="form-group form-group-compound"><label
                                                    data-lang-key="healthStatus">건강 상태</label>
                                                <div class="compound-input"><input type="text" id="healthNotes"
                                                        name="healthNotes" data-lang-key="notesPlaceholder"
                                                        placeholder="Text"></div>
                                            </div>
                                            <div class="form-group"><label for="skinCondition"
                                                    data-lang-key="skinCondition">피부 상태</label><input type="text"
                                                    id="skinCondition" name="skinCondition"
                                                    data-lang-key="skinConditionPlaceholder" placeholder="Text"></div>
                                        </div>
                                    </div>
                                </details>

                                <!-- '마법' 아코디언 -->
                                <details class="accordion-group">
                                    <summary class="accordion-title" data-lang-key="categoryMedication">마법</summary>
                                    <div class="accordion-content">
                                        <div class="input-grid">
                                            <!-- 마법 관련 입력 필드들 -->
                                            <div class="form-group mtf-only"><label for="estradiol"
                                                    data-lang-key="estradiol">에스트라디올 (mg)</label><input type="number"
                                                    id="estradiol" name="estradiol" step="0.1" min="0" placeholder="mg">
                                            </div>
                                            <div class="form-group mtf-only"><label for="progesterone"
                                                    data-lang-key="progesterone">프로게스테론 (mg)</label><input type="number"
                                                    id="progesterone" name="progesterone" step="1" min="0"
                                                    placeholder="mg">
                                            </div>
                                            <div class="form-group mtf-only"><label for="antiAndrogen"
                                                    data-lang-key="antiAndrogen">항안드로겐 (mg)</label><input type="number"
                                                    id="antiAndrogen" name="antiAndrogen" step="1" min="0"
                                                    placeholder="mg">
                                            </div>
                                            <div class="form-group ftm-only"><label for="testosterone"
                                                    data-lang-key="testosterone">테스토스테론 (mg)</label><input type="number"
                                                    id="testosterone" name="testosterone" step="1" min="0"
                                                    placeholder="mg">
                                            </div>
                                            <div class="form-group ftm-only"><label for="antiEstrogen"
                                                    data-lang-key="antiEstrogen">항에스트로겐 (mg)</label><input type="number"
                                                    id="antiEstrogen" name="antiEstrogen" step="1" min="0"
                                                    placeholder="mg">
                                            </div>
                                            <div class="form-group mtf-only"></div>
                                            <div class="form-group"><label for="medicationOtherName"
                                                    data-lang-key="medicationOtherName">기타 마법 이름</label><input
                                                    type="text" id="medicationOtherName" name="medicationOtherName"
                                                    placeholder="(기타)" data-lang-key="medicationOtherNamePlaceholder">
                                            </div>
                                            <div class="form-group"><label for="medicationOtherDose"
                                                    data-lang-key="medicationOtherDose">기타 마법 용량 (mg)</label><input
                                                    type="number" id="medicationOtherDose" name="medicationOtherDose"
                                                    step="0.1" min="0" placeholder="mg"
                                                    data-lang-key="unitMgPlaceholder">
                                            </div>
                                        </div>
                                    </div>
                                </details>

                                <!-- Keeps 입력 필드 -->
                                <div class="form-group keeps-integration">
                                    <label for="record-keeps" data-lang-key="recordKeepsLabel">이번 주 Keeps 📝</label>
                                    <textarea id="record-keeps" name="record-keeps" rows="4"
                                        placeholder="오늘의 기분, 이벤트, 신체 변화 등을 자유롭게 기록해보세요..."
                                        data-lang-key="recordKeepsPlaceholder"></textarea>
                                </div>

                                <!-- 하단 버튼 그룹 -->
                                <div class="button-group">
                                    <button type="submit" id="save-update-button" class="glass-button primary"
                                        data-lang-key="saveRecord">기록하기 ✨</button>
                                    <button type="button" id="cancel-edit-button" class="glass-button"
                                        style="display: none;" data-lang-key="cancelEdit">수정 취소</button>
                                </div>
                            </form>
                        </div>
                    </div>


                </div>
                <!-- ▲▲▲ '기록하기' 탭 완료 ▲▲▲ -->


                <!-- ▼▼▼ 3. '변화 보고서' 탭을 'SV' 탭으로 변경 (id="tab-main") ▼▼▼ -->
                <div id="tab-sv" class="tab-content active">

                    <!-- 새로운 SV 그리드 컨테이너 -->
                    <div class="sv-grid">
                        <div id="sv-card-shortcut" class="sv-card">
                            <!-- 내용은 JS로 채워짐 -->
                        </div>
                        <!-- 1. 최근 변화 하이라이트 카드 -->
                        <div id="sv-card-highlights" class="sv-card carousel-container">
                            <h3 id="sv-card-highlights-title">
                                <!-- JS에서 제목 채움 -->
                            </h3>
                            <div class="carousel-wrapper">
                                <div id="sv-card-highlights-content" class="carousel-content">
                                    <!-- JS에서 캐러셀 아이템 채움 -->
                                </div>
                                <button class="carousel-nav-btn prev" aria-label="Previous">
                                    ‹</button>
                                <button class="carousel-nav-btn next" aria-label="Next">›</button>
                            </div>
                            <div id="sv-card-highlights-dots" class="carousel-dots">
                                <!-- JS에서 페이지 점 채움 -->
                            </div>
                        </div>

                        <!-- 2. 가이드 카드 -->
                        <div id="sv-card-guide" class="sv-card sv-card-widget">
                            <!-- 내용은 JS로 채워짐 -->
                        </div>

                        <!-- 3. 목표 달성도 카드 -->
                        <div id="sv-card-targets" class="sv-card" sv-card--clickable>
                            <!-- 내용은 JS로 채워짐 -->
                        </div>

                        <!-- 4. 호르몬 주기 예측 카드 -->
                        <div id="sv-card-hormones" class="sv-card">
                            <!-- 내용은 JS로 채워짐 -->
                        </div>

                        <!-- 5. Keeps 모아보기 카드 -->
                        <div id="sv-card-keeps" class="sv-card sv-card--clickable carousel-container">
                            <h3 id="sv-card-keeps-title">
                                <!-- JS에서 제목 채움 -->
                            </h3>
                            <div class="carousel-wrapper">
                                <div id="sv-card-keeps-content" class="carousel-content">
                                    <!-- JS에서 캐러셀 아이템 채움 -->
                                </div>
                                <button class="carousel-nav-btn prev" aria-label="Previous">‹</button>
                                <button class="carousel-nav-btn next" aria-label="Next">›</button>
                            </div>
                            <div id="sv-card-keeps-dots" class="carousel-dots">
                                <!-- JS에서 페이지 점 채움 -->
                            </div>
                        </div>

                    </div>
                </div>
                <!-- ▲▲▲ 'SV' 탭 완료 ▲▲▲ -->

                <!-- 3. 마이 탭 -->
                <div id="tab-my" class="tab-content">
                    <h2 data-lang-key="myTitle">마이 페이지 🧑‍🚀</h2>

                    <!-- 1. 목표 설정 섹션 -->
                    <div class="my-section glass-card">
                        <h3 data-lang-key="targetTitle">나만의 목표 설정 💖</h3>
                        <form id="target-form">
                            <p class="description" data-lang-key="targetDescription">원하는 목표 수치를 입력해주세요. 메인 탭에서 달성률을 확인할
                                수 있어요.</p>
                            <div class="target-grid">
                                <!-- JS에 의해 목표 입력 필드가 채워짐 -->
                            </div>
                            <button type="submit" id="save-targets-button" class="glass-button primary"
                                data-lang-key="saveTarget">목표 저장! 💪</button>
                        </form>
                    </div>

                    <!-- 2. 상세 기록 확인 섹션 (나중에 '기록하기' 탭의 기록 뷰를 이곳으로 완전히 옮길 수 있습니다) -->
                    <div class="my-section glass-card">
                        <h3 data-lang-key="historyTitle">측정 기록 꼼꼼히 보기 🧐</h3>
                        <p class="description" data-lang-key="historyDescription">(표가 화면보다 넓으면 좌우로 스크롤해보세요!)</p>
                        <!-- 기록 확인 컴포넌트 -->
                        <div id="my-history-view-container">
                            <div id="my-history-filter-controls"></div>
                            <div id="my-history-cards-container" class="history-view"></div>
                            <div id="my-history-table-container"
                                class="history-view table-responsive horizontal-scroll"></div>
                        </div>
                    </div>

                </div>

                <!-- 설정 탭 (기존 #tab-settings과 내용은 동일하나, 일부 내부 요소는 다음 단계에서 수정) -->
                <div id="tab-settings" class="tab-content">
                    <div id="tab-settings" class="tab-content">
                        <h2 data-lang-key="settingsTitle">설정 ⚙️</h2>



                        <div class="settings-section glass-card">
                            <div class="setting-item">
                                <h3 data-lang-key="languageSettingsTitle" id="language-settings-title">언어 설정</h3>
                                <select id="language-select">
                                    <option value="ko">한국어</option>
                                    <option value="en">English</option>
                                    <option value="ja">日本語</option>
                                </select>
                            </div>
                        </div>

                        <!-- [수정] 생물학적 성별 설정 -->
                        <div class="settings-section glass-card">
                            <div class="setting-item">
                                <h3 data-lang-key="sexSettingsTitle">생물학적 성별 설정</h3>
                                <select id="sex-select">
                                    <option value="male" data-lang-key="sexMale">남성</option>
                                    <option value="female" data-lang-key="sexFemale">여성</option>
                                    <option value="other" data-lang-key="sexOther">기타-무성별</option>
                                </select>
                            </div>
                            <p class="description" data-lang-key="sexSettingsDesc">자연 호르몬 회복률 계산에 사용됩니다.</p>
                        </div>

                        <!-- [수정] 모드 설정 -->
                        <div class="settings-section glass-card">
                            <div class="setting-item">
                                <h3 data-lang-key="modeSettingsTitle" id="mode-settings-title">모드 설정</h3>
                                <select id="mode-select">
                                    <option value="mtf" data-lang-key="modeMtf">여성화</option>
                                    <option value="ftm" data-lang-key="modeFtm">남성화</option>
                                </select>
                            </div>
                            <p class="description" data-lang-key="modeSettingsDesc" id="mode-settings-description">목표하는
                                신체 변화 방향을 선택해주세요.</p>
                        </div>

                        <!-- [수정] 테마 설정 -->
                        <div class="settings-section glass-card">
                            <div class="setting-item">
                                <h3 data-lang-key="themeSettingsTitle">테마 설정</h3>
                                <select id="theme-select">
                                    <option value="system" data-lang-key="themeSystem">기기 값 참조</option>
                                    <option value="light" data-lang-key="themeLight">라이트 모드</option>
                                    <option value="dark" data-lang-key="themeDark">다크 모드</option>
                                </select>
                            </div>
                        </div>

                        <div class="settings-section glass-card">
                            <div class="setting-item">
                                <h3 data-lang-key="notificationSettingsTitle"
                                    style="margin: 0; color: var(--primary); font-size: 1.2em;">알림 설정</h3>
                                <label class="switch">
                                    <input type="checkbox" id="notification-toggle">
                                    <span class="slider round"></span>
                                </label>
                            </div>
                            <div>
                                <p class="description" data-lang-key="notificationSettingsDesc"
                                    style="margin-top: 15px;">마지막 측정일로부터 7일이 지나면
                                    알려드려요.
                                    알림을 받으려면 브라우저의 권한 허용이 필요해요.</p>
                            </div>
                        </div>


                        <div class="settings-section glass-card">
                            <h3 data-lang-key="dataManagementTitle" id="data-management-title">데이터 백업 & 복원</h3>
                            <p class="description" data-lang-key="dataManagementDesc" id="data-management-description">
                                모든
                                기록을 파일
                                하나로 저장하거나 복원할 수 있어요. 가끔 백업해두면 안심이에요! 😊</p>
                            <div class="button-group">
                                <button type="button" id="export-data-button" class="glass-button"
                                    data-lang-key="exportData">파일
                                    저장하기</button>
                                <button type="button" id="import-data-button" class="glass-button"
                                    data-lang-key="importData">파일
                                    불러오기</button>
                            </div>
                            <input type="file" id="import-file-input" accept=".json" style="display: none;">
                            <p class="warning"><strong data-lang-key="warning">주의!</strong> <span
                                    data-lang-key="importWarning">복원하면
                                    지금 브라우저에 있는 모든 데이터가 파일 내용으로 완전히 대체돼요!</span></p>
                        </div>

                        <div class="settings-section glass-card">
                            <h3 data-lang-key="dataUpdateAndResetTitle">데이터 업데이트 및 초기화</h3>
                            <div class="button-group">
                                <button type="button" id="check-for-updates-button" class="glass-button"
                                    data-lang-key="checkForUpdatesButton">업데이트 확인</button>
                                <button type="button" id="reset-data-button" class="glass-button danger"
                                    data-lang-key="resetDataButton">모든 데이터 초기화</button>
                            </div>
                            <p class="warning" id="reset-data-warning"><strong data-lang-key="severeWarning">정말정말
                                    주의!</strong>
                                <span data-lang-key="resetWarning">😱 데이터 초기화는 모든 기록(측정, 목표, Keeps)을 영구적으로 삭제합니다! 초기화 전에
                                    꼭!
                                    데이터를 파일로
                                    백업해주세요.</span>
                            </p>
                        </div>
                        <div class="settings-section info glass-card">
                            <h3 data-lang-key="infoTitle" id="info-title">정보</h3>
                            <p><span data-lang-key="versionLabel">버전:</span> <span
                                    id="app-version-display-footer">1.4</span>
                            </p>
                            <p data-lang-key="privacyInfo" id="privacy-info">이 앱은 오프라인 작동하며 모든 데이터는 브라우저에만 안전하게 저장됩니다!
                                😉
                            </p>
                            <p style="margin-top: 15px;"><strong>Made by MUMU</strong> 💖</p>
                            <p style="margin-top: 20px;" data-lang-key="developerMessage" id="developer-message">이 작은
                                도구가
                                당신의
                                소중한 여정에 즐거움과 도움이 되기를 바라요!</p>
                            <p>© 2025. MUMU. All rights reserved.</p>
                        </div>

                    </div>



                </div>
            </div>

        </div>

    </div>
    <div id="save-popup" class="popup"></div>



    <div id="compare-flow-view" class="modal-tab-content">
        <!-- 모달 컨텐츠 래퍼 -->
        <div class="modal-content-wrapper">

            <!-- 탭 전환 버튼 -->
            <div class="modal-tab-switcher">
                <button class="modal-tab-btn active" data-tab="detailed-analysis"
                    data-lang-key="modalTabDetailedAnalysis">상세 분석</button>
                <button class="modal-tab-btn" data-tab="comparative-analysis"
                    data-lang-key="modalTabComparativeAnalysis">비교 분석</button>
            </div>

            <!-- 1. 상세 분석 탭 (기존 내용) -->
            <div id="detailed-analysis-view" class="modal-tab-content active">
                <div class="comparison-report-container">
                    <!-- 필터 버튼 섹션 -->
                    <div id="comparison-filter-controls" class="comparison-filter-controls">
                        <!-- JS에서 필터 버튼 생성 -->
                    </div>
                    <!-- 메인 그래프 섹션 -->
                    <div class="chart-section">
                        <div class="chart-wrapper">
                            <canvas id="comparison-chart"></canvas>
                        </div>
                    </div>

                    <div id="comparison-selected-week-data-container" class="selected-week-data-container">
                        <h4 id="comparison-selected-week-data-title"></h4>
                        <div id="comparison-selected-week-data-content" class="selected-week-data-content"
                            style="display: none;">
                            <!-- JS에 의해 데이터가 채워지는 곳 (초기에는 숨김) -->
                        </div>
                        <p id="comparison-data-placeholder" class="placeholder-text" data-lang-key="graphClickPrompt">
                            <!-- JS에 의해 안내 문구가 채워지는 곳 -->
                        </p>
                    </div>

                    <div id="comparison-selected-week-data-container" class="selected-week-data-container"
                        style="display: none;">
                        <h4 id="comparison-selected-week-data-title"></h4>
                        <div id="comparison-selected-week-data-content" class="selected-week-data-content">
                            <!-- JS에 의해 채워짐 -->
                        </div>
                        <p id="comparison-data-placeholder" class="placeholder-text">그래프의 수치정보를 클릭하면 해당 주차의 상세정보가 표시됩니다.
                        </p>
                    </div>

                    <!-- 상세 데이터 테이블 섹션 -->
                    <div id="comparison-table-container" class="table-responsive horizontal-scroll">
                        <!-- JS에서 상세 테이블 생성 -->
                    </div>
                </div>
            </div>

            <!-- 2. 비교 분석 탭 (새로운 내용) -->
            <div id="comparative-analysis-view" class="modal-tab-content">
                <div class="comparison-view-container">
                    <!-- 상단: 비교 대상 선택 드롭다운 -->
                    <div class="comparison-selectors">
                        <div class="form-group">
                            <label for="compare-left-select" data-lang-key="labelBase">기준</label>
                            <select id="compare-left-select"></select>
                        </div>
                        <div class="form-group">
                            <label for="compare-right-select" data-lang-key="labelCompareTarget">비교 대상</label>
                            <select id="compare-right-select"></select>
                        </div>
                    </div>
                    <!-- 하단: 비교 결과 그리드 -->
                    <div id="comparison-results-grid" class="comparison-results-grid">
                        <!-- JS에 의해 채워짐 -->
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div id="modal-bottom-sheet-overlay" class="modal-bottom-sheet-overlay">
        <div id="modal-bottom-sheet" class="modal-bottom-sheet">
            <div class="modal-header">
                <div class="modal-handle"></div>
                <h3 id="modal-title" class="modal-title"></h3>
                <button id="modal-close-btn" class="modal-close-btn">×</button>
            </div>
            <div id="modal-content" class="modal-content">
                <!-- 상세 내용이 여기에 동적으로 삽입됩니다. -->
            </div>
        </div>
    </div>
    <div id="hormone-modal-overlay" class="modal-bottom-sheet-overlay">
        <div id="hormone-modal" class="modal-bottom-sheet">
            <div class="modal-header">
                <div class="modal-handle"></div>
                <h3 id="hormone-modal-title" class="modal-title"></h3>
                <button id="hormone-modal-close-btn" class="modal-close-btn">×</button>
            </div>
            <div class="modal-content">
                <div class="hormone-report-container">
                    <div class="chart-section" id="hormone-analysis-text">
                        <!-- 자바스크립트가 이 안에 "최근 2주 분석" 내용을 채울 것입니다. -->
                    </div>
                    <div class="chart-section">
                        <h4 data-lang-key="medicationHistoryTitle">투여량 변화</h4>
                        <div class="hormone-legend-controls" id="medication-legend-controls"></div> <!-- 이 줄 추가 -->
                        <div class="chart-wrapper">
                            <canvas id="medication-chart"></canvas>
                        </div>
                    </div>
                    <div class="chart-section">
                        <h4 data-lang-key="hormoneLevelHistoryTitle">호르몬 수치 변화</h4>
                        <div class="hormone-legend-controls" id="hormone-legend-controls"></div> <!-- 이 줄 추가 -->
                        <div class="chart-wrapper">
                            <canvas id="hormone-chart"></canvas>
                        </div>
                    </div>


                    <!-- 선택된 주차 데이터 표시 영역 -->
                    <div id="selected-week-data-container" class="selected-week-data-container">
                        <h4 id="selected-week-data-title"></h4>
                        <div id="selected-week-data-content" class="selected-week-data-content" style="display: none;">
                            <!-- JS에 의해 데이터가 채워지는 곳 -->
                        </div>
                        <p id="hormone-data-placeholder" class="placeholder-text" data-lang-key="graphClickPrompt">
                            <!-- JS에 의해 안내 문구가 채워지는 곳 -->
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/ShiftV/service-worker.js')
                    .then(registration => console.log('✅ Service Worker Registered:', registration.scope))
                    .catch(error => console.log('🚨 Service Worker Registration Failed:', error));
            });
        } else {
            console.log('Service Worker not supported by this browser.');
        }
    </script>

</body>

</html>